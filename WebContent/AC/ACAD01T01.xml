<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form Height="650" Id="ACAD01T01" Left="8" OnLoadCompleted="ACAD01T01_OnLoadCompleted" OnUnloadCompleted="ACAD01T01_OnUnloadCompleted" PidAttrib="7" Title="비용청구" ToolTipFont="Default,0" Top="8" Ver="1.0" Width="1240" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="DS_TIEUPASK_NOT_MST" OnColumnChanged="DS_TIEUPASK_NOT_MST_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ROW_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="OPERATOR" size="256" summ="default" type="STRING"/>
					<colinfo id="BRCH_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="TUB_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ASK_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ASK_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="TUB_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SIN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BAS_ST_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="BAS_ED_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="UNP_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="OCC_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="VAT_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="ASK_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="NOTE" size="256" summ="default" type="STRING"/>
					<colinfo id="LST_ASK_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC_CARY" size="256" summ="default" type="STRING"/>
					<colinfo id="HNA_CHG_USR" size="256" summ="default" type="STRING"/>
					<colinfo id="ASK_EXP_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="SIN_GBN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="DS_TIEUPASK_YES_MST" OnColumnChanged="DS_TIEUPASK_YES_MST_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ROW_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="OPERATOR" size="256" summ="default" type="STRING"/>
					<colinfo id="BRCH_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="TUB_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ASK_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ASK_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="TUB_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SIN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BAS_ST_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="BAS_ED_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="UNP_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="OCC_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="VAT_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="ASK_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="NOTE" size="256" summ="default" type="STRING"/>
					<colinfo id="LST_ASK_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="HNA_CHG_USR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="DS_TIEUPASK_OMS_MST" OnColumnChanged="DS_TIEUPASK_OMS_MST_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ROW_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="OPERATOR" size="256" summ="default" type="STRING"/>
					<colinfo id="BRCH_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="TUB_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ASK_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ASK_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="TUB_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SIN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BAS_ST_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="BAS_ED_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="UNP_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="OCC_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="VAT_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="ASK_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="ASK_EXP_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="NOTE" size="256" summ="default" type="STRING"/>
					<colinfo id="HNA_CHG_USR" size="256" summ="default" type="STRING"/>
					<colinfo id="SIN_GBN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="DS_TIEUPASK_NOT_DTL">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ROW_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="OPERATOR" size="256" summ="default" type="STRING"/>
					<colinfo id="BRCH_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="TUB_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ASK_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ASK_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="AFF_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="BNK_CHGR" size="256" summ="default" type="STRING"/>
					<colinfo id="AGC_CHGR" size="256" summ="default" type="STRING"/>
					<colinfo id="OCC_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="CLT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CLT_JMN" size="256" summ="default" type="STRING"/>
					<colinfo id="AFF_PRS_STS" size="256" summ="default" type="STRING"/>
					<colinfo id="ASK_EXP_DT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_mst_temp"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dtl_temp"></Dataset>
			<Dataset DataSetType="Dataset" Id="DS_ASK_SEQ">
				<Contents>
					<colinfo id="ASK_SEQ" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="DS_TIEUPASK_OMS_DTL">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ROW_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="OPERATOR" size="256" summ="default" type="STRING"/>
					<colinfo id="BRCH_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="TUB_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ASK_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ASK_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="AFF_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="BNK_CHGR" size="256" summ="default" type="STRING"/>
					<colinfo id="AGC_CHGR" size="256" summ="default" type="STRING"/>
					<colinfo id="OCC_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="CLT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CLT_JMN" size="256" summ="default" type="STRING"/>
					<colinfo id="AFF_PRS_STS" size="256" summ="default" type="STRING"/>
					<colinfo id="ASK_EXP_DT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_mst_temp2"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dtl_temp2"></Dataset>
			<Dataset DataSetType="Dataset" Id="DS_DEPT_INFO">
				<Contents>
					<colinfo id="DTL_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DTL_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="DS_DEPT_INFO_N">
				<Contents>
					<colinfo id="DTL_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DTL_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="DS_DEPT_INFO_Y">
				<Contents>
					<colinfo id="DTL_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DTL_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user21" Bottom="46" Height="40" Id="Shape_Out" Left="687" LineColor="user22" Right="1234" RoundHeight="10" RoundUnit="Pixel" RoundWidth="10" TabOrder="12" Top="6" Type="RoundRect" Width="547"></Shape>
		<Grid AutoEnter="TRUE" AutoScrollBar="AlwaysVert" BindDataset="DS_TIEUPASK_NOT_MST" BkColor2="user55" BkSelColor="user54" BoldHead="FALSE" Border="Flat" Bottom="365" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" Font="돋움,9" HeadBorder="Flat" HeadHeight="24" Height="290" Id="GRD_TIEUPASK_NOT_MST" InputPanel="FALSE" LineColor="default" LineType="OnlyVERT" OnCellClick="GRD_TIEUPASK_NOT_MST_OnCellClick" OnCellDBLClick="GRD_TIEUPASK_NOT_MST_OnCellDblClick" OnHeadClick="GRD_TIEUPASK_NOT_MST_OnHeadClick" Right="675" RowHeight="20" Style="Grid_2" TabOrder="0" TabStop="FALSE" Top="75" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="675">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="0"/>
						<col width="30"/>
						<col width="0"/>
						<col width="120"/>
						<col width="120"/>
						<col width="80"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="0"/>
						<col width="60"/>
						<col width="0"/>
						<col width="0"/>
					</columns>
					<head>
						<cell bkcolor="user51" bkimagealign="stretch" col="0" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="No"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="1" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="No"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="2" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="제휴사코드"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="3" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="ASK_SEQ"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="4" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="제휴사명"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="5" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="결제담당자"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="6" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="미수금"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="7" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="발생금"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="8" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="부가세"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="9" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="청구금액"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="10" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="마지막청구"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="11" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="청구예정"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="12" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="청구예정일"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="13" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="운송방법"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="14" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="기준시작일"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="15" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="기준종료일"/>
					</head>
					<body>
						<cell align="center" col="0" display="text" expr="row&#32;+&#32;1" InputZeroTime="true"/>
						<cell align="center" col="1" display="text" expr="row&#32;+&#32;1" InputZeroTime="true"/>
						<cell align="center" col="2" colid="TUB_SEQ" display="normal" InputZeroTime="true"/>
						<cell align="left" col="3" colid="ASK_SEQ" display="normal" InputZeroTime="true"/>
						<cell align="left" col="4" colid="TUB_NM" display="normal" InputZeroTime="true"/>
						<cell align="center" col="5" colid="SIN_NM" display="normal" InputZeroTime="true"/>
						<cell align="right" col="6" colid="UNP_AMT" display="number" InputZeroTime="true"/>
						<cell align="right" col="7" colid="OCC_AMT" color="black" display="number" InputZeroTime="true"/>
						<cell align="right" col="8" colid="VAT_AMT" display="number" InputZeroTime="true"/>
						<cell align="right" col="9" colid="ASK_AMT" display="number" InputZeroTime="true"/>
						<cell align="center" col="10" colid="LST_ASK_DT" display="date" InputZeroTime="true"/>
						<cell align="center" col="11" colid="ASK_EXP_DT" display="date" InputZeroTime="true"/>
						<cell align="center" col="12" colid="ASK_EXP_DT" display="date" InputZeroTime="true"/>
						<cell align="center" col="13" colid="DOC_CARY" display="normal" InputZeroTime="true"/>
						<cell align="center" col="14" colid="BAS_ST_DT" display="date" InputZeroTime="true"/>
						<cell align="center" col="15" colid="BAS_ED_DT" display="date" InputZeroTime="true"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Shape Bottom="648" Height="648" Id="Shape0" Left="1234" LineColor="tomato" LineKind="Vertical" LineWidth="4" Right="1239" TabOrder="1" Top="0" Type="Rectangle" Visible="FALSE" Width="5"></Shape>
		<Image Align="Left" Height="14" Id="Image0" ImageID="Title_dot" LeftMargin="20" Style="Stc_Subtitle" TabOrder="4" Text="청구누락리스트" Top="375" Transparent="TRUE" Width="157"></Image>
		<Shape Bottom="394" Height="5" Id="Shape1" Left="-2" LineColor="seagreen" LineKind="Vertical" LineWidth="5" Right="1237" TabOrder="3" Top="389" Type="Rectangle" Visible="FALSE" Width="1239"></Shape>
		<Shape Bottom="371" Height="5" Id="Shape16" Left="-5" LineColor="seagreen" LineKind="Vertical" LineWidth="5" Right="1234" TabOrder="5" Top="366" Type="Rectangle" Visible="FALSE" Width="1239"></Shape>
		<Shape BKColor="user21" Bottom="46" Height="40" Id="Shape_search" Left="0" LineColor="user22" Right="683" RoundHeight="10" RoundUnit="Pixel" RoundWidth="10" TabOrder="7" Top="6" Type="RoundRect" Width="683"></Shape>
		<Shape Bottom="5" Height="5" Id="Shape15" Left="0" LineColor="seagreen" LineKind="Vertical" LineWidth="5" Right="1239" TabOrder="8" Top="0" Type="Rectangle" Visible="FALSE" Width="1239"></Shape>
		<Image Align="Left" Height="18" Id="Image3" ImageID="label_dot" Left="7" LeftMargin="12" Style="Stc_Default_bold" TabOrder="9" Text="제휴사" Top="17" Transparent="TRUE" Width="50"></Image>
		<Edit Border="Flat" Height="18" Id="S_TUB_NM_N" ImeMode="none" Left="68" LeftMargin="4" OnKeyDown="S_TUB_NM_N_OnKeyDown" Style="Edit" TabOrder="10" Top="17" Width="50"></Edit>
		<Image Align="Left" Height="18" Id="Image2" ImageID="label_dot" Left="122" LeftMargin="12" Style="Stc_Default_bold" TabOrder="11" Text="청구일" Top="17" Transparent="TRUE" Width="50"></Image>
		<Image Align="Left" Height="18" Id="Image8" ImageID="label_dot" Left="916" LeftMargin="12" Style="Stc_Default_bold" TabOrder="13" Text="청구일" Top="16" Transparent="TRUE" Width="58"></Image>
		<Image Align="Left" Height="14" Id="Image1" ImageID="Title_dot" LeftMargin="20" Style="Stc_Subtitle" TabOrder="15" Text="청구예정리스트" Top="56" Transparent="TRUE" Width="157"></Image>
		<Image Align="Left" Height="14" Id="Image4" ImageID="Title_dot" Left="688" LeftMargin="20" Style="Stc_Subtitle" TabOrder="16" Text="청구리스트" Top="56" Transparent="TRUE" Width="157"></Image>
		<Shape Bottom="75" Height="5" Id="Shape5" Left="-2" LineColor="seagreen" LineKind="Vertical" LineWidth="5" Right="1237" TabOrder="14" Top="70" Type="Rectangle" Visible="FALSE" Width="1239"></Shape>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="21" Id="btn_search_n" ImageID="Btn_sub_2w" Left="628" LeftMargin="16" OnClick="fn_search_dup" Style="Btn_sub" TabOrder="17" TabStop="FALSE" Text="조회" Top="17" TopMargin="1" Transparent="TRUE" Width="50"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="21" Id="btn_search_y" ImageID="Btn_sub_2w" Left="1179" LeftMargin="16" OnClick="fn_search_yes" Style="Btn_sub" TabOrder="18" TabStop="FALSE" Text="조회" Top="17" TopMargin="1" Transparent="TRUE" Width="50"></Button>
		<Shape Bottom="51" Height="5" Id="Shape2" Left="0" LineColor="seagreen" LineKind="Vertical" LineWidth="5" Right="1239" TabOrder="19" Top="46" Type="Rectangle" Visible="FALSE" Width="1239"></Shape>
		<Report Bottom="65" Height="16" Id="Report0" Left="888" Right="896" Top="49" Visible="FALSE" Width="8"></Report>
		<Combo Border="Flat" Height="18" Id="S_DT_GBN" Left="182" OnChanged="S_DT_GBN_OnChanged" ResetIndex="FIRST" ShadowColor="user2" Style="Combo" TabOrder="21" Top="16" Width="84"></Combo>
		<MaskEdit Border="Flat" BorderColor="INACTIVECAPTIONTEXT" Height="18" Id="S_ST_DT" Left="977" Mask="####-##-##" TabOrder="22" ToolTipText="날짜를&#32;입력안하시면&#32;전체&#32;기간&#32;검색&#32;가능합니다." Top="17" Type="STRING" Width="70"></MaskEdit>
		<Shape Bottom="48" Height="36" Id="Shape14" Left="1048" LineColor="tomato" LineKind="Vertical" LineWidth="5" Right="1053" TabOrder="25" Top="12" Type="Rectangle" Visible="FALSE" Width="5"></Shape>
		<Button Height="16" Id="BTN_ST_DT" ImageID="Btn_calendar" Left="1052" OnClick="BTN_ST_DT_OnClick" TabOrder="27" Text="Button1" Top="19" Width="16"></Button>
		<Static Height="13" Id="Static72" Left="1072" Style="Stc_Default" TabOrder="24" Text="~" Top="22" Width="15"></Static>
		<MaskEdit Border="Flat" BorderColor="INACTIVECAPTIONTEXT" Height="18" Id="S_ED_DT" Left="1084" Mask="####-##-##" TabOrder="23" ToolTipText="날짜를&#32;입력안하시면&#32;전체&#32;기간&#32;검색&#32;가능합니다" Top="17" Type="STRING" Width="70"></MaskEdit>
		<Shape Bottom="47" Height="36" Id="Shape3" Left="1155" LineColor="tomato" LineKind="Vertical" LineWidth="5" Right="1160" TabOrder="26" Top="11" Type="Rectangle" Visible="FALSE" Width="5"></Shape>
		<Button Height="16" Id="BTN_ED_DT" ImageID="Btn_calendar" Left="1159" OnClick="BTN_ED_DT_OnClick" TabOrder="28" Text="Button1" Top="18" Width="16"></Button>
		<Image Align="Left" Height="18" Id="Image5" ImageID="label_dot" Left="695" LeftMargin="12" Style="Stc_Default_bold" TabOrder="29" Text="제휴사" Top="17" Transparent="TRUE" Width="50"></Image>
		<Edit Border="Flat" Height="18" Id="S_TUB_NM_Y" ImeMode="none" Left="753" LeftMargin="4" OnKeyDown="S_TUB_NM_Y_OnKeyDown" Style="Edit" TabOrder="30" Top="17" Width="50"></Edit>
		<Image Align="Left" Height="18" Id="Image6" ImageID="label_dot" Left="366" LeftMargin="12" Style="Stc_Default_bold" TabOrder="31" Text="서류운송" Top="17" Transparent="TRUE" Width="66"></Image>
		<Combo Border="Flat" Height="18" Id="S_DOC_CARY" Left="437" ResetIndex="FIRST" ShadowColor="user2" Style="Combo" TabOrder="32" Top="16" Width="76"></Combo>
		<Image Align="Left" Height="18" Id="Image7" ImageID="label_dot" Left="176" LeftMargin="12" Style="Stc_Default_bold" TabOrder="33" Text="기준일자" Top="51" Transparent="TRUE" Width="66"></Image>
		<MaskEdit BindDataset="DS_TIEUPASK_NOT_MST" Border="Flat" BorderColor="INACTIVECAPTIONTEXT" Column="BAS_ST_DT" Height="18" Id="EDT_BAS_ST_DT" Left="244" Mask="####-##-##" TabOrder="34" ToolTipText="날짜를&#32;입력안하시면&#32;전체&#32;기간&#32;검색&#32;가능합니다." Top="52" Type="STRING" Width="70"></MaskEdit>
		<Shape Bottom="83" Height="36" Id="Shape8" Left="315" LineColor="tomato" LineKind="Vertical" LineWidth="5" Right="320" TabOrder="37" Top="47" Type="Rectangle" Visible="FALSE" Width="5"></Shape>
		<Button Height="16" Id="BTN_BAS_ST_DT" ImageID="Btn_calendar" Left="319" OnClick="BTN_BAS_ST_DT_OnClick" TabOrder="39" Text="Button1" Top="54" Width="16"></Button>
		<Static Height="13" Id="Static0" Left="339" Style="Stc_Default" TabOrder="36" Text="~" Top="56" Width="15"></Static>
		<MaskEdit BindDataset="DS_TIEUPASK_NOT_MST" Border="Flat" BorderColor="INACTIVECAPTIONTEXT" Column="BAS_ED_DT" Height="18" Id="EDT_BAS_ED_DT" Left="351" Mask="####-##-##" TabOrder="35" ToolTipText="날짜를&#32;입력안하시면&#32;전체&#32;기간&#32;검색&#32;가능합니다" Top="52" Type="STRING" Width="70"></MaskEdit>
		<Button Height="16" Id="BTN_BAS_ED_DT" ImageID="Btn_calendar" Left="426" OnClick="BTN_BAS_ED_DT_OnClick" TabOrder="39" Text="Button1" Top="53" Width="16"></Button>
		<Shape Bottom="82" Height="36" Id="Shape9" Left="422" LineColor="tomato" LineKind="Vertical" LineWidth="5" Right="427" TabOrder="38" Top="46" Type="Rectangle" Visible="FALSE" Width="5"></Shape>
		<Button Height="21" Id="btn_ask_add" Left="496" OnClick="btn_ask_add_OnClick" TabOrder="41" TabStop="FALSE" Text="비용청구" Top="49" Width="74"></Button>
		<Button Height="21" Id="btn_close" Left="575" OnClick="btn_close_OnClick" TabOrder="42" TabStop="FALSE" Text="확인(비용청구X)" Top="49" Width="98"></Button>
		<Shape Bottom="75" Height="32" Id="Shape10" Left="570" LineColor="tomato" LineKind="Vertical" LineWidth="4" Right="575" TabOrder="40" Top="43" Type="Rectangle" Visible="FALSE" Width="5"></Shape>
		<Shape Bottom="75" Height="32" Id="Shape11" Left="673" LineColor="tomato" LineKind="Vertical" LineWidth="4" Right="678" TabOrder="43" Top="43" Type="Rectangle" Visible="FALSE" Width="5"></Shape>
		<Button Height="21" Id="btn_ask_del" Left="1160" OnClick="btn_ask_del_OnClick" TabOrder="44" TabStop="FALSE" Text="청구취소" Top="49" Width="74"></Button>
		<Grid AutoEnter="TRUE" AutoScrollBar="AlwaysVert" BindDataset="DS_TIEUPASK_YES_MST" BkColor2="user55" BkSelColor="user54" BoldHead="FALSE" Border="Flat" Bottom="645" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" Font="돋움,9" HeadBorder="Flat" HeadHeight="24" Height="570" Id="GRD_TIEUPASK_YES_MST" InputPanel="FALSE" Left="688" LineColor="default" LineType="OnlyVERT" OnCellClick="GRD_TIEUPASK_YES_MST_OnCellClick" OnCellDBLClick="GRD_TIEUPASK_YES_MST_OnCellDblClick" OnHeadClick="GRD_TIEUPASK_YES_MST_OnHeadClick" Right="1235" RowHeight="20" Style="Grid_2" TabOrder="45" TabStop="FALSE" Top="75" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="547">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="0"/>
						<col width="30"/>
						<col width="0"/>
						<col width="120"/>
						<col width="90"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="80"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
					</columns>
					<head>
						<cell bkcolor="user51" bkimagealign="stretch" col="0" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="No"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="1" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="No"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="2" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="제휴사코드"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="3" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="제휴사명"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="4" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="결제담당자"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="5" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="미수금"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="6" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="발생금"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="7" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="부가세"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="8" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="청구금액"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="9" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="마지막청구"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="10" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="기준시작일"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="11" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="기준종료일"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="12" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="입금"/>
					</head>
					<body>
						<cell align="center" col="0" display="text" expr="row&#32;+&#32;1" InputZeroTime="true"/>
						<cell align="center" col="1" display="text" expr="row&#32;+&#32;1" InputZeroTime="true"/>
						<cell align="center" col="2" colid="TUB_SEQ" display="normal" InputZeroTime="true"/>
						<cell align="left" col="3" colid="TUB_NM" display="normal" InputZeroTime="true"/>
						<cell align="center" col="4" colid="SIN_NM" display="normal" InputZeroTime="true"/>
						<cell align="right" col="5" colid="UNP_AMT" display="number" InputZeroTime="true"/>
						<cell align="right" col="6" colid="OCC_AMT" color="black" display="number" InputZeroTime="true"/>
						<cell align="right" col="7" colid="VAT_AMT" display="number" InputZeroTime="true"/>
						<cell align="right" col="8" colid="ASK_AMT" display="number" InputZeroTime="true"/>
						<cell align="center" col="9" colid="LST_ASK_DT" display="date" InputZeroTime="true"/>
						<cell align="center" col="10" colid="BAS_ST_DT" display="date" InputZeroTime="true"/>
						<cell align="center" col="11" colid="BAS_ED_DT" display="date" InputZeroTime="true"/>
						<cell align="center" col="12" colid="PAY_YN" display="normal" InputZeroTime="true"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid AutoEnter="TRUE" AutoScrollBar="AlwaysVert" BindDataset="DS_TIEUPASK_OMS_MST" BkColor2="user55" BkSelColor="user54" BoldHead="FALSE" Border="Flat" Bottom="645" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" Font="돋움,9" HeadBorder="Flat" HeadHeight="24" Height="250" Id="GRD_TIEUPASK_OMS_LST" InputPanel="FALSE" LineColor="default" LineType="OnlyVERT" OnCellDBLClick="GRD_TIEUPASK_OMS_LST_OnCellDblClick" OnHeadClick="GRD_TIEUPASK_OMS_LST_OnHeadClick" Right="675" RowHeight="20" Style="Grid_2" TabOrder="46" TabStop="FALSE" Top="395" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="675">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="0"/>
						<col width="30"/>
						<col width="0"/>
						<col width="120"/>
						<col width="120"/>
						<col width="80"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="80"/>
						<col width="80"/>
						<col width="60"/>
						<col width="0"/>
						<col width="0"/>
					</columns>
					<head>
						<cell bkcolor="user51" bkimagealign="stretch" col="0" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="No"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="1" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="No"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="2" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="제휴사코드"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="3" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="ASK_SEQ"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="4" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="제휴사명"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="5" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="결제담당자"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="6" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="미수금"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="7" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="발생금"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="8" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="부가세"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="9" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="청구금"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="10" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="마지막청구"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="11" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="청구예정"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="12" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="운송방법"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="13" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="기준시작일"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="14" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="기준종료일"/>
					</head>
					<body>
						<cell align="center" col="0" display="text" expr="row&#32;+&#32;1" InputZeroTime="true"/>
						<cell align="center" col="1" display="text" expr="row&#32;+&#32;1" InputZeroTime="true"/>
						<cell align="center" col="2" colid="TUB_SEQ" display="normal" InputZeroTime="true"/>
						<cell align="left" col="3" colid="ASK_SEQ" display="normal" InputZeroTime="true"/>
						<cell align="left" col="4" colid="TUB_NM" display="normal" InputZeroTime="true"/>
						<cell align="center" col="5" colid="SIN_NM" display="normal" InputZeroTime="true"/>
						<cell align="right" col="6" colid="UNP_AMT" display="number" InputZeroTime="true"/>
						<cell align="right" col="7" colid="OCC_AMT" color="black" display="number" InputZeroTime="true"/>
						<cell align="right" col="8" colid="VAT_AMT" display="number" InputZeroTime="true"/>
						<cell align="right" col="9" colid="ASK_AMT" display="number" InputZeroTime="true"/>
						<cell align="center" col="10" colid="LST_DEAL_DT" display="date" InputZeroTime="true"/>
						<cell align="center" col="11" colid="ASK_EXP_DT" display="date" InputZeroTime="true"/>
						<cell align="center" col="12" colid="DOC_CARY" display="normal" InputZeroTime="true"/>
						<cell align="center" col="13" colid="BAS_ST_DT" display="date" InputZeroTime="true"/>
						<cell align="center" col="14" colid="BAS_ED_DT" display="date" InputZeroTime="true"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Shape Bottom="45" Height="40" Id="Shape28" Left="60" LineColor="slateblue" LineKind="Vertical" LineWidth="4" Right="68" TabOrder="47" Top="5" Type="Rectangle" Visible="FALSE" Width="8"></Shape>
		<Shape Bottom="45" Height="40" Id="Shape12" Left="175" LineColor="slateblue" LineKind="Vertical" LineWidth="4" Right="183" TabOrder="48" Top="5" Type="Rectangle" Visible="FALSE" Width="8"></Shape>
		<Shape Bottom="45" Height="40" Id="Shape4" Left="430" LineColor="slateblue" LineKind="Vertical" LineWidth="4" Right="438" TabOrder="49" Top="5" Type="Rectangle" Visible="FALSE" Width="8"></Shape>
		<Shape Bottom="45" Height="40" Id="Shape6" Left="745" LineColor="slateblue" LineKind="Vertical" LineWidth="4" Right="753" TabOrder="50" Top="5" Type="Rectangle" Visible="FALSE" Width="8"></Shape>
		<Shape Bottom="45" Height="40" Id="Shape7" Left="967" LineColor="slateblue" LineKind="Vertical" LineWidth="4" Right="975" TabOrder="51" Top="5" Type="Rectangle" Visible="FALSE" Width="8"></Shape>
		<Button Height="21" Id="btn_print" Left="1024" OnClick="btn_print_OnClick" TabOrder="53" TabStop="FALSE" Text="비용청구내역서출력" Top="49" Width="130"></Button>
		<Shape Bottom="75" Height="32" Id="Shape13" Left="1154" LineColor="tomato" LineKind="Vertical" LineWidth="4" Right="1159" TabOrder="52" Top="43" Type="Rectangle" Visible="FALSE" Width="5"></Shape>
		<MaskEdit Border="Flat" BorderColor="INACTIVECAPTIONTEXT" Height="18" Id="S_CUR_DT" Left="269" Mask="####-##-##" TabOrder="54" ToolTipText="날짜를&#32;입력안하시면&#32;전체&#32;기간&#32;검색&#32;가능합니다." Top="17" Type="STRING" Width="70"></MaskEdit>
		<Shape Bottom="47" Height="36" Id="Shape17" Left="339" LineColor="tomato" LineKind="Vertical" LineWidth="5" Right="344" TabOrder="55" Top="11" Type="Rectangle" Visible="FALSE" Width="5"></Shape>
		<Button Height="16" Id="BTN_CUR_DT" ImageID="Btn_calendar" Left="343" OnClick="BTN_CUR_DT_OnClick" TabOrder="56" Text="Button1" Top="18" Width="16"></Button>
		<Button Height="21" Id="btn_oms_add" Left="496" OnClick="btn_oms_add_OnClick" TabOrder="58" TabStop="FALSE" Text="비용청구" Top="369" Width="74"></Button>
		<Shape Bottom="395" Height="32" Id="Shape18" Left="570" LineColor="tomato" LineKind="Vertical" LineWidth="4" Right="575" TabOrder="57" Top="363" Type="Rectangle" Visible="FALSE" Width="5"></Shape>
		<Button Height="21" Id="btn_oms_close" Left="575" OnClick="btn_oms_close_OnClick" TabOrder="59" TabStop="FALSE" Text="확인(비용청구X)" Top="369" Width="98"></Button>
		<Shape Bottom="395" Height="32" Id="Shape19" Left="673" LineColor="tomato" LineKind="Vertical" LineWidth="4" Right="678" TabOrder="60" Top="363" Type="Rectangle" Visible="FALSE" Width="5"></Shape>
		<Image Align="Left" Height="18" Id="Image9" ImageID="label_dot" Left="518" LeftMargin="12" Style="Stc_Default_bold" TabOrder="61" Text="팀" Top="17" Transparent="TRUE" Width="26"></Image>
		<Shape Bottom="45" Height="40" Id="Shape20" Left="543" LineColor="slateblue" LineKind="Vertical" LineWidth="4" Right="551" TabOrder="63" Top="5" Type="Rectangle" Visible="FALSE" Width="8"></Shape>
		<Combo Border="Flat" Height="18" Id="S_DEPT_CD" Left="550" ResetIndex="FIRST" ShadowColor="user2" Style="Combo" TabOrder="62" Top="16" Width="76"></Combo>
		<Combo Border="Flat" Height="18" Id="S_USE_YN" Left="854" ResetIndex="FIRST" ShadowColor="user2" Style="Combo" TabOrder="64" Top="16" Width="60"></Combo>
		<Shape Bottom="45" Height="40" Id="Shape21" Left="847" LineColor="slateblue" LineKind="Vertical" LineWidth="4" Right="855" TabOrder="65" Top="5" Type="Rectangle" Visible="FALSE" Width="8"></Shape>
		<Image Align="Left" Height="18" Id="Image10" ImageID="label_dot" Left="806" LeftMargin="12" Style="Stc_Default_bold" TabOrder="66" Text="상태" Top="17" Transparent="TRUE" Width="42"></Image>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
* FormID(명) : 비용청구
* 작성자     : 이용재
* 작성일     : 2013-02-13 : 최초 생성
* 기능설명   : 비용청구 관리
* 변경로그
* Date             Ver          Name        Description
* ---------------  ------   ----------  ---------------------------
* 2013-02-13       V1.0                  initial ver.
***************************************************************************************************/


/**************************************************************************************************
  * 공통 Script Include
***************************************************************************************************/
#include "lib::lib_global.js";
#include "lib::lib_comm.js";
#include "lib::lib_grid.js";
#include "lib::lib_platform.js";
#include "lib::lib_popup.js";
#include "lib::lib_msg.js";
#include "lib::lib_ext.js";
#include "lib::lib_file.js";
#include "lib::lib_report.js";


/**************************************************************************************************
  * 화면 변수 선언부
***************************************************************************************************/

var svcID			= "";		
var url   			= "";
var inDatasets  	= "";
var outDatasets 	= "";
var argument    	= "";
var callbackFunc 	= "";
var curDate = "";

var curAskRow          = "";
var curOmsRow          = "";

var prtBrchid = "";
var prtTubSeq = "";
var prtAskSeq = "";



/**************************************************************************************************
  * 공통 Function 처리 부분
***************************************************************************************************/
//  1-1.화면 셋팅 함수 
//  1-2.조회 함수     
//  1-3.저장 함수    
//  1-4.삭제 함수    
//  1-5.Transaction 후 처리 해야 할 내용

//*------------------------------------------------------------------------
//* 함수설명     : 1.1 화면셋팅 함수 
//* 함수유형     :
//* parameter    :
//* return value : 없음
//* 비고         :
//*------------------------------------------------------------------------
function fn_initForm()
{

	//*------------------------------------------------------------------------
    //* 리사이즈 컨포넌트 정의
	//* H: 가로 리사이즈
	//* W: 세로 리사이즈
	//* A: 가로세로 리사이즈
	//* R: Resize
	//* M: Move
	//* Quick view로 테스트시 주석처리 후 테스트
    //*------------------------------------------------------------------------
	gfn_SetResize(this, "Shape_Out:H:R GRD_TIEUPASK_OMS_LST:W:R GRD_TIEUPASK_YES_MST:A:R GRD_AFFAIRDELAY_LST:H:R  btn_search_y:H:M btn_ask_del:H:M btn_print:H:M");

	//gfn_SetResize(this, "GRD_BONDSPOT_LST:H:R GRD_AFFAIRDELAY_LST:H:R ");


	// 비용청구일구분
	gfn_comCodeCombo(S_DT_GBN, "AD12", "N","");

	// 서류접수방법
	gfn_comCodeCombo(S_DOC_CARY, "AC05", "","전체");


	// 청구사용상태
	gfn_comCodeCombo(S_USE_YN, "AD18", "","전체");
	
	
	// 공통 명령어 조정
	gfn_set_cbutton("조회:fn_search");
		
	
	//curDate = '20131226';
	
	// 기본 기간은 오늘  
	gfn_get_date('TODAY',0,'YYYYMMDD');	

	// 임시날짜 넣기
	//GDS_DATE_TYPE.SetColumn(0,'DATE_VAL', '20140306');
	
	
	S_ST_DT.Text = GDS_DATE_TYPE.GetColumn(0,'DATE_VAL');
	S_ED_DT.Text = GDS_DATE_TYPE.GetColumn(0,'DATE_VAL');
	S_CUR_DT.Text = GDS_DATE_TYPE.GetColumn(0,'DATE_VAL');
	
	fn_get_dept_info(GDS_USER_INFO.BRCH_ID);
	
	
	fn_Search();
	
}


//*------------------------------------------------------------------------------------------------
//* 함수설명     : 1.2 조회 함수 
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function fn_search()
{
	fn_search_not();
	fn_search_yes();
	fn_search_oms();
	
}

//*------------------------------------------------------------------------------------------------
//* 함수설명     : 1.2 청구예정, 청구누락 조회 
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function fn_search_dup()
{
	fn_search_not();
	fn_search_oms();
	
}




//*------------------------------------------------------------------------------------------------
//* 함수설명     : 1.2  청구예정 조회 함수 
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function fn_search_not()
{
	DS_TIEUPASK_NOT_MST.ClearData();
	DS_TIEUPASK_NOT_DTL.ClearData();
	
	svcID			= "ACAD01T01.selectAskNotMst";
	url   			= "service::common/select_mi.do";
	inDatasets  	= "";
	outDatasets 	= "DS_TIEUPASK_NOT_MST=ac.ACAffairDAO.selectAskNotMst"
						+ " DS_TIEUPASK_NOT_DTL=ac.ACAffairDAO.selectAskNotDtl"

					;	

	argument    	= " _sqlName=ac.ACAffairDAO.selectAskNotMst"
							+ ",ac.ACAffairDAO.selectAskNotDtl"
							+ " S_BRCH_ID=" + quote(GDS_USER_INFO.BRCH_ID)
							+ " S_TUB_NM="+quote(S_TUB_NM_N.Text)
							+ " S_DT_GBN="+quote(S_DT_GBN.Value)
							+ " S_CUR_DT="+quote(S_CUR_DT.Value)
							+ " S_DOC_CARY="+quote(S_DOC_CARY.Value)
							+ " S_DEPT_CD="+quote(S_DEPT_CD.Value)
							+ " OPERATOR=" + quote(GDS_USER_INFO.USR_ID);							
	
	callbackFunc 	= "gfn_callback";
	
//	TRACE('argument='+argument);

	gfn_showProgressWindow(true);
	gfn_Transaction(svcID, url, inDatasets, outDatasets, argument, callbackFunc);	 	
	

}





//*------------------------------------------------------------------------------------------------
//* 함수설명     : 1.2  접수목록 조회 함수 
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function fn_search_yes()
{
	
	DS_TIEUPASK_YES_MST.ClearData();
	
	svcID			= "ACAD01T01.selectAskYesMst";
	url   			= "service::common/select_mi.do";
	inDatasets  	= "";
	outDatasets 	= "DS_TIEUPASK_YES_MST=ac.ACAffairDAO.selectAskYesMst";
						
						
	argument    	= " _sqlName=ac.ACAffairDAO.selectAskYesMst"
							+ " S_BRCH_ID=" + quote(GDS_USER_INFO.BRCH_ID)
							+ " S_TUB_NM="+quote(S_TUB_NM_Y.Text)
							+ " S_ST_DT=" + gfn_DateQuote(S_ST_DT.Text)
							+ " S_ED_DT=" + gfn_DateQuote(S_ED_DT.Text)	
							+ " S_DEPT_CD="+quote(S_DEPT_CD.Value)
							+ " S_USE_YN="+quote(S_USE_YN.Value)
							+ " OPERATOR=" + quote(GDS_USER_INFO.USR_ID);							
	
	callbackFunc 	= "gfn_callback";

	gfn_showProgressWindow(true);
	gfn_Transaction(svcID, url, inDatasets, outDatasets, argument, callbackFunc);	 	
	

}


//*------------------------------------------------------------------------------------------------
//* 함수설명     : 청구누락리스트 
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function fn_search_oms()
{
	
	DS_TIEUPASK_OMS_MST.ClearData();
	DS_TIEUPASK_OMS_DTL.ClearData();
	
	svcID			= "ACAA02T01.selectAskOmsMst";
	url   			= "service::common/select_mi.do";
	inDatasets  	= "";
	outDatasets 	= "DS_TIEUPASK_OMS_MST=ac.ACAffairDAO.selectAskOmsMst"
						+ " DS_TIEUPASK_OMS_DTL=ac.ACAffairDAO.selectAskOmsDtl"
	
							;	

	argument    	= " _sqlName=ac.ACAffairDAO.selectAskOmsMst"
							+ ",ac.ACAffairDAO.selectAskOmsDtl"
							+ " S_BRCH_ID=" + quote(GDS_USER_INFO.BRCH_ID)
							+ " S_TUB_NM="+quote(S_TUB_NM_N.Text)
							+ " S_DT_GBN="+quote(S_DT_GBN.Value)
							+ " S_CUR_DT="+quote(S_CUR_DT.Value)
							+ " S_DOC_CARY="+quote(S_DOC_CARY.Value)
							+ " S_DEPT_CD="+quote(S_DEPT_CD.Value)
							+ " OPERATOR=" + quote(GDS_USER_INFO.USR_ID);							
	
	callbackFunc 	= "gfn_callback";

	gfn_showProgressWindow(true);
	gfn_Transaction(svcID, url, inDatasets, outDatasets, argument, callbackFunc);	 	

}



//*------------------------------------------------------------------------------------------------
//* 함수설명     : 1.5 Transaction 호출후 결과값 확인 (gfn_callback에서 fn_callback을 호출한다.)
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function fn_callback(svcID, errorCode, errorMsg)
{

//	trace('call mst/dtl/note='+curNotRow+'/'+curYesRow+'/'+curNoteRow);

	switch(svcID) 
	{		
		// 청구예정 조회
		case "ACAD01T01.selectAskNotMst" :
		break;	

		// 청구리스트 조회
		case "ACAD01T01.selectAskYesMst" :

		break;	

		// 청구누락 리스트 조회
		case "ACAD01T01.selectAskOmsMst" :

		break;



		// 부서정보 
		case "ACAD01T01.selectDeptInfo" :
			
			gfn_comCodeDSCombo(S_DEPT_CD, "DS_DEPT_INFO", GDS_USER_INFO.DEPT_CD, "전체");		//  

		break;
		
		
		// 확인(비용청구X)
		case "ACAD01T01.closeTieupAsk" :
			gfn_setMsg("청구예정 확인(비용청구X) 완료.");
			fn_search_not();
			fn_search_oms();
			break;	

		// 청구누락확인(비용청구X)
		case "ACAD01T01.closeTieupAskOms" :
			gfn_setMsg("청구누락 확인(비용청구X) 완료.");
			fn_search_not();
			fn_search_oms();
			break;	

		
		
		// 순번 가져오기 
		case "ACAD01T01.selectAskSeq" :

		break;
				
		// 비용청구
		case "ACAD01T01.saveTieupAskMst" :
			gfn_setMsg("비용청구 완료.");
			
			
			// 청구 끝나면 청구내역서 자동 출력
			fn_tieupask_print(prtBrchid,
						prtTubSeq,
						prtAskSeq,
						S_CUR_DT.Text
					  );
			
			
			fn_search_not();
			fn_search_yes();
			fn_search_oms();
			break;			
						
		
		// 청구누락의 비용청구
		case "ACAD01T01.saveTieupAskOmsMst" :
			gfn_setMsg("청구누락의 비용청구 완료.");
			
			
			
			// 청구 끝나면 청구내역서 자동 출력
			fn_tieupask_print(prtBrchid,
						prtTubSeq,
						prtAskSeq,
						S_CUR_DT.Text
					  );
			
			
			fn_search_not();
			fn_search_yes();
			fn_search_oms();
			break;			
		
		// 청구취소
		case "ACAD01T01.deleteTieupAskMst" :
			gfn_setMsg("청구취소 완료.");
			fn_search_not();
			fn_search_yes();	
			fn_search_oms();	
		break;	
		
		
		

		default:
	}


}


// 청구내역서 출력
function fn_tieupask_print(brch_id, tub_seq, ask_seq, ask_dt)
{
	var mrd = "";
	var param = "";

	mrd = "PG_AC_TIEUPASK_LST.mrd";
	
	
	param = "/rp ["
			+brch_id+"] ["        // 회사코드 1
			+tub_seq+"] ["  // 제휴사
			+ask_seq+"] ["  // 청구순번
			+ask_dt+"]"  // 청구일
			;
			
	trace('rp param='+param);		
			

	gfn_viewReport(Report0, mrd, param, true);	
}



/**************************************************************************************************
  * 사용자 정의  Function 처리 부분

***************************************************************************************************/

//*------------------------------------------------------------------------------------------------
//* 함수설명     : 팀정보 가져오기 
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function fn_get_dept_info(brch_id)
{
	
	svcID			= "ACAD01T01.selectDeptInfo";
	url   			= "service::common/select_mi.do";
	inDatasets  	= "";
	outDatasets 	= "DS_DEPT_INFO=cc.CCDeptDAO.selectDeptCode";	
	
	argument    	= " _sqlName=cc.CCDeptDAO.selectDeptCode"
					+ " S_BRCH_ID=" + quote(brch_id)
					+ " S_DEPT_CD=" + quote('')
					;
					
	callbackFunc 	= "gfn_callback";

	gfn_SyncTransaction(svcID, url, inDatasets, outDatasets, argument, callbackFunc);	
	    
}

//*------------------------------------------------------------------------------------------------
//* 함수설명     : 청구 코드 채번
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function fn_get_ask_seq(brch_id, tub_seq)
{
	
	svcID			= "ACAD01T01.selectAskSeq";
	url   			= "service::common/select_mi.do";
	inDatasets  	= "";
	outDatasets 	= "DS_ASK_SEQ=ac.ACAffairDAO.selectAskSeq";	
	
	argument    	= " _sqlName=ac.ACAffairDAO.selectAskSeq"
					+ " S_BRCH_ID=" + quote(brch_id)
					+ " S_TUB_SEQ="+quote(tub_seq);
					
	callbackFunc 	= "gfn_callback";

	gfn_SyncTransaction(svcID, url, inDatasets, outDatasets, argument, callbackFunc);	
	    
	return DS_ASK_SEQ.GetColumn(0, "ASK_SEQ");    
}

//*------------------------------------------------------------------------------------------------
//* 함수설명     : 확인(비용청구X)
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//*-----------------------------------------------------------------------------------------------
function btn_close_OnClick(obj)
{
	
	
	// 선택유무 체크  
	if(length(DS_TIEUPASK_NOT_MST.GetColumn(DS_TIEUPASK_NOT_MST.currow,"TUB_SEQ")) == 0)
	{
		gfn_popup_message("modal", "error", "확인(비용청구X)할 항목을 먼저 선택하세요.", "확인");
		return;
	}

	// 대상 사건만 사건 종료 처리한다.
	if(gfn_popup_message("modal", "confirm", "선택된 청구예정 항목을  청구예정리스트에서 비용청구 없이 완료 처리 하시겠습니까?", "확인")) 
	{	
		
		var brch_id = DS_TIEUPASK_NOT_MST.GetColumn(DS_TIEUPASK_NOT_MST.currow,"BRCH_ID");
		var tub_seq = DS_TIEUPASK_NOT_MST.GetColumn(DS_TIEUPASK_NOT_MST.currow,"TUB_SEQ");
		var ASK_SEQ = DS_TIEUPASK_NOT_MST.GetColumn(DS_TIEUPASK_NOT_MST.currow,"ASK_SEQ");
		
		// 필터 
		DS_TIEUPASK_NOT_DTL.FireEvent = false;		
		DS_TIEUPASK_NOT_DTL.UnFilter();
		DS_TIEUPASK_NOT_DTL.Filter("BRCH_ID=  '"+brch_id+"' && TUB_SEQ ='"+tub_seq+"' && ASK_SEQ ='"+ASK_SEQ+"'");	
		
		ds_dtl_temp.ClearData();
		ds_dtl_temp.CopyF("DS_TIEUPASK_NOT_DTL");	
	
		svcID			= "ACAD01T01.closeTieupAsk";
		url   			= "service::common/select_mi.do";
		inDatasets  	= "ac.ACAffairDAO.closeTieupAsk=ds_dtl_temp:A";
		
		outDatasets 	= "";
		argument    	= " _sqlName=ac.ACAffairDAO.closeTieupAsk"
						;
		callbackFunc 	= "gfn_callback";	
	
	
		gfn_showProgressWindow(true);
		gfn_Transaction(svcID, url, inDatasets, outDatasets, argument, callbackFunc);	
	

		DS_TIEUPASK_NOT_DTL.UnFilter();
		DS_TIEUPASK_NOT_DTL.FireEvent = true;	
		
	
	}
}


//*------------------------------------------------------------------------------------------------
//* 함수설명     : 청구누락 확인(비용청구X)
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//*-----------------------------------------------------------------------------------------------
function btn_oms_close_OnClick(obj)
{
	
	
	// 선택유무 체크  
	if(length(DS_TIEUPASK_OMS_MST.GetColumn(DS_TIEUPASK_OMS_MST.currow,"TUB_SEQ")) == 0)
	{
		gfn_popup_message("modal", "error", "확인(비용청구X)할 항목을 먼저 선택하세요.", "확인");
		return;
	}

	// 대상 사건만 사건 종료 처리한다.
	if(gfn_popup_message("modal", "confirm", "선택된 청구누락 항목을  청구누락리스트에서 비용청구 없이 완료 처리 하시겠습니까?", "확인")) 
	{	
		
		var brch_id = DS_TIEUPASK_OMS_MST.GetColumn(DS_TIEUPASK_OMS_MST.currow,"BRCH_ID");
		var tub_seq = DS_TIEUPASK_OMS_MST.GetColumn(DS_TIEUPASK_OMS_MST.currow,"TUB_SEQ");
		var ASK_SEQ = DS_TIEUPASK_OMS_MST.GetColumn(DS_TIEUPASK_OMS_MST.currow,"ASK_SEQ");
		
		// 필터 
		DS_TIEUPASK_OMS_DTL.FireEvent = false;		
		DS_TIEUPASK_OMS_DTL.UnFilter();
		DS_TIEUPASK_OMS_DTL.Filter("BRCH_ID=  '"+brch_id+"' && TUB_SEQ ='"+tub_seq+"' && ASK_SEQ ='"+ASK_SEQ+"'");	
		
		ds_dtl_temp.ClearData();
		ds_dtl_temp.CopyF("DS_TIEUPASK_OMS_DTL");	
	
		svcID			= "ACAD01T01.closeTieupAskOms";
		url   			= "service::common/select_mi.do";
		inDatasets  	= "ac.ACAffairDAO.closeTieupAsk=ds_dtl_temp:A";
		
		outDatasets 	= "";
		argument    	= " _sqlName=ac.ACAffairDAO.closeTieupAsk"
						;
		callbackFunc 	= "gfn_callback";	
	
	
		gfn_showProgressWindow(true);
		gfn_Transaction(svcID, url, inDatasets, outDatasets, argument, callbackFunc);	
	

		DS_TIEUPASK_OMS_DTL.UnFilter();
		DS_TIEUPASK_OMS_DTL.FireEvent = true;	
		
	
	}
}



//*------------------------------------------------------------------------------------------------
//* 함수설명     : 비용청구
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//*-----------------------------------------------------------------------------------------------
function btn_ask_add_OnClick(obj)
{
	
	
	// 선택유무 체크  
	if(length(DS_TIEUPASK_NOT_MST.GetColumn(DS_TIEUPASK_NOT_MST.currow,"TUB_SEQ")) == 0)
	{
		gfn_popup_message("modal", "error", "비용청구할 항목을 먼저 선택하세요.", "확인");
		return;
	}

	// 비용청구 처리 .
	if(gfn_popup_message("modal", "confirm", "선택된 청구예정 항목을  비용청구 하시겠습니까?", "확인")) 
	{	

		prtBrchid = DS_TIEUPASK_NOT_MST.GetColumn(DS_TIEUPASK_NOT_MST.currow,"BRCH_ID");
		prtTubSeq = DS_TIEUPASK_NOT_MST.GetColumn(DS_TIEUPASK_NOT_MST.currow,"TUB_SEQ");
		prtAskSeq = DS_TIEUPASK_NOT_MST.GetColumn(DS_TIEUPASK_NOT_MST.currow,"ASK_SEQ");

	
		DS_TIEUPASK_NOT_MST.FireEvent = false;		
		DS_TIEUPASK_NOT_MST.UnFilter();
		
		DS_TIEUPASK_NOT_DTL.FireEvent = false;		
		DS_TIEUPASK_NOT_DTL.UnFilter();
		
		DS_TIEUPASK_NOT_MST.Filter("BRCH_ID=  '"+prtBrchid+"' && TUB_SEQ ='"+prtTubSeq+"' && ASK_SEQ='"+prtAskSeq+"'");	
		DS_TIEUPASK_NOT_DTL.Filter("BRCH_ID=  '"+prtBrchid+"' && TUB_SEQ ='"+prtTubSeq+"' && ASK_SEQ='"+prtAskSeq+"'");


//		trace('DS_TIEUPASK_NOT_MST='+gfn_dsToString(DS_TIEUPASK_NOT_MST));
//		trace('DS_TIEUPASK_NOT_DTL='+gfn_dsToString(DS_TIEUPASK_NOT_DTL));


		ds_mst_temp.ClearData();
		ds_mst_temp.CopyF("DS_TIEUPASK_NOT_MST");	
		
		ds_dtl_temp.ClearData();
		ds_dtl_temp.CopyF("DS_TIEUPASK_NOT_DTL");	


		svcID			= "ACAD01T01.saveTieupAskMst";
		url   			= "service::common/select_mi.do";
		inDatasets  	= "ac.ACAffairDAO.saveTieupAskMst=ds_mst_temp:A"
						+ " ac.ACAffairDAO.saveTieupAskDtl=ds_dtl_temp:A";
		
		outDatasets 	= "";
		argument    	= " _sqlName=ac.ACAffairDAO.saveTieupAskMst"
						+ ",ac.ACAffairDAO.saveTieupAskDtl"	
						;
		callbackFunc 	= "gfn_callback";	
	
	
		gfn_showProgressWindow(true);
		gfn_Transaction(svcID, url, inDatasets, outDatasets, argument, callbackFunc);	

		DS_TIEUPASK_NOT_MST.UnFilter();
		DS_TIEUPASK_NOT_DTL.UnFilter();
	
		DS_TIEUPASK_NOT_MST.FireEvent = true;		
		DS_TIEUPASK_NOT_DTL.FireEvent = true;		
	
	}
}




//*------------------------------------------------------------------------------------------------
//* 함수설명     : 청누구락의 비용청구 
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//*-----------------------------------------------------------------------------------------------
function btn_oms_add_OnClick(obj)
{
	
	
	// 선택유무 체크  
	if(length(DS_TIEUPASK_OMS_MST.GetColumn(DS_TIEUPASK_OMS_MST.currow,"TUB_SEQ")) == 0)
	{
		gfn_popup_message("modal", "error", "비용청구할 항목을 먼저 선택하세요.", "확인");
		return;
	}

	// 비용청구 처리 .
	if(gfn_popup_message("modal", "confirm", "선택된 청구누락 항목을  비용청구 하시겠습니까?", "확인")) 
	{	

		
		prtBrchid = DS_TIEUPASK_OMS_MST.GetColumn(DS_TIEUPASK_OMS_MST.currow,"BRCH_ID");
		prtTubSeq = DS_TIEUPASK_OMS_MST.GetColumn(DS_TIEUPASK_OMS_MST.currow,"TUB_SEQ");
		prtAskSeq = DS_TIEUPASK_OMS_MST.GetColumn(DS_TIEUPASK_OMS_MST.currow,"ASK_SEQ");


		DS_TIEUPASK_OMS_MST.FireEvent = false;		
		DS_TIEUPASK_OMS_MST.UnFilter();
		
		DS_TIEUPASK_OMS_DTL.FireEvent = false;		
		DS_TIEUPASK_OMS_DTL.UnFilter();
		
		DS_TIEUPASK_OMS_MST.Filter("BRCH_ID=  '"+prtBrchid+"' && TUB_SEQ ='"+prtTubSeq+"' && ASK_SEQ='"+prtAskSeq+"'");	
		DS_TIEUPASK_OMS_DTL.Filter("BRCH_ID=  '"+prtBrchid+"' && TUB_SEQ ='"+prtTubSeq+"' && ASK_SEQ='"+prtAskSeq+"'");
		
		ds_mst_temp.ClearData();
		ds_mst_temp.CopyF("DS_TIEUPASK_OMS_MST");	
		
		ds_dtl_temp.ClearData();
		ds_dtl_temp.CopyF("DS_TIEUPASK_OMS_DTL");	
		
		
		
		svcID			= "ACAD01T01.saveTieupAskOmsMst";
		url   			= "service::common/select_mi.do";
		inDatasets  	= "ac.ACAffairDAO.saveTieupAskMst=ds_mst_temp:A"
						+ " ac.ACAffairDAO.saveTieupAskDtl=ds_dtl_temp:A";
		
		outDatasets 	= "";
		argument    	= " _sqlName=ac.ACAffairDAO.saveTieupAskMst"
						+ ",ac.ACAffairDAO.saveTieupAskDtl"	
						;
		callbackFunc 	= "gfn_callback";	
	
	
		gfn_showProgressWindow(true);
		gfn_Transaction(svcID, url, inDatasets, outDatasets, argument, callbackFunc);	
	

		DS_TIEUPASK_OMS_MST.UnFilter();
		DS_TIEUPASK_OMS_DTL.UnFilter();
	
		DS_TIEUPASK_OMS_MST.FireEvent = true;		
		DS_TIEUPASK_OMS_DTL.FireEvent = true;	
	
	}
}


//*------------------------------------------------------------------------------------------------
//* 함수설명     : 청구취소
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//*-----------------------------------------------------------------------------------------------
function btn_ask_del_OnClick(obj)
{
	
	
	// 선택유무 체크  
	if(length(DS_TIEUPASK_YES_MST.GetColumn(DS_TIEUPASK_YES_MST.currow,"TUB_SEQ")) == 0)
	{
		gfn_popup_message("modal", "error", "청구취소할 항목을 먼저 선택하세요.", "확인");
		return;
	}


	// 입금 들어간 청구건은 삭제 불가 
	if(DS_TIEUPASK_YES_MST.GetColumn(DS_TIEUPASK_YES_MST.currow,"PAY_YN") == 'Y')
	{
		gfn_popup_message("modal", "error", "입금 진행중인 청구건은 입금 삭제 이전에 청구 취소가 불가능 합니다.", "확인");
		return;
	}

	// 비용청구 처리 .
	if(gfn_popup_message("modal", "confirm", "선택된 항목을  청구취소 하시겠습니까?", "확인")) 
	{	

		prtBrchid = DS_TIEUPASK_YES_MST.GetColumn(DS_TIEUPASK_YES_MST.currow,"BRCH_ID");
		prtTubSeq = DS_TIEUPASK_YES_MST.GetColumn(DS_TIEUPASK_YES_MST.currow,"TUB_SEQ");
		prtAskSeq = DS_TIEUPASK_YES_MST.GetColumn(DS_TIEUPASK_YES_MST.currow,"ASK_SEQ");

		
		// 필터 
		DS_TIEUPASK_YES_MST.FireEvent = false;		
		DS_TIEUPASK_YES_MST.UnFilter();
		DS_TIEUPASK_YES_MST.Filter("BRCH_ID=  '"+prtBrchid+"' && TUB_SEQ ='"+prtTubSeq+"' && ASK_SEQ ='"+prtAskSeq+"'");	

		
		ds_mst_temp.ClearData();
		ds_mst_temp.CopyF("DS_TIEUPASK_YES_MST");	
		
		svcID			= "ACAD01T01.deleteTieupAskMst";
		url   			= "service::common/select_mi.do";
		inDatasets  	= "ac.ACAffairDAO.deleteTieupAskMst=ds_mst_temp:A";
						
		outDatasets 	= "";
		argument    	= " _sqlName=ac.ACAffairDAO.deleteTieupAskMst"
						;
		callbackFunc 	= "gfn_callback";	
	
	
		gfn_showProgressWindow(true);
		gfn_Transaction(svcID, url, inDatasets, outDatasets, argument, callbackFunc);	
	
		DS_TIEUPASK_YES_MST.UnFilter();
		DS_TIEUPASK_YES_MST.FireEvent = true;		
	}
}





/**************************************************************************************************
  * 공통 Event 처리 부분
***************************************************************************************************/
//  2-1.Load 부분
//  2-2.UnLoad 부분
//  2-3 onSize 부분
//  2-4.초기화 부분
//  2-5.조회 버튼 클릭     
//  2-6.저장 버튼 클릭    
//  2-7.삭제 버튼 클릭    
//  2-8.엑셀 버튼 클릭    

//*------------------------------------------------------------------------------------------------
//* 함수설명     : 2-1.화면 Load 완료시 실행 스크립트 
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function ACAD01T01_OnLoadCompleted(obj)
{
	// 공통 init
	gfn_OnInit();
	
	// 폼초기화 
	fn_initForm();

}

//*------------------------------------------------------------------------------------------------
//* 함수설명     : 2-2.화면 Unload 시 실행 스크립트
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function ACAD01T01_OnUnloadCompleted(obj)
{
	fn_save();
	gfn_OnBeforeExit();
}








/**************************************************************************************************
  * 사용자 정의  Event 처리 부분
***************************************************************************************************/


//*------------------------------------------------------------------------------------------------
//* 함수설명     :  Grid  셀 클릭시 
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//*-----------------------------------------------------------------------------------------------
function GRD_TIEUPASK_NOT_MST_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{

}



function GRD_TIEUPASK_YES_MST_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{

}


//*------------------------------------------------------------------------------------------------
//* 함수설명     :  Grid  셀 더블 클릭시 
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//*-----------------------------------------------------------------------------------------------
function GRD_TIEUPASK_NOT_MST_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{

	DS_TIEUPASK_NOT_DTL.UnFilter();
	DS_TIEUPASK_NOT_DTL.Filter("BRCH_ID='"+DS_TIEUPASK_NOT_MST.GetColumn(nRow, "BRCH_ID")+"' && TUB_SEQ='"+DS_TIEUPASK_NOT_MST.GetColumn(nRow, "TUB_SEQ")+"' && ASK_SEQ='"+DS_TIEUPASK_NOT_MST.GetColumn(nRow, "ASK_SEQ")+"'");	
	
	var retArr = gfn_openPopup(this, "CP::CPAE02P01.xml", '', true);
	
	
}


function GRD_TIEUPASK_OMS_LST_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	//  청구누락상세정보 팝업 
	// 제휴사번호로 필터링 한다.
	// 해당 채권사번호 필터 
	//DS_TIEUPASK_OMS_DTL.FireEvent = false;		
	DS_TIEUPASK_OMS_DTL.UnFilter();
	DS_TIEUPASK_OMS_DTL.Filter("BRCH_ID='"+DS_TIEUPASK_OMS_MST.GetColumn(nRow, "BRCH_ID")+"' && TUB_SEQ='"+DS_TIEUPASK_OMS_MST.GetColumn(nRow, "TUB_SEQ")+"' && ASK_SEQ='"+DS_TIEUPASK_OMS_MST.GetColumn(nRow, "ASK_SEQ")+"'");	
	
	var retArr = gfn_openPopup(this, "CP::CPAE02P02.xml", '', true);
	
}


function GRD_TIEUPASK_YES_MST_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	//  비용청구 상세정보 팝업 

	var params = "P_BRCH_ID=" + quote(DS_TIEUPASK_YES_MST.GetColumn(nRow, "BRCH_ID"))
			   + " P_TUB_SEQ=" + quote(DS_TIEUPASK_YES_MST.GetColumn(nRow, "TUB_SEQ"))
			   + " P_ASK_SEQ=" + quote(DS_TIEUPASK_YES_MST.GetColumn(nRow, "ASK_SEQ"));
	
	var retArr = gfn_openPopup(this, "CP::CPAE02P03.xml", params, true);
	
}


//*------------------------------------------------------------------------------------------------
//* 함수설명     : Grid 해더 클릭시 
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//*-----------------------------------------------------------------------------------------------
function GRD_TIEUPASK_NOT_MST_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	gfn_GridSort(GRD_TIEUPASK_NOT_MST, DS_TIEUPASK_NOT_MST, nCell);	
}


function GRD_TIEUPASK_YES_MST_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	gfn_GridSort(GRD_TIEUPASK_YES_MST, DS_TIEUPASK_YES_MST, nCell);	
}

function GRD_TIEUPASK_OMS_LST_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	gfn_GridSort(GRD_TIEUPASK_OMS_LST, DS_TIEUPASK_OMS_MST, nCell);	
}




//*------------------------------------------------------------------------------------------------
//* 함수설명     : DataSet 변경시 자동저장
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function DS_TIEUPASK_NOT_MST_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	// flag가 'N' 이면 'U' 로 바꾼다.
	if(obj.GetColumn(nRow, "FLAG") == "N" )
	{
		obj.SetColumn(nRow, "FLAG", "U");	// 수정했다는 표시 
	}
}



function DS_TIEUPASK_YES_MST_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	// flag가 'N' 이면 'U' 로 바꾼다.
	if(obj.GetColumn(nRow, "FLAG") == "N" )
	{
		obj.SetColumn(nRow, "FLAG", "U");	// 수정했다는 표시 
	}
}


function S_TUB_NM_N_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if(nChar==13){				
		fn_search_not();
	}	
}



function S_TUB_NM_Y_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if(nChar==13){				
		fn_search_yes();
	}		
}



//*------------------------------------------------------------------------------------------------
//* 함수설명     : 날짜기준 바뀔때 
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function S_DT_GBN_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
}




//*------------------------------------------------------------------------------------------------
//* 함수설명     : 시작일 선택 팝업
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function BTN_ST_DT_OnClick(obj)
{
	gfn_SetCalendarDate(obj, "D", S_ST_DT);
}

function BTN_BAS_ST_DT_OnClick(obj)
{
	gfn_SetCalendarDate(obj, "D", EDT_BAS_ST_DT);
}


//*------------------------------------------------------------------------------------------------
//* 함수설명     : 종료일 선택 팝업
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function BTN_ED_DT_OnClick(obj)
{
	gfn_SetCalendarDate(obj, "D", S_ED_DT);
}

function BTN_BAS_ED_DT_OnClick(obj)
{
	gfn_SetCalendarDate(obj, "D", EDT_BAS_ED_DT);
}



function BTN_CUR_DT_OnClick(obj)
{
	gfn_SetCalendarDate(obj, "D", S_CUR_DT);
}




// 비용청구내역서 출력 
function btn_print_OnClick(obj)
{
	if(length(DS_TIEUPASK_YES_MST.GetColumn(DS_TIEUPASK_YES_MST.currow,"TUB_SEQ")) == 0)
	{
		gfn_popup_message("modal", "error", "먼저 비용청구내역서를 출력할 행을 선택하세요.", "확인");
		return;
	}
	
		
	
	fn_tieupask_print(DS_TIEUPASK_YES_MST.GetColumn(DS_TIEUPASK_YES_MST.currow,"BRCH_ID"),
						DS_TIEUPASK_YES_MST.GetColumn(DS_TIEUPASK_YES_MST.currow,"TUB_SEQ"),
						DS_TIEUPASK_YES_MST.GetColumn(DS_TIEUPASK_YES_MST.currow,"ASK_SEQ"),
						DS_TIEUPASK_YES_MST.GetColumn(DS_TIEUPASK_YES_MST.currow,"ASK_DT")						
					  );	
}








]]></Script>
</Window>