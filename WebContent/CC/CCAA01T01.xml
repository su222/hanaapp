<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form Height="650" Id="CCAA01T01" Left="8" OnLoadCompleted="CCAA01T01_OnLoadCompleted" OnUnloadCompleted="CCAA01T01_OnUnloadCompleted" PidAttrib="7" Title="제휴사관리" ToolTipFont="Default,0" Top="8" Ver="1.0" Width="1240" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="DS_TIEUP_LST" OnColumnChanged="DS_TIEUP_LST_OnColumnChanged" OnRowPosChanged="DS_TIEUP_LST_OnRowPosChanged">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ROW_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="OPERATOR" size="256" summ="default" type="STRING"/>
					<colinfo id="BRCH_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="TUB_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="TUB_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TUB_TEL" size="256" summ="default" type="STRING"/>
					<colinfo id="TUB_FAX" size="256" summ="default" type="STRING"/>
					<colinfo id="TUB_ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="TUB_ZIP" size="256" summ="default" type="STRING"/>
					<colinfo id="BAG_AGC_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="ETC_AGC_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="SIN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SIN_TEL" size="256" summ="default" type="STRING"/>
					<colinfo id="SIN_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="RCP_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="BIL_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="DEAL_STS" size="256" summ="default" type="STRING"/>
					<colinfo id="DEAL_STOP_RSN" size="256" summ="default" type="STRING"/>
					<colinfo id="HNA_CHG_USR" size="256" summ="default" type="STRING"/>
					<colinfo id="HNA_CHG_USR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC_CARY" size="256" summ="default" type="STRING"/>
					<colinfo id="BIZ_FILE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BIZ_FILE_SAVE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="AFF_REG_NOTE" size="256" summ="default" type="STRING"/>
					<colinfo id="AFF_PRS_NOTE" size="256" summ="default" type="STRING"/>
					<colinfo id="COST_NOTE" size="256" summ="default" type="STRING"/>
					<colinfo id="REG_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="RLT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SIN_DT_STR" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="LST_DEAL_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="CLT_OPN_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="CLT_OPN_HP" size="256" summ="default" type="STRING"/>
					<colinfo id="TUB_NM_HIS" size="256" summ="default" type="STRING"/>
					<colinfo id="UNP_AMT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="DS_TIEUPCHG_LST" OnColumnChanged="DS_TIEUPCHG_LST_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ROW_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="OPERATOR" size="256" summ="default" type="STRING"/>
					<colinfo id="BRCH_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="TUB_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_HP" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_TEL" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_FAX" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_POS" size="256" summ="default" type="STRING"/>
					<colinfo id="TEL_OPN_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="DESC_PRV" size="256" summ="default" type="STRING"/>
					<colinfo id="DPST_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="NOTE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="DS_TUB_SEQ">
				<Contents>
					<colinfo id="TUB_SEQ" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="DS_TIEUP_TEMP"></Dataset>
			<Dataset DataSetType="Dataset" Id="DS_TIEUPCHG_TEMP"></Dataset>
			<Dataset DataSetType="Dataset" Id="DS_TIEUPNOTE_LST" OnColumnChanged="DS_TIEUPNOTE_LST_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ROW_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="OPERATOR" size="256" summ="default" type="STRING"/>
					<colinfo id="BRCH_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="TUB_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="NOTE_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_GBN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="NOTE_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="NOTE_GBN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="NOTE_DESC" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="DS_TIEUPNOTE_TEMP"></Dataset>
			<Dataset DataSetType="Dataset" Id="DS_TIEUP_TREE">
				<Contents>
					<colinfo id="BRCH_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="TUB_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="TUB_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TUB_TEL" size="256" summ="default" type="STRING"/>
					<colinfo id="TUB_FAX" size="256" summ="default" type="STRING"/>
					<colinfo id="HNA_CHG_USR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="UNP_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC_CARY" size="256" summ="default" type="STRING"/>
					<colinfo id="SIN_DT_STR" size="256" summ="default" type="STRING"/>
					<colinfo id="SIN_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="DS_TIEUPUNP_INFO">
				<Contents>
					<colinfo id="BRCH_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="TUB_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="UNP_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="OCC_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_AMT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="DS_HP_INFO">
				<Contents>
					<colinfo id="DTL_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DTL_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user7" Bottom="400" Height="314" Id="Shape_edit" Left="486" LineColor="user61" Right="1231" RoundHeight="10" RoundUnit="Pixel" RoundWidth="10" TabOrder="31" Top="86" Type="RoundRect" Width="745"></Shape>
		<Static Align="Center" Border="Flat" Height="20" Id="Static21" Left="493" Style="Stc_Label" TabOrder="18" Text="제휴사명" Top="91" VAlign="Middle" Width="80"></Static>
		<Shape BKColor="user21" Bottom="46" Height="40" Id="Shape_search" Left="0" LineColor="user22" Right="1232" RoundHeight="10" RoundUnit="Pixel" RoundWidth="10" TabOrder="18" Top="6" Type="RoundRect" Width="1232"></Shape>
		<Shape Bottom="200" Height="128" Id="Shape22" Left="573" LineColor="tomato" LineKind="Vertical" LineWidth="4" Right="577" TabOrder="20" Top="72" Type="Rectangle" Visible="FALSE" Width="4"></Shape>
		<Shape Bottom="61" Height="15" Id="Shape1" Left="0" LineColor="seagreen" LineKind="Vertical" LineWidth="10" Right="1231" TabOrder="21" Top="46" Type="Rectangle" Visible="FALSE" Width="1231"></Shape>
		<Shape Bottom="88" Height="5" Id="Shape3" Left="-2" LineColor="seagreen" LineKind="Vertical" LineWidth="5" Right="1237" TabOrder="22" Top="83" Type="Rectangle" Visible="FALSE" Width="1239"></Shape>
		<Image Align="Left" Height="14" Id="Image0" ImageID="Title_dot" LeftMargin="20" Style="Stc_Subtitle" TabOrder="23" Text="제휴사목록" Top="68" Transparent="TRUE" Width="157"></Image>
		<Shape Bottom="5" Height="5" Id="Shape15" Left="0" LineColor="seagreen" LineKind="Vertical" LineWidth="5" Right="1239" TabOrder="24" Top="0" Type="Rectangle" Visible="FALSE" Width="1239"></Shape>
		<Image Align="Left" Height="14" Id="Image4" ImageID="Title_dot" Left="488" LeftMargin="20" Style="Stc_Subtitle" TabOrder="25" Text="제휴사기본정보" Top="69" Transparent="TRUE" Width="157"></Image>
		<Image Align="Left" Height="18" Id="Image3" ImageID="label_dot" Left="10" LeftMargin="12" Style="Stc_Default_bold" TabOrder="26" Text="제휴사코드/명/사건담당/하나담당/전화번호" Top="17" Transparent="TRUE" Width="274"></Image>
		<Shape Bottom="645" Height="640" Id="Shape0" Left="1233" LineColor="tomato" LineKind="Vertical" LineWidth="4" Right="1238" TabOrder="27" Top="5" Type="Rectangle" Visible="FALSE" Width="5"></Shape>
		<Shape Bottom="208" Height="128" Id="Shape2" Left="680" LineColor="slateblue" LineKind="Vertical" LineWidth="4" Right="688" TabOrder="28" Top="80" Type="Rectangle" Visible="FALSE" Width="8"></Shape>
		<Edit Border="Flat" Height="18" Id="S_SEARCH_STR" Left="292" LeftMargin="4" OnKeyDown="S_SEARCH_STR_OnKeyDown" Style="Edit" TabOrder="29" Top="17" Width="186"></Edit>
		<Shape Bottom="200" Height="128" Id="Shape8" Left="768" LineColor="tomato" LineKind="Vertical" LineWidth="4" Right="772" TabOrder="30" Top="72" Type="Rectangle" Visible="FALSE" Width="4"></Shape>
		<Static Align="Center" Border="Flat" Height="20" Id="Static5" Left="879" Style="Stc_Label" TabOrder="32" Text="전화번호" Top="91" VAlign="Middle" Width="80"></Static>
		<Shape Bottom="208" Height="128" Id="Shape6" Left="871" LineColor="slateblue" LineKind="Vertical" LineWidth="4" Right="879" TabOrder="33" Top="80" Type="Rectangle" Visible="FALSE" Width="8"></Shape>
		<Static Align="Center" Border="Flat" Height="20" Id="Static8" Left="1056" Style="Stc_Label" TabOrder="34" Text="팩스번호" Top="91" VAlign="Middle" Width="80"></Static>
		<Shape Bottom="200" Height="128" Id="Shape10" Left="959" LineColor="tomato" LineKind="Vertical" LineWidth="4" Right="963" TabOrder="35" Top="72" Type="Rectangle" Visible="FALSE" Width="4"></Shape>
		<Edit BindDataset="DS_TIEUP_LST" Border="Flat" Column="TUB_NM" Height="18" Id="EDT_TUB_NM" Left="578" LeftMargin="4" Style="Edit_Ess" TabOrder="1" Top="92" Width="218"></Edit>
		<Shape Bottom="208" Height="136" Id="Shape11" Left="1136" LineColor="tomato" LineKind="Vertical" LineWidth="4" Right="1140" TabOrder="36" Top="72" Type="Rectangle" Visible="FALSE" Width="4"></Shape>
		<Static Align="Center" Border="Flat" Height="20" Id="Static7" Left="493" Style="Stc_Label" TabOrder="37" Text="영수증발행" Top="208" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Border="Flat" Height="20" Id="Static4" Left="493" Style="Stc_Label" TabOrder="38" Text="결재자" Top="137" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Border="Flat" Height="20" Id="Static0" Left="493" Style="Stc_Label" TabOrder="39" Text="주소" Top="114" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Border="Flat" Height="20" Id="Static1" Left="879" Style="Stc_Label" TabOrder="40" Text="기본대행료" Top="115" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="DS_TIEUP_LST" Border="Flat" Column="TUB_ADDR" Height="18" Id="EDT_TUB_ADDR" Left="578" LeftMargin="4" Style="Edit" TabOrder="4" Top="116" Width="290"></Edit>
		<Static Align="Center" Border="Flat" Height="20" Id="Static2" Left="1057" Style="Stc_Label" TabOrder="41" Text="그외대행료" Top="115" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Border="Flat" Height="20" Id="Static10" Left="879" Style="Stc_Label" TabOrder="42" Text="결재구분" Top="137" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="DS_TIEUP_LST" Border="Flat" Column="SIN_NM" Height="18" Id="EDT_SIN_NM" Left="578" LeftMargin="4" Style="Edit" TabOrder="7" Top="138" Width="100"></Edit>
		<Static Align="Center" Border="Flat" Height="44" Id="Static12" Left="493" Style="Stc_Label" TabOrder="43" Text="결재일" Top="160" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Border="Flat" Height="20" Id="Static14" Left="879" Style="Stc_Label" TabOrder="44" Text="거래상황" Top="207" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="DS_TIEUP_LST" Border="Flat" Column="RCP_GBN" Height="18" Id="COB_RCP_GBN" ImeMode="none" Left="577" ResetIndex="FIRST" ShadowColor="user2" Style="Combo_Ess" TabOrder="11" Top="207" Width="100"></Combo>
		<Static Align="Center" Border="Flat" Height="20" Id="Static3" Left="1057" Style="Stc_Label" TabOrder="45" Text="사유" Top="207" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="DS_TIEUP_LST" Border="Flat" Column="SIN_GBN" Height="18" Id="COB_SIN_GBN" ImeMode="none" Left="962" ResetIndex="FIRST" ShadowColor="user2" Style="Combo_Ess" TabOrder="9" Top="137" Width="90"></Combo>
		<Shape Bottom="448" Height="15" Id="Shape16" Left="2" LineColor="seagreen" LineKind="Vertical" LineWidth="10" Right="469" TabOrder="46" Top="433" Type="Rectangle" Visible="FALSE" Width="467"></Shape>
		<Shape Bottom="476" Height="32" Id="Shape18" Left="378" LineColor="tomato" LineKind="Vertical" LineWidth="4" Right="383" TabOrder="47" Top="444" Type="Rectangle" Visible="FALSE" Width="5"></Shape>
		<Shape Bottom="475" Height="5" Id="Shape14" Left="5" LineColor="seagreen" LineKind="Vertical" LineWidth="5" Right="480" TabOrder="48" Top="470" Type="Rectangle" Visible="FALSE" Width="475"></Shape>
		<Static Align="Center" Border="Flat" Height="20" Id="Static22" Left="689" Style="Stc_Label" TabOrder="49" Text="세금계산서" Top="207" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="DS_TIEUP_LST" Border="Flat" Column="DEAL_STOP_RSN" Height="18" Id="EDT_DEAL_STOP_RSN" Left="1140" LeftMargin="4" Style="Edit" TabOrder="14" Top="208" Width="86"></Edit>
		<Edit BindDataset="DS_TIEUP_LST" Border="Flat" Column="SIN_TEL" Height="18" Id="EDT_SIN_TEL" Left="772" LeftMargin="4" Style="Edit" TabOrder="8" Top="138" Width="100"></Edit>
		<Static Align="Center" Border="Flat" Height="20" Id="Static9" Left="493" Style="Stc_Label" TabOrder="50" Text="하나담당" Top="232" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Border="Flat" Height="20" Id="Static11" Left="689" Style="Stc_Label" TabOrder="51" Text="서류운송방법" Top="231" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="DS_TIEUP_LST" Border="Flat" Column="BIL_GBN" Height="18" Id="COB_BIL_GBN" Left="772" ResetIndex="FIRST" ShadowColor="user2" Style="Combo_Ess" TabOrder="12" Top="207" Width="100"></Combo>
		<Combo BindDataset="DS_TIEUP_LST" Border="Flat" Column="DOC_CARY" Height="18" Id="COB_DOC_CARY" Left="772" OnChanged="S_BRCH_ID_OnChanged" ResetIndex="FIRST" ShadowColor="user2" Style="Combo_Ess" TabOrder="16" Top="231" Width="100"></Combo>
		<Shape Bottom="208" Height="128" Id="Shape12" Left="1048" LineColor="slateblue" LineKind="Vertical" LineWidth="4" Right="1056" TabOrder="52" Top="80" Type="Rectangle" Visible="FALSE" Width="8"></Shape>
		<Static Align="Center" Border="Flat" Height="20" Id="Static6" Left="879" Style="Stc_Label" TabOrder="53" Text="사업자등록증" Top="231" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="DS_TIEUP_LST" Border="Flat" Column="BIZ_FILE_NM" Height="18" Id="EDT_BIZ_FILE_NM" Left="963" LeftMargin="4" Style="Edit" TabOrder="54" Top="231" Width="90"></Edit>
		<Combo BindDataset="DS_TIEUP_LST" Border="Flat" Column="DEAL_STS" Height="18" Id="COB_DEAL_STS" Left="963" ResetIndex="FIRST" ShadowColor="user2" Style="Combo_Ess" TabOrder="13" Top="207" Width="86"></Combo>
		<Image Align="Left" Height="18" Id="Image7" ImageID="label_dot" Left="762" LeftMargin="12" Style="Stc_Default_bold" TabOrder="55" Text="결재구분" Top="17" Transparent="TRUE" Width="66"></Image>
		<Image Align="Left" Height="18" Id="Image8" ImageID="label_dot" Left="906" LeftMargin="12" Style="Stc_Default_bold" TabOrder="56" Text="거래상황" Top="17" Transparent="TRUE" Width="66"></Image>
		<Combo Border="Flat" Height="18" Id="S_SIN_GBN" Left="832" ResetIndex="FIRST" ShadowColor="user2" Style="Combo" TabOrder="57" Top="16" Width="66"></Combo>
		<Combo Border="Flat" Height="18" Id="S_DEAL_STS" Left="976" ResetIndex="FIRST" ShadowColor="user2" Style="Combo" TabOrder="58" Top="16" Width="66"></Combo>
		<Grid AutoEnter="TRUE" AutoScrollBar="AlwaysVert" BindDataset="DS_TIEUPCHG_LST" BkColor2="user55" BkSelColor="user54" BoldHead="FALSE" Border="Flat" Bottom="644" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" Font="돋움,9" HeadBorder="Flat" HeadHeight="24" Height="169" Id="GRD_TIEUPCHG_LST" InputPanel="FALSE" LineColor="default" LineType="OnlyVERT" OnCellClick="GRD_TIEUPCHG_LST_OnCellClick" OnCellDBLClick="GRD_TIEUPCHG_LST_OnCellDblClick" OnHeadClick="GRD_TIEUPCHG_LST_OnHeadClick" Right="475" RowHeight="20" Style="Grid_2" TabOrder="59" TabStop="true" Top="475" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="475">
			<contents>
				<format id="Default">
					<columns>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="30"/>
						<col width="80"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="80"/>
						<col width="80"/>
						<col width="100"/>
						<col width="100"/>
						<col width="120"/>
					</columns>
					<head>
						<cell col="0" display="text" InputZeroTime="true" text="FLAG"/>
						<cell col="1" display="text" InputZeroTime="true" text="ROW_ID"/>
						<cell col="2" display="text" InputZeroTime="true" text="OPERATOR"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="3" color="user52" display="text" InputZeroTime="true" text="회사코드"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="4" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="No"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="5" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="사건담당자"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="6" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="담당핸드폰"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="7" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="직통번호"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="8" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="FAX"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="9" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="담당직급"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="10" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="공개"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="11" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="내용증명"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="12" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="보증처"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="13" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="특이사항"/>
					</head>
					<body>
						<cell col="0" colid="FLAG" display="text" InputZeroTime="true"/>
						<cell col="1" colid="ROW_ID" display="text" InputZeroTime="true"/>
						<cell col="2" colid="OPERATOR" display="text" InputZeroTime="true"/>
						<cell col="3" colid="BRCH_ID" display="normal" InputZeroTime="true"/>
						<cell align="center" col="4" display="text" expr="row&#32;+&#32;1" InputZeroTime="true"/>
						<cell align="center" col="5" colid="CHG_NM" color="black" display="normal" InputZeroTime="true"/>
						<cell align="center" col="6" colid="CHG_HP" display="text" InputZeroTime="true"/>
						<cell align="center" col="7" colid="CHG_TEL" display="text" InputZeroTime="true"/>
						<cell align="center" col="8" colid="CHG_FAX" display="text" InputZeroTime="true"/>
						<cell align="center" col="9" colid="CHG_POS" color="black" display="normal" InputZeroTime="true"/>
						<cell align="center" col="10" colid="TEL_OPN_YN" combodisplayrowcnt="20" display="combo" InputZeroTime="true"/>
						<cell align="left" col="11" colid="DESC_PRV" color="black" display="normal" InputZeroTime="true"/>
						<cell align="left" col="12" colid="DPST_NM" color="black" display="normal" InputZeroTime="true"/>
						<cell align="left" col="13" colid="NOTE" color="black" display="normal" InputZeroTime="true"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Image Align="Left" Height="14" Id="Image6" ImageID="Title_dot" Left="2" LeftMargin="20" Style="Stc_Subtitle" TabOrder="60" Text="사건진행정보" Top="455" Transparent="TRUE" Width="157"></Image>
		<MaskEdit BindDataset="DS_TIEUP_LST" Border="Flat" Column="BAG_AGC_AMT" Height="18" Id="MAE_BAG_AGC_AMT" Left="963" Style="Edit" TabOrder="5" Top="116" Width="86"></MaskEdit>
		<MaskEdit BindDataset="DS_TIEUP_LST" Border="Flat" Column="ETC_AGC_AMT" Height="18" Id="MAE_ETC_AGC_AMT" Left="1140" Style="Edit" TabOrder="6" Top="116" Width="86"></MaskEdit>
		<Edit BindDataset="DS_TIEUP_LST" Border="Flat" Column="TUB_SEQ" Height="18" Id="Edit0" Left="1248" LeftMargin="4" Style="Edit_Ess" TabOrder="61" Top="56" Visible="FALSE" Width="90"></Edit>
		<File Bottom="160" Height="24" Id="File1" Left="1337" Right="1361" TabOrder="83" Top="136" Width="24"></File>
		<FileDialog Bottom="134" Height="24" Id="FileDialog1" Left="1337" Right="1361" TabOrder="83" Top="110" Width="24"></FileDialog>
		<Edit BindDataset="DS_TIEUP_LST" Border="Flat" Column="BIZ_FILE_SAVE_NM" Height="18" Id="Edit1" Left="1248" LeftMargin="4" Style="Edit" TabOrder="62" Top="80" Visible="FALSE" Width="130"></Edit>
		<Grid AutoEnter="TRUE" AutoScrollBar="AlwaysVert" BindDataset="DS_TIEUP_TREE" BkColor2="user55" BkSelColor="user54" BoldHead="FALSE" Border="Flat" Bottom="433" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" Font="돋움,9" HeadBorder="Flat" HeadHeight="24" Height="345" Id="GRD_TIEUP_LST" InputPanel="FALSE" LineColor="default" LineType="OnlyVERT" OnCellClick="GRD_TIEUP_LST_OnCellClick" OnCellDBLClick="GRD_TIEUP_LST_OnCellDblClick" OnHeadClick="GRD_TIEUP_LST_OnHeadClick" Right="475" RowHeight="20" Style="Grid_2" TabOrder="63" TabStop="true" Top="88" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="475">
			<contents>
				<format id="Default">
					<columns>
						<col width="0"/>
						<col width="30"/>
						<col width="0"/>
						<col width="150"/>
						<col width="80"/>
						<col width="80"/>
						<col width="100"/>
						<col width="60"/>
						<col width="80"/>
						<col width="60"/>
						<col width="100"/>
					</columns>
					<head>
						<cell bkcolor="user51" bkimagealign="stretch" col="0" color="user52" display="text" InputZeroTime="true" text="회사코드"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="1" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="No"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="2" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="제휴사코드"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="3" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="제휴사명"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="4" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="전화번호"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="5" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="팩스번호"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="6" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="결재담당"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="7" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="하나담당"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="8" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="미수금"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="9" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="운송방법"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="10" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="결재일"/>
					</head>
					<body>
						<cell col="0" colid="BRCH_ID" display="normal" InputZeroTime="true"/>
						<cell align="center" col="1" display="text" expr="row&#32;+&#32;1" InputZeroTime="true"/>
						<cell col="2" colid="TUB_SEQ" display="normal" InputZeroTime="true"/>
						<cell align="left" col="3" colid="TUB_NM" color="black" display="normal" InputZeroTime="true"/>
						<cell align="center" col="4" colid="TUB_FAX" color="black" display="text" InputZeroTime="true"/>
						<cell align="center" col="5" colid="TUB_FAX" color="black" display="text" InputZeroTime="true"/>
						<cell align="center" col="6" colid="SIN_NM" color="black" display="text" InputZeroTime="true"/>
						<cell align="center" col="7" colid="HNA_CHG_USR_NM" color="black" display="text" InputZeroTime="true"/>
						<cell align="right" col="8" colid="UNP_AMT" color="black" display="number" InputZeroTime="true"/>
						<cell align="center" col="9" colid="DOC_CARY" color="black" display="normal" InputZeroTime="true"/>
						<cell align="left" col="10" colid="SIN_DT_STR" color="black" display="text" InputZeroTime="true"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Shape Bottom="260" Height="32" Id="Shape20" Left="1162" LineColor="tomato" LineKind="Vertical" LineWidth="4" Right="1167" TabOrder="64" Top="228" Type="Rectangle" Visible="FALSE" Width="5"></Shape>
		<Edit BindDataset="DS_TIEUP_LST" Border="Flat" Column="HNA_CHG_USR_NM" Height="18" Id="EDT_HNA_CHG_USR_NM" Left="576" LeftMargin="4" OnKeyDown="EDT_HNA_CHG_USR_NM_OnKeyDown" Style="Edit_Ess" TabOrder="15" Top="231" Width="71"></Edit>
		<Button Height="18" Id="POP_HNA_CHG_USR" ImageID="Btn_search" Left="652" OnClick="POP_HNA_CHG_USR_OnClick" TabOrder="65" Text="Button1" Top="231" Width="21"></Button>
		<Image Align="Left" Height="18" Id="Image9" ImageID="label_dot" Left="1058" LeftMargin="12" Style="Stc_Default_bold" TabOrder="66" Text="등록구분" Top="17" Transparent="TRUE" Width="66"></Image>
		<Combo Border="Flat" Height="18" Id="S_REG_GBN" Left="1128" ResetIndex="FIRST" ShadowColor="user2" Style="Combo" TabOrder="67" Top="16" Width="90"></Combo>
		<Static Align="Center" Border="Flat" Height="20" Id="Static17" Left="1057" Style="Stc_Label" TabOrder="68" Text="등록구분" Top="137" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="DS_TIEUP_LST" Border="Flat" Column="REG_GBN" Height="18" Id="COB_REG_GBN" Left="1139" ResetIndex="FIRST" ShadowColor="user2" Style="Combo_Ess" TabOrder="10" Top="137" Width="90"></Combo>
		<Static Align="Center" Border="Flat" Height="42" Id="Static13" Left="493" Style="Stc_Label" TabOrder="69" Text="관련명칭" Top="281" VAlign="Middle" Width="80"></Static>
		<TextArea BindDataset="DS_TIEUP_LST" Column="RLT_NM" Height="42" Id="TXT_RLT_NM" ImeMode="none" Left="576" Style="Edit" TabOrder="17" Top="281" Width="648"></TextArea>
		<Shape Bottom="416" Height="15" Id="Shape9" Left="490" LineColor="seagreen" LineKind="Vertical" LineWidth="10" Right="1229" TabOrder="70" Top="401" Type="Rectangle" Visible="FALSE" Width="739"></Shape>
		<Shape Bottom="444" Height="32" Id="Shape24" Left="1137" LineColor="tomato" LineKind="Vertical" LineWidth="4" Right="1142" TabOrder="71" Top="412" Type="Rectangle" Visible="FALSE" Width="5"></Shape>
		<Shape Bottom="443" Height="5" Id="Shape25" Left="493" LineColor="seagreen" LineKind="Vertical" LineWidth="5" Right="1232" TabOrder="72" Top="438" Type="Rectangle" Visible="FALSE" Width="739"></Shape>
		<Grid AutoEnter="TRUE" AutoScrollBar="AlwaysVert" BindDataset="DS_TIEUPNOTE_LST" BkColor2="user55" BkSelColor="user54" BoldHead="FALSE" Border="Flat" Bottom="644" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" Font="돋움,9" HeadBorder="Flat" HeadHeight="24" Height="201" Id="GRD_TIEUPNOTE_LST" InputPanel="FALSE" Left="488" LineColor="default" LineType="OnlyVERT" OnCellClick="GRD_TIEUPNOTE_LST_OnCellClick" OnHeadClick="GRD_TIEUPNOTE_LST_OnHeadClick" Right="1227" RowHeight="20" Style="Grid_2" TabOrder="73" TabStop="true" Top="443" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="739">
			<contents>
				<format id="Default">
					<columns>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="30"/>
						<col width="0"/>
						<col width="0"/>
						<col width="80"/>
						<col width="100"/>
						<col width="500"/>
					</columns>
					<head>
						<cell col="0" display="text" InputZeroTime="true" text="FLAG"/>
						<cell col="1" display="text" InputZeroTime="true" text="ROW_ID"/>
						<cell col="2" display="text" InputZeroTime="true" text="OPERATOR"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="3" color="user52" display="text" InputZeroTime="true" text="회사코드"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="4" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="No"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="5" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="JOB_GBN"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="6" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="NOTE_GBN"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="7" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="업무상황"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="8" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="구분"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="9" color="user52" display="text" font="돋움,10,Bold" InputZeroTime="true" text="내용"/>
					</head>
					<body>
						<cell col="0" colid="FLAG" display="text" InputZeroTime="true"/>
						<cell col="1" colid="ROW_ID" display="text" InputZeroTime="true"/>
						<cell col="2" colid="OPERATOR" display="text" InputZeroTime="true"/>
						<cell col="3" colid="BRCH_ID" display="normal" InputZeroTime="true"/>
						<cell align="center" col="4" display="text" expr="row&#32;+&#32;1" InputZeroTime="true"/>
						<cell align="center" col="5" colid="JOB_GBN" color="black" display="normal" InputZeroTime="true"/>
						<cell align="center" col="6" colid="NOTE_GBN" color="black" display="normal" InputZeroTime="true"/>
						<cell align="center" col="7" colid="JOB_GBN_NM" color="black" display="normal" InputZeroTime="true"/>
						<cell align="center" col="8" colid="NOTE_GBN_NM" display="normal" InputZeroTime="true"/>
						<cell align="left" col="9" colid="NOTE_DESC" display="text" edit="normal" InputZeroTime="true"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Image Align="Left" Height="14" Id="Image10" ImageID="Title_dot" Left="490" LeftMargin="20" Style="Stc_Subtitle" TabOrder="74" Text="제휴사&#32;특이사항" Top="423" Transparent="TRUE" Width="157"></Image>
		<Edit BindDataset="DS_TIEUP_LST" Border="Flat" Column="TUB_TEL" Height="18" Id="EDT_TUB_TEL" Left="963" LeftMargin="4" Style="Edit" TabOrder="2" Top="92" Width="86"></Edit>
		<Edit BindDataset="DS_TIEUP_LST" Border="Flat" Column="TUB_FAX" Height="18" Id="EDT_TUB_FAX" Left="1139" LeftMargin="4" Style="Edit" TabOrder="3" Top="92" Width="86"></Edit>
		<Static Align="Center" Border="Flat" Height="20" Id="Static15" Left="688" Style="Stc_Label" TabOrder="75" Text="결재자번호" Top="137" VAlign="Middle" Width="80"></Static>
		<Button Height="21" Id="btn_add" Left="1150" OnClick="btn_add_OnClick" TabOrder="76" Text="제휴사&#32;추가" Top="63" Width="82"></Button>
		<Button Height="21" Id="btn_add_note" Left="1047" OnClick="btn_add_note_OnClick" TabOrder="77" Text="특이사항&#32;추가" Top="417" Width="90"></Button>
		<Button Height="21" Id="btn_del_note" Left="1143" OnClick="btn_del_note_OnClick" TabOrder="78" Text="특이사항&#32;삭제" Top="417" Width="90"></Button>
		<Button Height="21" Id="btn_add_dtl" Left="288" OnClick="btn_add_dtl_OnClick" TabOrder="79" Text="사건담당&#32;추가" Top="449" Width="90"></Button>
		<Button Height="21" Id="btn_del_dtl" Left="384" OnClick="btn_del_dtl_OnClick" TabOrder="80" Text="사건담당&#32;삭제" Top="449" Width="90"></Button>
		<Button Height="21" Id="BTN_FILE_SAVE" Left="1056" OnClick="BTN_FILE_SAVE_OnClick" TabOrder="81" Text="파일첨부" Top="231" Width="58"></Button>
		<Button Height="21" Id="BTN_FILE_DOWN" Left="1119" OnClick="BTN_FILE_DOWN_OnClick" TabOrder="82" Text="다운로드" Top="231" Width="58"></Button>
		<Button Height="21" Id="BTN_FILE_DEL" Left="1180" OnClick="BTN_FILE_DEL_OnClick" TabOrder="83" Text="파일삭제" Top="231" Width="50"></Button>
		<Button Height="21" Id="btn_my_search" Left="392" OnClick="btn_my_search_OnClick" TabOrder="85" Text="나의제휴사" Top="62" Width="74"></Button>
		<Shape Bottom="89" Height="32" Id="Shape19" Left="466" LineColor="tomato" LineKind="Vertical" LineWidth="4" Right="471" TabOrder="84" Top="57" Type="Rectangle" Visible="FALSE" Width="5"></Shape>
		<Button Height="21" Id="btn_all_search" Left="312" OnClick="btn_all_search_OnClick" TabOrder="87" Text="전체제휴사" Top="62" Width="74"></Button>
		<Shape Bottom="89" Height="32" Id="Shape27" Left="386" LineColor="tomato" LineKind="Vertical" LineWidth="4" Right="391" TabOrder="86" Top="57" Type="Rectangle" Visible="FALSE" Width="5"></Shape>
		<Shape Bottom="46" Height="40" Id="Shape28" Left="284" LineColor="slateblue" LineKind="Vertical" LineWidth="4" Right="292" TabOrder="88" Top="6" Type="Rectangle" Visible="FALSE" Width="8"></Shape>
		<Shape Bottom="46" Height="40" Id="Shape13" Left="825" LineColor="slateblue" LineKind="Vertical" LineWidth="4" Right="833" TabOrder="89" Top="6" Type="Rectangle" Visible="FALSE" Width="8"></Shape>
		<Shape Bottom="46" Height="40" Id="Shape17" Left="969" LineColor="slateblue" LineKind="Vertical" LineWidth="4" Right="977" TabOrder="90" Top="6" Type="Rectangle" Visible="FALSE" Width="8"></Shape>
		<Shape Bottom="46" Height="40" Id="Shape21" Left="1121" LineColor="slateblue" LineKind="Vertical" LineWidth="4" Right="1129" TabOrder="91" Top="6" Type="Rectangle" Visible="FALSE" Width="8"></Shape>
		<Edit BindDataset="DS_TIEUP_LST" Border="Flat" Column="SIN_DT_STR" Height="18" Id="EDIT_DT_STR" Left="578" LeftMargin="4" Style="Edit_Ess" TabOrder="92" Top="161" Width="642"></Edit>
		<Static Border="None" Color="royalblue" Height="19" Id="Static25" Left="578" TabOrder="93" Text="&apos;1~31&apos;,&#32;&apos;월~일&apos;,&#32;&apos;말일&apos;,&apos;말일전&apos;&#32;만&#32;표기가능&#32;합니다,&#32;구문자는&#32;쉼표.&#32;예시)&#32;1,5,9,12,15,월,수,토,말일전,말일" Top="186" Width="581"></Static>
		<Edit BindDataset="DS_TIEUP_LST" Border="Flat" Column="TUB_SEQ" Height="18" Id="EDT_TUB_SEQ" Left="800" LeftMargin="4" Readonly="TRUE" Style="Edit" TabOrder="94" Top="92" Width="68"></Edit>
		<Static Align="Center" BKColor="darkkhaki" Border="Flat" Height="20" Id="Static16" Left="493" Style="Stc_Label" TabOrder="95" Text="미수금" Top="375" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" BKColor="darkkhaki" Border="Flat" Height="20" Id="Static18" Left="688" Style="Stc_Label" TabOrder="97" Text="청구후누적금" Top="375" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" BKColor="darkkhaki" Border="Flat" Height="20" Id="Static19" Left="879" Style="Stc_Label" TabOrder="96" Text="총합계" Top="375" VAlign="Middle" Width="80"></Static>
		<MaskEdit BindDataset="DS_TIEUP_LST" Border="Flat" Column="UNP_AMT" Font="Default,9,Bold" Height="18" Id="EDT_CHRG_AMT_N" Left="576" Style="Edit" TabOrder="98" Top="376" Width="100"></MaskEdit>
		<MaskEdit BindDataset="DS_TIEUPUNP_INFO" Border="Flat" Column="OCC_AMT" Font="Default,9,Bold" Height="18" Id="MaskEdit0" Left="772" Readonly="TRUE" Style="Edit" TabOrder="99" Top="376" Width="100"></MaskEdit>
		<MaskEdit BindDataset="DS_TIEUPUNP_INFO" Border="Flat" Column="TOT_AMT" Font="Default,9,Bold" Height="18" Id="MaskEdit1" Left="963" Readonly="TRUE" Style="Edit" TabOrder="100" Top="376" Width="100"></MaskEdit>
		<Static Align="Center" Border="Flat" Height="20" Id="Static20" Left="493" Style="Stc_Label" TabOrder="102" Text="고객정보공개" Top="256" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Border="Flat" Height="20" Id="Static23" Left="1069" Style="Stc_Label" TabOrder="103" Text="마지막거래일" Top="255" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="DS_TIEUP_LST" Border="Flat" Column="CLT_OPN_YN" Height="18" Id="COB_CLT_OPN_YN" Left="576" ResetIndex="FIRST" ShadowColor="user2" Style="Combo" TabOrder="101" Top="256" Width="100"></Combo>
		<Static Align="Center" Border="Flat" Height="20" Id="Static26" Left="879" Style="Stc_Label" TabOrder="104" Text="신규등록일" Top="255" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="DS_TIEUP_LST" Border="Flat" Column="CRT_DT" Height="18" Id="Edit4" Left="963" LeftMargin="4" Readonly="TRUE" Style="Edit" TabOrder="105" Top="256" Width="90"></Edit>
		<Edit BindDataset="DS_TIEUP_LST" Border="Flat" Column="LST_DEAL_DT" Height="18" Id="Edit5" Left="1153" LeftMargin="4" Readonly="TRUE" Style="Edit" TabOrder="106" Top="256" Width="74"></Edit>
		<Static Align="Center" Border="Flat" Height="20" Id="Static24" Left="689" Style="Stc_Label" TabOrder="108" Text="공개전화번호" Top="255" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="DS_TIEUP_LST" Border="Flat" Column="CLT_OPN_HP" Height="18" Id="COB_CLT_OPN_HP" Left="772" ResetIndex="FIRST" ShadowColor="user2" Style="Combo" TabOrder="107" Top="255" Width="100"></Combo>
		<Static Align="Center" Border="Flat" Height="42" Id="Static27" Left="493" Style="Stc_Label" TabOrder="110" Text="제휴사명&#10;변경이력" Top="328" VAlign="Middle" Width="80"></Static>
		<TextArea BindDataset="DS_TIEUP_LST" Column="TUB_NM_HIS" Height="42" Id="EDT_TUB_NM_HIS" ImeMode="none" Left="576" Readonly="TRUE" Style="Edit" TabOrder="109" Top="328" Width="648"></TextArea>
		<Button Height="21" Id="btn_mst_edit" Left="616" OnClick="btn_mst_edit_OnClick" TabOrder="111" TabStop="FALSE" Text="기본정보수정" Top="62" Width="80"></Button>
		<Button Height="21" Id="btn_mst_ok" Left="699" OnClick="btn_mst_ok_OnClick" TabOrder="112" TabStop="FALSE" Text="수정완료" Top="62" Width="56"></Button>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
* FormID(명) : 제휴사관리
* 작성자     : 이용재
* 작성일     : 2013-02-13 : 최초 생성
* 기능설명   : 제휴사 관리
* 변경로그
* Date             Ver          Name        Description
* ---------------  ------   ----------  ---------------------------
* 2013-02-13       V1.0                  initial ver.
***************************************************************************************************/

/**************************************************************************************************
  * 공통 Script Include
***************************************************************************************************/
#include "lib::lib_global.js";
#include "lib::lib_comm.js";
#include "lib::lib_grid.js";
#include "lib::lib_platform.js";
#include "lib::lib_popup.js";
#include "lib::lib_msg.js";
#include "lib::lib_ext.js";
#include "lib::lib_file.js";


/**************************************************************************************************
  * 화면 변수 선언부
***************************************************************************************************/

var svcID			= "";		
var url   			= "";
var inDatasets  	= "";
var outDatasets 	= "";
var argument    	= "";
var callbackFunc 	= "";

var curChgRow          = "";
var curNoteRow          = "";


var tieUpPath = "C:\\HANA_FILE\\UPFILE\\MRD\\";

/**************************************************************************************************
  * 공통 Function 처리 부분
***************************************************************************************************/
//  1-1.화면 셋팅 함수 
//  1-2.조회 함수     
//  1-3.저장 함수    
//  1-4.삭제 함수    
//  1-5.Transaction 후 처리 해야 할 내용

//*------------------------------------------------------------------------
//* 함수설명     : 1.1 화면셋팅 함수 
//* 함수유형     :
//* parameter    :
//* return value : 없음
//* 비고         :
//*------------------------------------------------------------------------
function fn_initForm()
{

	//*------------------------------------------------------------------------
    //* 리사이즈 컨포넌트 정의
	//* H: 가로 리사이즈
	//* W: 세로 리사이즈
	//* A: 가로세로 리사이즈
	//* R: Resize
	//* M: Move
	//* Quick view로 테스트시 주석처리 후 테스트
    //*------------------------------------------------------------------------
	gfn_SetResize(this, "Shape_search:H:R Shape_edit:H:R GRD_TIEUPCHG_LST:W:R btn_add:H:M GRD_TIEUPNOTE_LST:A:R btn_add_note:H:M btn_del_note:H:M");

	// 결재구분
	gfn_comCodeCombo(S_SIN_GBN, "AC01", "","전체");
	gfn_comCodeCombo(COB_SIN_GBN, "AC01", "","");

	// 거래상황
	gfn_comCodeCombo(S_DEAL_STS, "AC04", "","전체");
	
	// 영수증 발행
	gfn_comCodeCombo(COB_RCP_GBN, "AC02", "","");
	
	// 세금계산서 발행
	gfn_comCodeCombo(COB_BIL_GBN, "AC03", "","");
	
	// 거래상황
	gfn_comCodeCombo(COB_DEAL_STS, "AC04", "","");

	// 서류운송방법
	gfn_comCodeCombo(COB_DOC_CARY, "AC05", "","");

	// 등록구분
	gfn_comCodeCombo(S_REG_GBN, "AC13", "","전체");
	gfn_comCodeCombo(COB_REG_GBN, "AC13", "","");

	
	// 고객정보공개
	gfn_comCodeCombo(COB_CLT_OPN_YN, "AC15", "","");
	
	
	// 연락처 공개
	gfn_makeCodeDataSet("AC12", "", "DS_TEL_OPN_YN"); 


	// 업무상황
	//gfn_makeCodeDataSet("CC06", "", "DS_JOB_GBN"); 

	// 특이사항구분
	//gfn_makeCodeDataSet("CC07", "", "DS_NOTE_GBN"); 

	
	// Grid의 컬럼에 매핑 해보자 .
	gfn_setGridCombo(GRD_TIEUPCHG_LST, "DS_TEL_OPN_YN", 9);

	gfn_setGridCombo(GRD_TIEUPNOTE_LST, "DS_JOB_GBN", 5);
	gfn_setGridCombo(GRD_TIEUPNOTE_LST, "DS_NOTE_GBN", 6);
	
	
	// 공통 명령어 조정
	gfn_set_cbutton("조회:fn_search 저장:fn_save 삭제:fn_delete");
	
	fn_search('TUB_SEQ');
	
	
	// 제휴사 공개전화 조회
	fn_get_hp_info();
	
	// 기본적으로 수정불가 
	fn_tieup_edit(false);
	
		
}		

//*------------------------------------------------------------------------------------------------
//* 함수설명     : 1.2.0 조회 함수 (전체)
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         : 데이터셋 clear 후 조회 (만약 안하면 기존 데이터 남아서 조회값이 없어도 있는것 처럼 보임)
//*-----------------------------------------------------------------------------------------------
function fn_search(order_by)
{
	
	DS_TIEUP_TREE.ClearData();
	DS_TIEUP_LST.ClearData();
	DS_TIEUPCHG_LST.ClearData();
	DS_TIEUPNOTE_LST.ClearData();
	DS_TIEUPUNP_INFO.ClearData();	
	
	
	if(order_by == '')
	{
		order_by = 'TUB_SEQ';
	}
	
	
	svcID			= "CCAA01T01.selectTieUpTree";
	url   			= "service::common/select_mi.do";
	inDatasets  	= "";
	outDatasets 	= "DS_TIEUP_TREE=cc.CCTieUpDAO.selectTieUpTree"
							;	
	;
	argument    	= " _sqlName=cc.CCTieUpDAO.selectTieUpTree"
							+ " S_BRCH_ID=" + quote(GDS_USER_INFO.BRCH_ID)
							+ " S_SEARCH_STR=" + quote(S_SEARCH_STR.Text)
							+ " S_SIN_GBN=" + quote(S_SIN_GBN.value)
							+ " S_DEAL_STS=" + quote(S_DEAL_STS.value)	
							+ " S_REG_GBN=" + quote(S_REG_GBN.value)
							+ " S_ORDER=" + quote(order_by)
							+ " OPERATOR=" + quote(GDS_USER_INFO.USR_ID);							
	
	
	callbackFunc 	= "gfn_callback";

	gfn_showProgressWindow(true);
	gfn_Transaction(svcID, url, inDatasets, outDatasets, argument, callbackFunc);	 	
	

}







//*------------------------------------------------------------------------------------------------
//* 함수설명     : 1.2.1 조회 함수 (트랜젝션 일어난후 조회)
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         : 트랜젝션이 일어난 후 조회는 데이터셋을 clear 안하고 조회만 한다.
//*-----------------------------------------------------------------------------------------------
function fn_search_one(brch_id, tub_seq)
{

	DS_TIEUP_LST.ClearData();
	DS_TIEUPCHG_LST.ClearData();
	DS_TIEUPNOTE_LST.ClearData();
	DS_TIEUPUNP_INFO.ClearData();	
	
	
	curChgRow = DS_TIEUPCHG_LST.curRow;
	curNoteRow = DS_TIEUPNOTE_LST.curRow;
	
	svcID			= "CCAA01T01.selectTieUpOne";
	url   			= "service::common/select_mi.do";
	inDatasets  	= "";
	outDatasets 	= "DS_TIEUP_LST=cc.CCTieUpDAO.selectTieUpOne"
							+ " DS_TIEUPCHG_LST=cc.CCTieUpDAO.selectTieUpChgOne"
							+ " DS_TIEUPNOTE_LST=cc.CCTieUpDAO.selectTieUpNoteOne"
							+ " DS_TIEUPUNP_INFO=cc.CCTieUpDAO.selectTieupUnpOne"
							;	
	;
	argument    	= " _sqlName=cc.CCTieUpDAO.selectTieUpOne"
							+ ",cc.CCTieUpDAO.selectTieUpChgOne"
							+ ",cc.CCTieUpDAO.selectTieUpNoteOne"
							+ ",cc.CCTieUpDAO.selectTieupUnpOne"
							+ " S_BRCH_ID=" + quote(brch_id)
							+ " S_TUB_SEQ=" + quote(tub_seq)
							+ " OPERATOR=" + quote(GDS_USER_INFO.USR_ID);							
	
	
	callbackFunc 	= "gfn_callback";

	gfn_showProgressWindow(true);
	gfn_Transaction(svcID, url, inDatasets, outDatasets, argument, callbackFunc);	 	

}



//*------------------------------------------------------------------------------------------------
//* 함수설명     : 제휴사 정보 저장 함수 
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function fn_save()
{
	curChgRow = DS_TIEUPCHG_LST.curRow;
	curNoteRow = DS_TIEUPNOTE_LST.curRow;
		
	var bValidate = true;
	var pMessage = "";
	var cMessage = "";
	var isSave = false;

	
	// 필터 
	DS_TIEUP_LST.FireEvent = false;		
	DS_TIEUP_LST.UnFilter();
	DS_TIEUP_LST.Filter("FLAG !='N'");
	
	DS_TIEUPCHG_LST.FireEvent = false;		
	DS_TIEUPCHG_LST.UnFilter();
	DS_TIEUPCHG_LST.Filter("FLAG !='N'");

	DS_TIEUPNOTE_LST.FireEvent = false;		
	DS_TIEUPNOTE_LST.UnFilter();
	DS_TIEUPNOTE_LST.Filter("FLAG !='N'");	
	
	
	if(DS_TIEUP_LST.rowcount > 0)
	{
		// 필수체크
		for(var i=0;i<DS_TIEUP_LST.rowcount;i++)
		{
			
			cMessage = ""; 
		
			if(length(DS_TIEUP_LST.GetColumn(i, "TUB_NM")) == 0)
			{
				bValidate = false;
				cMessage += "제휴사명 누락 ";
			}
		
			if(length(DS_TIEUP_LST.GetColumn(i, "TUB_SEQ")) == 0)
			{
				bValidate = false;
				cMessage += "제휴사코드 누락 ";
			}			
			
			/*
			if(length(DS_TIEUP_LST.GetColumn(i, "SIN_GBN")) == 0)
			{
				bValidate = false;
				cMessage += "결재구분 누락 ";
			}
		
			if(length(DS_TIEUP_LST.GetColumn(i, "RCP_GBN")) == 0)
			{
				bValidate = false;
				cMessage += "영수증발행 누락 ";
			}			
		
			if(length(DS_TIEUP_LST.GetColumn(i, "BIL_GBN")) == 0)
			{
				bValidate = false;
				cMessage += "세금계산서발행 누락 ";
			}			
		
		
			if(length(DS_TIEUP_LST.GetColumn(i, "DEAL_STS")) == 0)
			{
				bValidate = false;
				cMessage += "거래상황 누락 ";
			}	
						
		
			if(length(DS_TIEUP_LST.GetColumn(i, "DOC_CARY")) == 0)
			{
				bValidate = false;
				cMessage += "서류운송방법 누락 ";
			}	
			*/						

			if(bValidate == false)
			{
				pMessage += "\n ["+i+"] " + cMessage;
			}
		}
	}

	if(bValidate == false)
	{
		gfn_popup_message("modal", "error", cMessage, "확인");
	}
	else
	{
		isSave = true;
	}	
	
	// 사건진행정보체크 
	if(DS_TIEUPCHG_LST.rowcount > 0)
	{
	
		// 필수체크
		for(var i=0;i<DS_TIEUPCHG_LST.rowcount;i++)
		{
			
			cMessage = "";
			
			if(length(DS_TIEUPCHG_LST.GetColumn(i, "CHG_NM")) == 0)
			{
				bValidate = false;
				cMessage += "사건담당자명 누락 ";
			}

			if(bValidate == false)
			{
				pMessage += "\n ["+i+"] " + cMessage;
			}
		}
		
		// 필수항목 누락 
		if(bValidate == false)
		{
			gfn_popup_message("modal", "error", pMessage, "확인");
		}
		else
		{
			isSave = true;
		}	
	}


	// 정상일경우 처리
	if(bValidate == true)
	{
		// 저장 
		//if(gfn_popup_message("modal", "confirm", "저장하시겠습니까?", "확인")) 
		//{

			// 저장할 항목이 있을때만 submit 한다.
			// 아니면 패스~
			if(DS_TIEUP_LST.rowcount > 0 || DS_TIEUPCHG_LST.rowcount > 0 || DS_TIEUPNOTE_LST.rowcount > 0)
			{			
			
				
				// 새로운 DataSet에 담아서 보내야됨
				// 아니면 변경된 모든것들을 보내버리므로 안됨.
				DS_TIEUP_TEMP.ClearData();
				DS_TIEUP_TEMP.CopyF("DS_TIEUP_LST");
				
				DS_TIEUPCHG_TEMP.ClearData();
				DS_TIEUPCHG_TEMP.CopyF("DS_TIEUPCHG_LST");
				
				DS_TIEUPNOTE_TEMP.ClearData();
				DS_TIEUPNOTE_TEMP.CopyF("DS_TIEUPNOTE_LST");
				
				svcID			= "CCAA01T01.saveTieUpLst";
				url   			= "service::common/select_mi.do";
				inDatasets  	= "cc.CCTieUpDAO.saveTieUpLst=DS_TIEUP_TEMP:A"
								+ " cc.CCTieUpDAO.saveTieUpChgLst=DS_TIEUPCHG_TEMP:A"
								+ " cc.CCTieUpDAO.saveTieUpNoteLst=DS_TIEUPNOTE_TEMP:A";
								
				
				outDatasets 	= "";
				argument    	= " _sqlName=cc.CCTieUpDAO.saveTieUpLst"
								+ ",cc.CCTieUpDAO.saveTieUpChgLst"	
								+ ",cc.CCTieUpDAO.saveTieUpNoteLst"	
								;
				callbackFunc 	= "gfn_callback";	
			
			
				gfn_showProgressWindow(true);
				gfn_Transaction(svcID, url, inDatasets, outDatasets, argument, callbackFunc);
			}
		//}
	
	}

	DS_TIEUP_LST.UnFilter();
	DS_TIEUP_LST.Filter("flag != 'D'");
	DS_TIEUP_LST.FireEvent = true;	

	DS_TIEUPCHG_LST.UnFilter();
	DS_TIEUPCHG_LST.Filter("flag != 'D'");
	DS_TIEUPCHG_LST.FireEvent = true;	

	DS_TIEUPNOTE_LST.UnFilter();
	DS_TIEUPNOTE_LST.Filter("flag != 'D'");
	DS_TIEUPNOTE_LST.FireEvent = true;	
	

	DS_TIEUPCHG_LST.row = curChgRow;
	DS_TIEUPNOTE_LST.row = curNoteRow;

	fn_tieupDtl_lst();	
	
}




//*------------------------------------------------------------------------------------------------
//* 함수설명     : 1.4 삭제 함수 
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function fn_delete()
{
	var bValidate = true;
	var pMessage = "";
	var cMessage = "";
	
	// 필터 
	
	// 선택된 제휴사 삭제 
	if(length(DS_TIEUP_LST.GetColumn(DS_TIEUP_LST.currow,"ROW_ID")) == 0)
	{
		gfn_popup_message("modal", "error", "삭제할 항목이 없습니다.", "확인");
		bValidate = false;	
		return;
	}
	
	// 정상일경우 처리
	if(bValidate == true)
	{
		//삭제 
		//if(gfn_popup_message("modal", "confirm", "삭제하시겠습니까? 삭제 후 복원이 불가능 합니다.", "확인")) 
		//{
		
			svcID			= "CCAA01T01.deleteTieUpLst";
			url   			= "service::common/select_mi.do";
			inDatasets  	= "";
			outDatasets 	= "";
			argument    	= " _sqlName=cc.CCTieUpDAO.deleteTieUpLst"
							+ " ROW_ID=" + quote(DS_TIEUP_LST.GetColumn(DS_TIEUP_LST.currow,"ROW_ID"))
							;
			callbackFunc 	= "gfn_callback";	
		
		
			gfn_showProgressWindow(true);
			gfn_Transaction(svcID, url, inDatasets, outDatasets, argument, callbackFunc);	 
		//}
	
	}
}



//*------------------------------------------------------------------------------------------------
//* 함수설명     : 1.5 Transaction 호출후 결과값 확인 (gfn_callback에서 fn_callback을 호출한다.)
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function fn_callback(svcID, errorCode, errorMsg)
{

	switch(svcID) 
	{
			
			
			
		// Tree 조회
		case "CCAA01T01.selectTieUpTree" :
		

			
		break;	
					
		// 한건조회
		case "CCAA01T01.selectTieUpOne" :
		
			// 조회 결과 없으면 메시지를 띄운다.
			//if(DS_TIEUP_LST.rowcount < 1) 
			//{ 
			//	gfn_popup_message("modal", "ico_info", "조회된 내용이 없습니다.", "확인");	
			//}
			
			// 수정불가 
			fn_tieup_edit(false);
			
			fn_tieupDtl_lst();
			
		break;	

		
		// 수정
		case "CCAA01T01.saveTieUpLst" :
			gfn_setMsg("제휴사 추가/수정 완료: "+ DS_TIEUP_LST.GetColumn(0,"TUB_NM"));
			fn_search_one(DS_TIEUP_LST.GetColumn(DS_TIEUP_LST.currow,"BRCH_ID"), DS_TIEUP_LST.GetColumn(DS_TIEUP_LST.currow,"TUB_SEQ"));		
		break;	
		
		
		// 삭제
		case "CCAA01T01.deleteTieUpLst" :
		
			gfn_setMsg("modal", "ico_info", "제휴사 삭제 완료" , "확인");	
			fn_search('TUB_SEQ');			
		break;	


		// 제휴사공개전화
		case "CCAA01T01.selectHpInfo" :
		
			gfn_comCodeDSCombo(COB_CLT_OPN_HP, "DS_HP_INFO", "","","");
		
		break;	
				
				
		
		default:
	}



	if(curChgRow != null) 
	{
		DS_TIEUPCHG_LST.row = curChgRow;
	}

	if(curNoteRow != null) 
	{
		DS_TIEUPNOTE_LST.row = curNoteRow;
	}

}




/**************************************************************************************************
  * 사용자 정의  Function 처리 부분
***************************************************************************************************/


//*------------------------------------------------------------------------------------------------
//* 함수설명     : 사건진행정보 필터링
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
// * 2014-02-27 :  더블클릭으로 변경 
//*-----------------------------------------------------------------------------------------------
function fn_tieupDtl_lst()
{


	DS_TIEUPCHG_LST.FireEvent = false;		
	DS_TIEUPCHG_LST.UnFilter();
	DS_TIEUPCHG_LST.Filter("flag != 'D'");	

	DS_TIEUPCHG_LST.FireEvent = true;
	
	DS_TIEUPCHG_LST.row = curChgRow;	

	DS_TIEUPNOTE_LST.FireEvent = false;		
	DS_TIEUPNOTE_LST.UnFilter();
	DS_TIEUPNOTE_LST.Filter("flag != 'D'");	

	DS_TIEUPNOTE_LST.FireEvent = true;
	
	DS_TIEUPNOTE_LST.row = curNoteRow;	
	
}

//*------------------------------------------------------------------------------------------------
//* 함수설명     : 제휴사 코드 채번
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function fn_get_tub_seq()
{
	
	svcID			= "CCAA01T01.selectTubSeq";
	url   			= "service::common/select_mi.do";
	inDatasets  	= "";
	outDatasets 	= "DS_TUB_SEQ=cc.CCTieUpDAO.selectTubSeq";	
	
	argument    	= " _sqlName=cc.CCTieUpDAO.selectTubSeq";	

	callbackFunc 	= "gfn_callback";

	gfn_SyncTransaction(svcID, url, inDatasets, outDatasets, argument, callbackFunc);	
	    
	return DS_TUB_SEQ.GetColumn(0, "TUB_SEQ");    
	    
    
}

// 공개전화번호
function fn_get_hp_info()
{
	
	svcID			= "CCAA01T01.selectHpInfo";
	url   			= "service::common/select_mi.do";
	inDatasets  	= "";
	outDatasets 	= "DS_HP_INFO=cc.CCTieUpDAO.selectCltOpnHp";	
	
	argument    	= " _sqlName=cc.CCTieUpDAO.selectCltOpnHp"
					+ " S_BRCH_ID=" + quote(GDS_USER_INFO.BRCH_ID);
													
	callbackFunc 	= "gfn_callback";

	gfn_SyncTransaction(svcID, url, inDatasets, outDatasets, argument, callbackFunc);	
	    
	    
    
}




//*------------------------------------------------------------------------------------------------
//* 함수설명     : 파일업로드 
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function fn_file_upload()
{
	// 사진추가된 경우
	if(length(File1.FileName) != 0)
	{
		var tmpFileName =  FileDialog1.FileName;			// 파일명
		var chkFile = "";									// 임시 파일명
		var fileExt = "";										// 확장자 
		
		fileExt = gfn_getExt(tmpFileName);
				
		// MRD 파일만 저장되게
		if(ToUpper(fileExt) != 'MRD')
		{
			gfn_popup_message("modal", "ico_alert", "사업자등록증 파일은 MRD(Report Designer) 파일 형식이어야 합니다.", "확인");
			return;
		}
	
		// 1. 사진 저장
		var filefullname = File1.FileName;
		var savefilename = "BIZ_" + DS_TIEUP_LST.GetColumn(DS_TIEUP_LST.curRow, "TUB_SEQ") +"."+fileExt; 
		var savepath  = tieUpPath + savefilename;
		
		var ret = gfn_FileWrite(multipart_http0, filefullname, savefilename, savepath);
		
		// 업로드 실패
		if(ret[0] == "FAIL")
		{
			gfn_popup_message("modal", "ico_alert", "사업자등록증 저장에 실패하였습니다.", "확인");
		}
		// 업로드 성공
		else
		{
			DS_TIEUP_LST.SetColumn(DS_TIEUP_LST.curRow, "BIZ_FILE_NM", FileDialog1.FileName);		// 원본파일명
			DS_TIEUP_LST.SetColumn(DS_TIEUP_LST.curRow, "BIZ_FILE_SAVE_NM", savefilename);			// 저장파일명
		}
	}

	
//	File1.Delete();
	File1.Close();	
}


//*------------------------------------------------------------------------------------------------
//* 함수설명     : 하나담당 팝업
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function fn_hna_popup()
{
	
	var params = "P_BRCH_ID=" + quote(GDS_USER_INFO.BRCH_ID)
			   + " P_USR_NM=" + quote(EDT_HNA_CHG_USR_NM.Text);
			   	
			   	
	var retArr = gfn_openPopup(this, "CP::CPAB04P01.xml", params, true);

	DS_TIEUP_LST.SetColumn(DS_TIEUP_LST.curRow,"HNA_CHG_USR", retArr[0]);
	DS_TIEUP_LST.SetColumn(DS_TIEUP_LST.curRow,"HNA_CHG_USR_NM", retArr[1]);

}

/**************************************************************************************************
  * 공통 Event 처리 부분
***************************************************************************************************/
//  2-1.Load 부분
//  2-2.UnLoad 부분
//  2-3 onSize 부분
//  2-4.초기화 부분
//  2-5.조회 버튼 클릭     
//  2-6.저장 버튼 클릭    
//  2-7.삭제 버튼 클릭    
//  2-8.엑셀 버튼 클릭    

//*------------------------------------------------------------------------------------------------
//* 함수설명     : 2-1.화면 Load 완료시 실행 스크립트 
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function CCAA01T01_OnLoadCompleted(obj)
{
	// 공통 init
	gfn_OnInit();
	
	// 폼초기화 
	fn_initForm();

}

//*------------------------------------------------------------------------------------------------
//* 함수설명     : 2-2.화면 Unload 시 실행 스크립트
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function CCAA01T01_OnUnloadCompleted(obj)
{
	fn_save();
	gfn_OnBeforeExit();
}








/**************************************************************************************************
  * 사용자 정의  Event 처리 부분
***************************************************************************************************/






//*------------------------------------------------------------------------------------------------
//* 함수설명     : Grid 셀 클릭시 
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//*-----------------------------------------------------------------------------------------------
function GRD_TIEUP_LST_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	fn_tieupDtl_lst();
}


function GRD_TIEUPCHG_LST_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	curChgRow = nRow;
}


function GRD_TIEUPNOTE_LST_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	curNoteRow = nRow;

	// 업무상황 구분 선택
	if(nCell == 7 || nCell == 8)
	{	
		var retArr = gfn_openPopup(this, "CP::CPAB05P07.xml", "P_MST_CD=CC06", true);
		
		DS_TIEUPNOTE_LST.SetColumn(nRow,"JOB_GBN", retArr[0]);
		DS_TIEUPNOTE_LST.SetColumn(nRow,"JOB_GBN_NM", retArr[1]);
		DS_TIEUPNOTE_LST.SetColumn(nRow,"NOTE_GBN", retArr[2]);
		DS_TIEUPNOTE_LST.SetColumn(nRow,"NOTE_GBN_NM", retArr[3]);
	}	
	

}


//*------------------------------------------------------------------------------------------------
//* 함수설명     : Grid 셀 더블클릭시 
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//*-----------------------------------------------------------------------------------------------
function GRD_TIEUP_LST_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	fn_save();
	
	// 한건조회
	fn_search_one(DS_TIEUP_TREE.GetColumn(DS_TIEUP_TREE.currow,"BRCH_ID"), DS_TIEUP_TREE.GetColumn(DS_TIEUP_TREE.currow,"TUB_SEQ"));
}



function GRD_TIEUPCHG_LST_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	// 열려진 창이 있으면 해당창에 포커스 
	var oForm = global.AllWindows["CPAD02P01"];
	if(oForm != null)
	{
		oForm[0].setFocus();
	}
	else
	{
		// 에디터 팝업 띄움
		gfn_openPopup(this, "CP::CPAD02P01.xml", "" , false);
	}		
}


//*------------------------------------------------------------------------------------------------
//* 함수설명     : Grid 해더 클릭시 
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//*-----------------------------------------------------------------------------------------------
function GRD_TIEUP_LST_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	gfn_GridSort(GRD_TIEUP_LST, DS_TIEUP_LST, nCell);	
}

function GRD_TIEUPCHG_LST_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	gfn_GridSort(GRD_TIEUPCHG_LST, DS_TIEUPCHG_LST, nCell);	
}


function GRD_TIEUPNOTE_LST_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	gfn_GridSort(GRD_TIEUPNOTE_LST, DS_TIEUPNOTE_LST, nCell);	
}


//*------------------------------------------------------------------------------------------------
//* 함수설명     : 파일첨부  실행 스크립트
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function BTN_FILE_SAVE_OnClick(obj)
{
	
	// 기본정보가 선택되지 않으면 경고 
	if(length(DS_TIEUP_LST.GetColumn(DS_TIEUP_LST.curRow,"TUB_SEQ")) == 0)
	{
		gfn_popup_message("modal", "error", "먼저 제휴사 기본정보를 선택 해야 합니다. ", "확인");
		return;
	}	
	
	FileDialog1.Type = "OPEN";
	
	if(FileDialog1.Open()){


		var fileExt = gfn_getExt(FileDialog1.FileName);
				
		// MRD 파일만 저장되게
		if(ToUpper(fileExt) != 'MRD')
		{
			gfn_popup_message("modal", "ico_alert", "사업자등록증 파일은 MRD(Report Designer) 파일 형식이어야 합니다.", "확인");
			return;
		}


		File1.FileName = FileDialog1.FilePath + "\\" + FileDialog1.FileName;
		
		DS_TIEUP_LST.SetColumn(DS_TIEUP_LST.curRow, "BIZ_FILE_NM", FileDialog1.FileName);

		// 바로 저장 
		fn_file_upload();	
	
	}	
}

//*------------------------------------------------------------------------------------------------
//* 함수설명     : 파일다운  실행 스크립트
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function BTN_FILE_DOWN_OnClick(obj)
{
	
	// 기본정보가 선택되지 않으면 경고 
	if(length(DS_TIEUP_LST.GetColumn(DS_TIEUP_LST.curRow,"TUB_SEQ")) == 0)
	{
		gfn_popup_message("modal", "error", "먼저 제휴사 기본정보를 선택 해야 합니다. ", "확인");
		return;
	}	
	
	var str_param = DS_TIEUP_LST.GetColumn(DS_TIEUP_LST.curRow, "BIZ_FILE_SAVE_NM");
	
	FileDialog1.Type = "save";
	//FileDialog1.FileName = str_param;	
	FileDialog1.Open();	
	//trace(" >>> " + FileDialog1.FilePath);
	
	var savefilename = str_param;
	var savepath  = tieUpPath + savefilename;
			
	var ret = gfn_ReadFile(multipart_http0, FileDialog1.FilePath +"\\"+ FileDialog1.FileName, savepath, 0);

	if ( ret[0] == "FAIL" )
	{
		alert('오류:'+ret[1]);
	} 	
}


//*------------------------------------------------------------------------------------------------
//* 함수설명     : 파일삭제  실행 스크립트
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function BTN_FILE_DEL_OnClick(obj)
{
	DS_TIEUP_LST.SetColumn(DS_TIEUP_LST.curRow, "BIZ_FILE_NM", "");
	DS_TIEUP_LST.SetColumn(DS_TIEUP_LST.curRow, "BIZ_FILE_SAVE_NM", "");
}

 
//*------------------------------------------------------------------------------------------------
//* 함수설명     : 추가 클릭시  실행 스크립트
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function btn_add_OnClick(obj)
{

	DS_TIEUP_LST.ClearData();
	DS_TIEUPCHG_LST.ClearData();
	DS_TIEUPNOTE_LST.ClearData();
		
	
	var vRow = DS_TIEUP_LST.AddRow();
    var TUB_SEQ = fn_get_tub_seq();
    
	
	// 기초값
	DS_TIEUP_LST.SetColumn(vRow,"FLAG","I");	// 추가 FLAG 넣기
	DS_TIEUP_LST.SetColumn(vRow,"ROW_ID","");	// ROW_ID(조회후 셋팅됨)
	DS_TIEUP_LST.SetColumn(vRow,"OPERATOR", GDS_USER_INFO.GetColumn(0, "USR_ID"));// 등록자, 수정자 넣기
    
    DS_TIEUP_LST.SetColumn(vRow,"BRCH_ID", GDS_USER_INFO.GetColumn(0, "BRCH_ID"));// 
    DS_TIEUP_LST.SetColumn(vRow,"TUB_SEQ", TUB_SEQ);// 

	
	

}






//*------------------------------------------------------------------------------------------------
//* 함수설명     : 행추가 클릭시  실행 스크립트
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function btn_add_dtl_OnClick(obj)
{
	
	// 기본정보가 선택되지 않으면 경고 
	if(length(DS_TIEUP_LST.GetColumn(DS_TIEUP_LST.curRow,"TUB_SEQ")) == 0)
	{
		gfn_popup_message("modal", "error", "먼저 제휴사 기본정보를 선택 해야 합니다. ", "확인");
		return;
	}
	
	var vRow = DS_TIEUPCHG_LST.AddRow();
	
	// 기초값
	DS_TIEUPCHG_LST.SetColumn(vRow,"FLAG","I");	// 추가 FLAG 넣기
	DS_TIEUPCHG_LST.SetColumn(vRow,"ROW_ID","");	// ROW_ID(조회후 셋팅됨)
	DS_TIEUPCHG_LST.SetColumn(vRow,"OPERATOR", GDS_USER_INFO.GetColumn(0, "USR_ID"));// 등록자, 수정자 넣기
    
    DS_TIEUPCHG_LST.SetColumn(vRow,"BRCH_ID", DS_TIEUP_LST.GetColumn(DS_TIEUP_LST.curRow, "BRCH_ID"));// 
    DS_TIEUPCHG_LST.SetColumn(vRow,"TUB_SEQ", DS_TIEUP_LST.GetColumn(DS_TIEUP_LST.curRow, "TUB_SEQ"));// 

    // 제휴사 값도 수정처리	
	DS_TIEUP_LST.SetColumn(0,"FLAG", "U");
	
	// 수정 팝업 띄우기
	GRD_TIEUPCHG_LST_OnCellDblClick();
	
	
}


function btn_add_note_OnClick(obj)
{
	// 기본정보가 선택되지 않으면 경고 
	if(length(DS_TIEUP_LST.GetColumn(DS_TIEUP_LST.curRow,"TUB_SEQ")) == 0)
	{
		gfn_popup_message("modal", "error", "먼저 제휴사 기본정보를 선택 해야 합니다. ", "확인");
		return;
	}
	
	var vRow = DS_TIEUPNOTE_LST.AddRow();
	
	// 기초값
	DS_TIEUPNOTE_LST.SetColumn(vRow,"FLAG","I");	// 추가 FLAG 넣기
	DS_TIEUPNOTE_LST.SetColumn(vRow,"ROW_ID","");	// ROW_ID(조회후 셋팅됨)
	DS_TIEUPNOTE_LST.SetColumn(vRow,"OPERATOR", GDS_USER_INFO.GetColumn(0, "USR_ID"));// 등록자, 수정자 넣기
    
    DS_TIEUPNOTE_LST.SetColumn(vRow,"BRCH_ID", DS_TIEUP_LST.GetColumn(DS_TIEUP_LST.curRow, "BRCH_ID"));// 
    DS_TIEUPNOTE_LST.SetColumn(vRow,"TUB_SEQ", DS_TIEUP_LST.GetColumn(DS_TIEUP_LST.curRow, "TUB_SEQ"));// 

    // 제휴사 값도 수정처리	
	DS_TIEUP_LST.SetColumn(0,"FLAG", "U");
	
}




//*------------------------------------------------------------------------------------------------
//* 함수설명     : 행삭제 클릭시  실행 스크립트
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function btn_del_dtl_OnClick(obj)
{
	curChgRow = DS_TIEUPCHG_LST.curRow;
	
	// 추가된것은 DB저장전이므로 그냥 DataSet에서 삭제
	if(DS_TIEUPCHG_LST.GetColumn(curChgRow,"FLAG") == "I")
	{
		
		DS_TIEUPCHG_LST.DeleteRow(curChgRow);
	}
	// 아닌것은 실제로 DB에 삭제해야되므로 flag를 D로 두고 마지막에 filter한다.
	else
	{
		DS_TIEUPCHG_LST.SetColumn(curChgRow,"FLAG", "D");
	}	
	
	DS_TIEUPCHG_LST.Filter("flag != 'D'");	// 삭제된거는 필터링

	fn_tieupDtl_lst();	
}



function btn_del_note_OnClick(obj)
{
	curNoteRow = DS_TIEUPNOTE_LST.curRow;

	
	// 추가된것은 DB저장전이므로 그냥 DataSet에서 삭제
	if(DS_TIEUPNOTE_LST.GetColumn(row,"FLAG") == "I")
	{
		DS_TIEUPNOTE_LST.DeleteRow(curNoteRow);
	}
	// 아닌것은 실제로 DB에 삭제해야되므로 flag를 D로 두고 마지막에 filter한다.
	else
	{
		DS_TIEUPNOTE_LST.SetColumn(curNoteRow,"FLAG", "D");
	}	
	
	DS_TIEUPNOTE_LST.Filter("flag != 'D'");	// 삭제된거는 필터링

	fn_tieupDtl_lst();		
}


//*------------------------------------------------------------------------------------------------
//* 함수설명     : DataSet 변경시 자동저장
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function DS_TIEUP_LST_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	// flag가 'N' 이면 'U' 로 바꾼다.
	if(obj.GetColumn(nRow, "FLAG") == "N" )
	{
		obj.SetColumn(nRow, "FLAG", "U");	// 수정했다는 표시 
	}
	
	
	// 미수금이 바뀌면 총합계도 바꾼다.
	if(strColumnID == 'UNP_AMT')
	{
		DS_TIEUPUNP_INFO.SetColumn(0,"TOT_AMT", (ToNumber(obj.GetColumn(nRow, strColumnID)) + ToNumber(DS_TIEUPUNP_INFO.GetColumn(0, "OCC_AMT"))));
	}
	
}



function DS_TIEUPCHG_LST_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	// flag가 'N' 이면 'U' 로 바꾼다.
	if(obj.GetColumn(nRow, "FLAG") == "N" )
	{
		obj.SetColumn(nRow, "FLAG", "U");	// 수정했다는 표시 
	}	
	
    // 제휴사 값도 수정처리	
	DS_TIEUP_LST.SetColumn(0,"FLAG", "U");

	
}


function DS_TIEUPNOTE_LST_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	/*
	// 업무상황이 바뀌면 구분을 다시 채운다.
	if(strColumnID == "JOB_GBN")
	{
		DS_NOTE_GBN.UnFilter();
		DS_NOTE_GBN.Filter("TXT_VAL1='"+obj.GetColumn(nRow, "JOB_GBN")+"'");	
		
		gfn_setGridCombo(GRD_TIEUPNOTE_LST, "DS_NOTE_GBN", 6);

	}
	*/

	
	// flag가 'N' 이면 'U' 로 바꾼다.
	if(obj.GetColumn(nRow, "FLAG") == "N" )
	{
		obj.SetColumn(nRow, "FLAG", "U");	// 수정했다는 표시 
	}	
	
    // 제휴사 값도 수정처리	
	DS_TIEUP_LST.SetColumn(0,"FLAG", "U");
	
}





//*------------------------------------------------------------------------------------------------
//* 함수설명     : 전체 제휴사
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function btn_all_search_OnClick(obj)
{
	S_HNA_CHG_USR.Text = "";
	fn_search('TUB_SEQ');	
}


//*------------------------------------------------------------------------------------------------
//* 함수설명     : 나의 제휴사
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function btn_my_search_OnClick(obj)
{
	S_HNA_CHG_USR.Text = GDS_USER_INFO.USR_NM;
	fn_search('TUB_SEQ');
}



//*------------------------------------------------------------------------------------------------
//* 함수설명     : 신규등록일
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function btn_search_ord1_OnClick(obj)
{
	fn_search('CRT_DT');	
}


//*------------------------------------------------------------------------------------------------
//* 함수설명     : 마지막거래일 
//* 함수유형     : 
//* parameter    : 
//* return value : 없음
//* 비고         :
//*-----------------------------------------------------------------------------------------------
function btn_search_ord2_OnClick(obj)
{
	fn_search('LST_DEAL_DT');	
}




function S_SEARCH_STR_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if(nChar==13){				
		fn_search('TUB_SEQ');	
	}	
}




function EDT_HNA_CHG_USR_NM_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if(nChar==13){				
		fn_hna_popup('TUB_SEQ');	
	}		
}

function POP_HNA_CHG_USR_OnClick(obj)
{
	fn_hna_popup();	
}



function DS_TIEUP_LST_OnRowPosChanged(obj,nOldRow,nRow)
{
	fn_tieupDtl_lst();	
}


// 기본정보 수정
function btn_mst_edit_OnClick(obj)
{
	fn_tieup_edit(true);
}

// 기본정보 수정완료
function btn_mst_ok_OnClick(obj)
{
	fn_tieup_edit(false);
}




// 수정가능 유무 설정
function fn_tieup_edit(isEdit)
{
	//  수정가능 유무
	if(isEdit == false)
	{
		EDT_TUB_NM.Readonly = true;
		EDT_TUB_TEL.Readonly = true;
		EDT_TUB_FAX.Readonly = true;
		EDT_TUB_ADDR.Readonly = true;
		MAE_BAG_AGC_AMT.Readonly = true;
		MAE_ETC_AGC_AMT.Readonly = true;
		EDT_SIN_NM.Readonly = true;
		EDT_SIN_TEL.Readonly = true;
		EDIT_DT_STR.Readonly = true;
		EDT_DEAL_STOP_RSN.Readonly = true;
		EDT_HNA_CHG_USR_NM.Readonly = true;
		EDT_BIZ_FILE_NM.Readonly = true;
		TXT_RLT_NM.Readonly = true;
		
		COB_SIN_GBN.Enable = false;
		COB_REG_GBN.Enable = false;
		COB_RCP_GBN.Enable = false;
		COB_BIL_GBN.Enable = false;
		COB_DEAL_STS.Enable = false;
		COB_DOC_CARY.Enable = false;
		COB_CLT_OPN_YN.Enable = false;
		COB_CLT_OPN_HP.Enable = false;
		
		
		
		POP_HNA_CHG_USR.Visible = false;
		BTN_FILE_SAVE.Enable = false;
		BTN_FILE_DEL.Enable = false;


	}
	else
	{
		EDT_TUB_NM.Readonly = false;
		EDT_TUB_TEL.Readonly = false;
		EDT_TUB_FAX.Readonly = false;
		EDT_TUB_ADDR.Readonly = false;
		MAE_BAG_AGC_AMT.Readonly = false;
		MAE_ETC_AGC_AMT.Readonly = false;
		EDT_SIN_NM.Readonly = false;
		EDT_SIN_TEL.Readonly = false;
		EDIT_DT_STR.Readonly = false;
		EDT_DEAL_STOP_RSN.Readonly = false;
		EDT_HNA_CHG_USR_NM.Readonly = false;
		EDT_BIZ_FILE_NM.Readonly = false;
		TXT_RLT_NM.Readonly = false;
		
		COB_SIN_GBN.Enable = true;
		COB_REG_GBN.Enable = true;
		COB_RCP_GBN.Enable = true;
		COB_BIL_GBN.Enable = true;
		COB_DEAL_STS.Enable = true;
		COB_DOC_CARY.Enable = true;
		COB_CLT_OPN_YN.Enable = true;
		COB_CLT_OPN_HP.Enable = true;
		
		POP_HNA_CHG_USR.Visible = true;
		BTN_FILE_SAVE.Enable = true;
		BTN_FILE_DEL.Enable = true;


	}

}

]]></Script>
</Window>