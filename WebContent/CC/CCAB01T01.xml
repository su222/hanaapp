<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form Height="650" Id="CCAB01T01" Left="8" OnLoadCompleted="CCAB01T01_OnLoadCompleted" OnUnloadCompleted="CMC03T01_OnSize" PidAttrib="7" Title="°øÅëÄÚµå°ü¸®" ToolTipFont="Default,0" Top="8" Ver="1.0" Width="1240" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="DS_TEMP_MST"></Dataset>
			<Dataset DataSetType="Dataset" Id="DS_CODE_MST" OnColumnChanged="DS_CODE_MST_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ROW_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="OPERATOR" size="256" summ="default" type="STRING"/>
					<colinfo id="MST_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="MST_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TXT_VAL1" size="256" summ="default" type="STRING"/>
					<colinfo id="TXT_VAL2" size="256" summ="default" type="STRING"/>
					<colinfo id="NUM_VAL1" size="256" summ="default" type="STRING"/>
					<colinfo id="NUM_VAL2" size="256" summ="default" type="STRING"/>
					<colinfo id="NOTE" size="256" summ="default" type="STRING"/>
					<colinfo id="USE_YN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="DS_CODE_DTL" OnColumnChanged="DS_CODE_DTL_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ROW_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="OPERATOR" size="256" summ="default" type="STRING"/>
					<colinfo id="MST_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DTL_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DTL_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TXT_VAL1" size="256" summ="default" type="STRING"/>
					<colinfo id="TXT_VAL2" size="256" summ="default" type="STRING"/>
					<colinfo id="TXT_VAL3" size="256" summ="default" type="STRING"/>
					<colinfo id="NUM_VAL1" size="256" summ="default" type="STRING"/>
					<colinfo id="NUM_VAL2" size="256" summ="default" type="STRING"/>
					<colinfo id="NUM_VAL3" size="256" summ="default" type="STRING"/>
					<colinfo id="NOTE" size="256" summ="default" type="STRING"/>
					<colinfo id="SORT_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="USE_YN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="DS_TEMP_DTL"></Dataset>
		</Datasets>
		<Shape BKColor="user21" Bottom="46" Height="40" Id="Shape_search" Left="0" LineColor="user22" Right="1234" RoundHeight="10" RoundUnit="Pixel" RoundWidth="10" TabOrder="0" Top="6" Type="RoundRect" Width="1234"></Shape>
		<Edit Border="Flat" Height="18" Id="S_MST_NM" Left="94" LeftMargin="4" OnKeyDown="S_MST_NM_OnKeyDown" Style="Edit" TabOrder="1" Top="17" Width="250"></Edit>
		<Shape Bottom="48" Height="40" Id="Shape21" Left="74" LineColor="sienna" LineKind="Vertical" LineWidth="10" Right="94" TabOrder="3" Top="8" Type="Rectangle" Visible="FALSE" Width="20"></Shape>
		<Image Align="Left" Height="18" Id="Image3" ImageID="label_dot" Left="10" LeftMargin="12" Style="Stc_Default_bold" TabOrder="4" Text="ÄÚµå±×·ì" Top="17" Transparent="TRUE" Width="65"></Image>
		<Shape Bottom="61" Height="15" Id="Shape1" Left="0" LineColor="seagreen" LineKind="Vertical" LineWidth="10" Right="1239" TabOrder="5" Top="46" Type="Rectangle" Visible="FALSE" Width="1239"></Shape>
		<Shape Bottom="5" Height="5" Id="Shape15" Left="5" LineColor="seagreen" LineKind="Vertical" LineWidth="5" Right="1244" TabOrder="6" Top="0" Type="Rectangle" Visible="FALSE" Width="1239"></Shape>
		<Grid AreaSelect="true" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="DS_CODE_MST" BkColor2="user55" BkSelColor="user54" BoldHead="FALSE" Border="Flat" Bottom="344" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" Font="µ¸¿ò,9" HeadBorder="Flat" HeadHeight="24" Height="256" Id="GRD_CODE_MST" InputPanel="FALSE" LineColor="default" LineType="OnlyVERT" OnCellClick="GRD_CODE_MST_OnCellClick" OnHeadClick="GRD_CODE_MST_OnHeadClick" Right="1234" RowHeight="20" Style="Grid_2" TabOrder="7" TabStop="true" Top="88" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1234">
			<contents>
				<format id="Default">
					<columns>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="30"/>
						<col width="70"/>
						<col width="100"/>
						<col width="50"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="200"/>
					</columns>
					<head>
						<cell col="-1" display="text">
							<cell col="0" display="text"/>
							<cell col="1" color="user52" display="text" text="Ãâ°í¹øÈ£"/>
						</cell>
						<cell col="0" display="text" text="FLAG"/>
						<cell col="1" display="text" text="ROW_ID"/>
						<cell col="2" display="text" text="OPERATOR"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="3" color="user52" display="text" font="µ¸¿ò,10,Bold" text="No"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="4" color="user52" display="text" font="µ¸¿ò,10,Bold" text="ÄÚµå±×·ì"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="5" color="user52" display="text" font="µ¸¿ò,10,Bold" text="±×·ì¸í"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="6" color="user52" display="text" font="µ¸¿ò,10,Bold" text="»ç¿ë"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="7" color="user52" display="text" font="µ¸¿ò,10,Bold" text="TXT_VAL1"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="8" color="user52" display="text" font="µ¸¿ò,10,Bold" text="TXT_VAL2"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="9" color="user52" display="text" font="µ¸¿ò,10,Bold" text="NUM_VAL1"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="10" color="user52" display="text" font="µ¸¿ò,10,Bold" text="NUM_VAL2"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="11" color="user52" display="text" font="µ¸¿ò,10,Bold" text="ºñ°í"/>
					</head>
					<body>
						<cell col="0" colid="FLAG" display="text"/>
						<cell col="1" colid="ROW_ID" display="text"/>
						<cell col="2" colid="OPERATOR" display="text"/>
						<cell align="center" col="3" display="text" expr="row&#32;+&#32;1"/>
						<cell align="left" col="4" colid="MST_CD" color="black" display="text" edit="normal"/>
						<cell align="left" col="5" colid="MST_NM" color="black" display="text" edit="normal"/>
						<cell align="center" col="6" colid="USE_YN" display="checkbox" edit="checkbox" limit="24"/>
						<cell align="left" col="7" colid="TXT_VAL1" color="black" display="text" edit="normal"/>
						<cell align="left" col="8" colid="TXT_VAL2" color="black" display="text" edit="normal"/>
						<cell align="left" col="9" colid="NUM_VAL1" color="black" display="text" edit="normal"/>
						<cell align="left" col="10" colid="NUM_VAL2" color="black" display="text" edit="normal"/>
						<cell align="left" col="11" colid="NOTE" color="black" display="text" edit="normal"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid AreaSelect="true" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="DS_CODE_DTL" BkColor2="user55" BkSelColor="user54" BoldHead="FALSE" Border="Flat" Bottom="641" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" Font="µ¸¿ò,9" HeadBorder="Flat" HeadHeight="24" Height="256" Id="GRD_CODE_DTL" InputPanel="FALSE" LineColor="default" LineType="OnlyVERT" OnCellClick="GRD_CODE_DTL_OnCellClick" OnHeadClick="GRD_CODE_DTL_OnHeadClick" Right="1234" RowHeight="20" Style="Grid_2" TabOrder="8" TabStop="true" Top="385" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1234">
			<contents>
				<format id="Default">
					<columns>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="30"/>
						<col width="60"/>
						<col width="60"/>
						<col width="100"/>
						<col width="50"/>
						<col width="40"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="200"/>
					</columns>
					<head>
						<cell col="-1" display="text">
							<cell col="0" display="text"/>
							<cell col="1" color="user52" display="text" text="Ãâ°í¹øÈ£"/>
						</cell>
						<cell col="0" display="text" text="FLAG"/>
						<cell col="1" display="text" text="ROW_ID"/>
						<cell col="2" display="text" text="OPERATOR"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="3" color="user52" display="text" font="µ¸¿ò,10,Bold" text="No"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="4" color="user52" display="text" font="µ¸¿ò,10,Bold" text="ÄÚµå±×·ì"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="5" color="user52" display="text" font="µ¸¿ò,10,Bold" text="ÄÚµå"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="6" color="user52" display="text" font="µ¸¿ò,10,Bold" text="ÄÚµå¸í"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="7" color="user52" display="text" font="µ¸¿ò,10,Bold" text="»ç¿ë"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="8" color="user52" display="text" font="µ¸¿ò,10,Bold" text="¼ø¼­"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="9" color="user52" display="text" font="µ¸¿ò,10,Bold" text="TXT_VAL1"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="10" color="user52" display="text" font="µ¸¿ò,10,Bold" text="TXT_VAL2"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="11" color="user52" display="text" font="µ¸¿ò,10,Bold" text="TXT_VAL3"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="12" color="user52" display="text" font="µ¸¿ò,10,Bold" text="NUM_VAL1"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="13" color="user52" display="text" font="µ¸¿ò,10,Bold" text="NUM_VAL2"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="14" color="user52" display="text" font="µ¸¿ò,10,Bold" text="NUM_VAL3"/>
						<cell bkcolor="user51" bkimagealign="stretch" col="15" color="user52" display="text" font="µ¸¿ò,10,Bold" text="ºñ°í"/>
					</head>
					<body>
						<cell col="0" colid="FLAG" display="text"/>
						<cell col="1" colid="ROW_ID" display="text"/>
						<cell col="2" colid="OPERATOR" display="text"/>
						<cell align="center" col="3" display="text" expr="row&#32;+&#32;1"/>
						<cell align="left" col="4" colid="MST_CD" color="black" display="text"/>
						<cell align="left" col="5" colid="DTL_CD" color="black" display="text" edit="normal"/>
						<cell align="left" col="6" colid="DTL_NM" color="black" display="text" edit="normal"/>
						<cell align="center" col="7" colid="USE_YN" display="checkbox" edit="checkbox" limit="24"/>
						<cell align="right" col="8" colid="SORT_NO" color="black" display="text" edit="normal"/>
						<cell align="left" col="9" colid="TXT_VAL1" color="black" display="text" edit="normal"/>
						<cell align="left" col="10" colid="TXT_VAL2" color="black" display="text" edit="normal"/>
						<cell align="left" col="11" colid="TXT_VAL3" color="black" display="text" edit="normal"/>
						<cell align="left" col="12" colid="NUM_VAL1" color="black" display="text" edit="normal"/>
						<cell align="left" col="13" colid="NUM_VAL2" color="black" display="text" edit="normal"/>
						<cell align="left" col="14" colid="NUM_VAL3" color="black" display="text" edit="normal"/>
						<cell align="left" col="15" colid="NOTE" color="black" display="text" edit="normal"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="21" Id="btn_del_mst" ImageID="Btn_sub_del" Left="1173" OnClick="btn_del_mst_OnClick" Style="Btn_sub" TabOrder="10" Text="&#32;&#32;&#32;Çà»èÁ¦" Top="62" Width="61"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="21" Id="btn_add_mst" ImageID="Btn_sub_rowadd" Left="1107" OnClick="btn_add_mst_OnClick" Style="Btn_sub" TabOrder="9" Text="&#32;&#32;&#32;ÇàÃß°¡" Top="62" Width="61"></Button>
		<Shape Bottom="88" Height="5" Id="Shape0" Left="-8" LineColor="seagreen" LineKind="Vertical" LineWidth="5" Right="1231" TabOrder="12" Top="83" Type="Rectangle" Visible="FALSE" Width="1239"></Shape>
		<Image Align="Left" Height="14" Id="Image2" ImageID="Title_dot" LeftMargin="20" Style="Stc_Subtitle" TabOrder="11" Text="ÄÚµå±×·ì" Top="69" Transparent="TRUE" Width="157"></Image>
		<Shape Bottom="359" Height="15" Id="Shape3" Left="-1" LineColor="seagreen" LineKind="Vertical" LineWidth="10" Right="1238" TabOrder="13" Top="344" Type="Rectangle" Visible="FALSE" Width="1239"></Shape>
		<Shape Bottom="385" Height="5" Id="Shape4" Left="5" LineColor="seagreen" LineKind="Vertical" LineWidth="5" Right="1244" TabOrder="14" Top="380" Type="Rectangle" Visible="FALSE" Width="1239"></Shape>
		<Image Align="Left" Height="14" Id="Image0" ImageID="Title_dot" LeftMargin="20" Style="Stc_Subtitle" TabOrder="15" Text="°øÅëÄÚµå" Top="366" Transparent="TRUE" Width="157"></Image>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="21" Id="btn_add_dtl" ImageID="Btn_sub_rowadd" Left="1107" OnClick="btn_add_dtl_OnClick" Style="Btn_sub" TabOrder="16" Text="&#32;&#32;&#32;ÇàÃß°¡" Top="359" Width="61"></Button>
		<Shape Bottom="385" Height="32" Id="Shape2" Left="1168" LineColor="tomato" LineKind="Vertical" LineWidth="4" Right="1173" TabOrder="18" Top="353" Type="Rectangle" Visible="FALSE" Width="5"></Shape>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="21" Id="btn_del_dtl" ImageID="Btn_sub_del" Left="1173" OnClick="btn_del_dtl_OnClick" Style="Btn_sub" TabOrder="17" Text="&#32;&#32;&#32;Çà»èÁ¦" Top="359" Width="61"></Button>
		<Shape Bottom="89" Height="32" Id="Shape5" Left="1168" LineColor="tomato" LineKind="Vertical" LineWidth="4" Right="1173" TabOrder="19" Top="57" Type="Rectangle" Visible="FALSE" Width="5"></Shape>
		<Shape Bottom="645" Height="640" Id="Shape8" Left="1234" LineColor="tomato" LineKind="Vertical" LineWidth="4" Right="1239" TabOrder="20" Top="5" Type="Rectangle" Visible="FALSE" Width="5"></Shape>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
* FormID(¸í) : °øÅëÄÚµå°ü¸®
* ÀÛ¼ºÀÚ     : ÀÌ¿ëÀç
* ÀÛ¼ºÀÏ     : 2013-01-24 : ÃÖÃÊ »ý¼º
* ±â´É¼³¸í   : °øÅëÄÚµå°ü¸® 
* º¯°æ·Î±×
* Date             Ver          Name        Description
* ---------------  ------   ----------  ---------------------------
* 2013-01-24       V1.0                  initial ver.
***************************************************************************************************/

/**************************************************************************************************
  * °øÅë Script Include
***************************************************************************************************/
#include "lib::lib_global.js";
#include "lib::lib_comm.js";
#include "lib::lib_grid.js";
#include "lib::lib_platform.js";
#include "lib::lib_popup.js";
#include "lib::lib_msg.js";
#include "lib::lib_ext.js";

/**************************************************************************************************
  * È­¸é º¯¼ö ¼±¾ðºÎ
***************************************************************************************************/

var svcID			= "";		
var url   			= "";
var inDatasets  	= "";
var outDatasets 	= "";
var argument    	= "";
var callbackFunc 	= "";
var curMRow = "";
var curDRow = "";

/**************************************************************************************************
  * °øÅë Function Ã³¸® ºÎºÐ
***************************************************************************************************/
//  1-1.È­¸é ¼ÂÆÃ ÇÔ¼ö 
//  1-2.Á¶È¸ ÇÔ¼ö     
//  1-3.ÀúÀå ÇÔ¼ö    
//  1-4.»èÁ¦ ÇÔ¼ö    
//  1-5.Transaction ÈÄ Ã³¸® ÇØ¾ß ÇÒ ³»¿ë

//*------------------------------------------------------------------------
//* ÇÔ¼ö¼³¸í     : 1.1 È­¸é¼ÂÆÃ ÇÔ¼ö 
//* ÇÔ¼öÀ¯Çü     :
//* parameter    :
//* return value : ¾øÀ½
//* ºñ°í         :
//*------------------------------------------------------------------------
function fn_initForm()
{

	//*------------------------------------------------------------------------
    //* ¸®»çÀÌÁî ÄÁÆ÷³ÍÆ® Á¤ÀÇ
	//* H: °¡·Î ¸®»çÀÌÁî
	//* W: ¼¼·Î ¸®»çÀÌÁî
	//* A: °¡·Î¼¼·Î ¸®»çÀÌÁî
	//* R: Resize
	//* M: Move
	//* Quick view·Î Å×½ºÆ®½Ã ÁÖ¼®Ã³¸® ÈÄ Å×½ºÆ®
    //*------------------------------------------------------------------------
	gfn_SetResize(this, "Shape_search:H:R GRD_CODE_MST:H:R GRD_CODE_DTL:A:R btn_add_mst:H:M btn_del_mst:H:M btn_add_dtl:H:M btn_del_dtl:H:M");
	
	
	// °øÅë ¸í·É¾î Á¶Á¤
	gfn_set_cbutton("Á¶È¸:fn_search ÀúÀå:fn_save");
	
	fn_search();
    

}



//*------------------------------------------------------------------------------------------------
//* ÇÔ¼ö¼³¸í     : 1.2 Á¶È¸ ÇÔ¼ö 
//* ÇÔ¼öÀ¯Çü     : 
//* parameter    : 
//* return value : ¾øÀ½
//* ºñ°í         :
//*-----------------------------------------------------------------------------------------------
function fn_search()
{
	
	DS_CODE_MST.ClearData();
	DS_CODE_DTL.ClearData();
	
	svcID			= "CCAB01T01.selectCodeLst";
	url   			= "service::common/select_mi.do";
	inDatasets  	= "";
	outDatasets 	= "DS_CODE_MST=cc.CCCodeDAO.selectCodeMst"
							+ " DS_CODE_DTL=cc.CCCodeDAO.selectCodeDtl";
	argument    	= " _sqlName=cc.CCCodeDAO.selectCodeMst"
							+ ",cc.CCCodeDAO.selectCodeDtl"
							+ " S_MST_NM=" + quote(S_MST_NM.Text)
							+ " OPERATOR=" + quote(GDS_USER_INFO.GetColumn(0, "USR_ID"));
	
	
	callbackFunc 	= "gfn_callback";

	gfn_showProgressWindow(true);
	gfn_Transaction(svcID, url, inDatasets, outDatasets, argument, callbackFunc);	 	

}


//*------------------------------------------------------------------------------------------------
//* ÇÔ¼ö¼³¸í     : 1.3 ÀúÀå ÇÔ¼ö 
//* ÇÔ¼öÀ¯Çü     : 
//* parameter    : 
//* return value : ¾øÀ½
//* ºñ°í         :
//*-----------------------------------------------------------------------------------------------
function fn_save()
{
	
	curMRow = DS_CODE_MST.currow;
	curDRow = DS_CODE_DTL.currow;	
	
	var bValidate = true;
	var pMessage = "";
	var cMessage = "";
	var isSave = false;
	
	// ÇÊÅÍ 
	DS_CODE_MST.FireEvent = false;		
	DS_CODE_MST.UnFilter();
	DS_CODE_MST.Filter("FLAG !='N'");	// º¯°æµÈ°Í ¸ðµÎ ÇÊÅÍ¸µ  (ÀúÀå/»èÁ¦) 
	
	DS_CODE_DTL.FireEvent = false;		
	DS_CODE_DTL.UnFilter();
	DS_CODE_DTL.Filter("FLAG !='N'");	// º¯°æµÈ°Í ¸ðµÎ ÇÊÅÍ¸µ  (ÀúÀå/»èÁ¦) 
	
	
	
	// ÄÚµå±×·ì Ã¼Å© 
	if(DS_CODE_MST.rowcount > 0)
	{
		// ÇÊ¼öÃ¼Å©
		for(var i=0;i<DS_CODE_MST.rowcount;i++)
		{
			
			cMessage = "";
			
			
			if(length(DS_CODE_MST.GetColumn(i, "MST_CD")) == 0)
			{
				bValidate = false;
				cMessage += "ÄÚµå±×·ì ´©¶ô ";
			}
			if(length(DS_CODE_MST.GetColumn(i, "MST_NM")) == 0)
			{
				bValidate = false;
				cMessage += "±×·ì¸í ´©¶ô ";
			}
			

			if(bValidate == false)
			{
				pMessage += "\n ["+i+"] " + cMessage;
			}
		}
		
		// ÇÊ¼öÇ×¸ñ ´©¶ô 
		if(bValidate == false)
		{
			gfn_popup_message("modal", "error", pMessage, "È®ÀÎ");
		}
		else
		{
			isSave = true;
		}
	}


	// °øÅëÄÚµå Ã¼Å© 
	if(DS_CODE_DTL.rowcount > 0)
	{
		// ÇÊ¼öÃ¼Å©
		for(var i=0;i<DS_CODE_DTL.rowcount;i++)
		{
			
			cMessage = "";
			
			
			if(length(DS_CODE_DTL.GetColumn(i, "MST_CD")) == 0)
			{
				bValidate = false;
				cMessage += "ÄÚµå±×·ì ´©¶ô ";
			}
			if(length(DS_CODE_DTL.GetColumn(i, "DTL_CD")) == 0)
			{
				bValidate = false;
				cMessage += "ÄÚµå ´©¶ô ";
			}			
			if(length(DS_CODE_DTL.GetColumn(i, "DTL_NM")) == 0)
			{
				bValidate = false;
				cMessage += "ÄÚµå¸í ´©¶ô ";
			}
			

			if(bValidate == false)
			{
				pMessage += "\n ["+i+"] " + cMessage;
			}
		}
		
		// ÇÊ¼öÇ×¸ñ ´©¶ô 
		if(bValidate == false)
		{
			gfn_popup_message("modal", "error", pMessage, "È®ÀÎ");
		}
		else
		{
			isSave = true;
		}
	}
	
	if(isSave != true)
	{
		gfn_popup_message("modal", "error", "ÀúÀå/»èÁ¦ÇÒ Ç×¸ñÀÌ ¾ø½À´Ï´Ù.", "È®ÀÎ");
		bValidate = false;		
	}
	
	// Á¤»óÀÏ°æ¿ì Ã³¸®
	if(bValidate == true)
	{
		// ÀúÀå 
		//if(gfn_popup_message("modal", "confirm", "ÀúÀå/»èÁ¦ ÇÏ½Ã°Ú½À´Ï±î?", "È®ÀÎ")) 
		//{

			// »õ·Î¿î DataSet¿¡ ´ã¾Æ¼­ º¸³»¾ßµÊ
			// ¾Æ´Ï¸é º¯°æµÈ ¸ðµç°ÍµéÀ» º¸³»¹ö¸®¹Ç·Î ¾ÈµÊ.
			DS_TEMP_MST.ClearData();
			DS_TEMP_MST.CopyF("DS_CODE_MST");

			DS_TEMP_DTL.ClearData();
			DS_TEMP_DTL.CopyF("DS_CODE_DTL");			
			
			svcID			= "CCAB01T01.saveCodeLst";
			url   			= "service::common/select_mi.do";
			inDatasets  	= "cc.CCCodeDAO.saveCodeMst=DS_TEMP_MST:A"
							+ " cc.CCCodeDAO.saveCodeDtl=DS_TEMP_DTL:A";
			outDatasets 	= "";
			argument    	= " _sqlName=cc.CCCodeDAO.saveCodeMst"
							+ ",cc.CCCodeDAO.saveCodeDtl";			
			callbackFunc 	= "gfn_callback";	
		
		
			gfn_showProgressWindow(true);
			gfn_Transaction(svcID, url, inDatasets, outDatasets, argument, callbackFunc);	 
		//}
	
	}

	DS_CODE_MST.UnFilter();
	DS_CODE_MST.Filter("flag != 'D'");
	DS_CODE_MST.FireEvent = true;	

	DS_CODE_DTL.UnFilter();
	DS_CODE_DTL.Filter("flag != 'D'");
	DS_CODE_DTL.FireEvent = true;	

	DS_CODE_MST.row = curMRow;
	DS_CODE_DTL.row = curDRow;		
	
	
}


//*------------------------------------------------------------------------------------------------
//* ÇÔ¼ö¼³¸í     : 1.5 Transaction È£ÃâÈÄ °á°ú°ª È®ÀÎ (gfn_callback¿¡¼­ fn_callbackÀ» È£ÃâÇÑ´Ù.)
//* ÇÔ¼öÀ¯Çü     : 
//* parameter    : 
//* return value : ¾øÀ½
//* ºñ°í         :
//*-----------------------------------------------------------------------------------------------
function fn_callback(svcID, errorCode, errorMsg)
{

	switch(svcID) 
	{		
		// Á¶È¸
		case "CCAB01T01.selectCodeLst" :
		
			// Á¶È¸ °á°ú ¾øÀ¸¸é ¸Þ½ÃÁö¸¦ ¶ç¿î´Ù.
			//if(DS_CODE_MST.rowcount < 1) 
			//{ 
			//	gfn_popup_message("modal", "ico_info", "Á¶È¸µÈ ³»¿ëÀÌ ¾ø½À´Ï´Ù.", "È®ÀÎ");	
			//}
			
			
		break;	

		// ÀúÀå
		case "CCAB01T01.saveCodeLst" :
		
			gfn_popup_message("modal", "ico_info", "Ãß°¡/¼öÁ¤/»èÁ¦ ¿Ï·á.", "È®ÀÎ");	
			fn_search();		
		break;	
		

		
		default:
			  alert("±âÅ¸"); 
	}

	if(curMRow != null) 
	{
		DS_CODE_MST.row = curMRow;
	}

	if(curDRow != null) 
	{
		DS_CODE_DTL.row = curDRow;
	}

}



//*------------------------------------------------------------------------------------------------
//* ÇÔ¼ö¼³¸í     : º¯°æµÈ Ç×¸ñ ÀÖ´ÂÁö Ã¼Å©
//* ÇÔ¼öÀ¯Çü     : 
//* parameter    : 
//* return value : ¾øÀ½
//* ºñ°í         : ÀúÀå ¾ÈÇÏ°í Ã¢ ´ÝÀ»¶§ Ã¼Å©ÇØ¼­ ÀúÀåÇÏ°Ô ÇÑ´Ù.
//*-----------------------------------------------------------------------------------------------
function fn_check_unsave()
{
	var isUnSave = false;

	curMRow = DS_CODE_MST.currow;
	curDRow = DS_CODE_DTL.currow;
	
	// ÇÊÅÍ 
	DS_CODE_MST.FireEvent = false;		
	DS_CODE_MST.UnFilter();
	DS_CODE_MST.Filter("FLAG !='N'");
	
	
	// Ã¼Å© 
	if(DS_CODE_MST.rowcount > 0)
	{
		isUnSave = true;
	}

	DS_CODE_MST.UnFilter();
	DS_CODE_MST.Filter("flag != 'D'");
	DS_CODE_MST.FireEvent = true;
		
	// ÇÊÅÍ 
	DS_CODE_DTL.FireEvent = false;		
	DS_CODE_DTL.UnFilter();
	DS_CODE_DTL.Filter("FLAG !='N'");
	
	
	// Ã¼Å© 
	if(DS_CODE_DTL.rowcount > 0)
	{
		isUnSave = true;
	}

	DS_CODE_DTL.UnFilter();
	DS_CODE_DTL.Filter("flag != 'D'");
	DS_CODE_DTL.FireEvent = true;		
		
		

	DS_CODE_MST.row = curMRow;
	DS_CODE_DTL.row = curDRow;
			
	return isUnSave;
	
}

/**************************************************************************************************
  * »ç¿ëÀÚ Á¤ÀÇ  Function Ã³¸® ºÎºÐ
***************************************************************************************************/
//*------------------------------------------------------------------------------------------------
//* ÇÔ¼ö¼³¸í     : CODE_MST ÇàÃß°¡
//* ÇÔ¼öÀ¯Çü     : 
//* parameter    : 
//* return value : ¾øÀ½
//*-----------------------------------------------------------------------------------------------
function fn_add_mst(row)
{

	DS_CODE_MST.SetColumn(row,"FLAG","I");	// Ãß°¡ FLAG ³Ö±â
	DS_CODE_MST.SetColumn(row,"ROW_ID","");	// ROW_ID(Á¶È¸ÈÄ ¼ÂÆÃµÊ)
	DS_CODE_MST.SetColumn(row,"OPERATOR", GDS_USER_INFO.GetColumn(0, "USR_ID"));// µî·ÏÀÚ, ¼öÁ¤ÀÚ ³Ö±â
    DS_CODE_MST.SetColumn(row,"USE_YN", "1");//
}

//*------------------------------------------------------------------------------------------------
//* ÇÔ¼ö¼³¸í     : CODE_DTL ÇàÃß°¡
//* ÇÔ¼öÀ¯Çü     : 
//* parameter    : 
//* return value : ¾øÀ½
//*-----------------------------------------------------------------------------------------------
function fn_add_dtl(row)
{
	// MST_CD¸¦ µî·ÏÇÏÁö ¾ÊÀº »óÅÂ¿¡¼­´Â ÇàÃß°¡°¡ µÇÁö ¾Ê´Â´Ù.
	if(length(DS_CODE_MST.GetColumn(DS_CODE_MST.currow,"MST_CD")) == 0) 
	{
		gfn_popup_message("modal", "error", "¸ÕÀú »ó´Ü ÄÚµå±×·ìÀ» µî·Ï ÇÑ ÈÄ °øÅëÄÚµå¸¦ µî·ÏÇØ¾ß ÇÕ´Ï´Ù. ", "È®ÀÎ");
		DS_CODE_DTL.DeleteRow(row);
		return;
	}
	
	DS_CODE_DTL.SetColumn(row,"FLAG","I");	// Ãß°¡ FLAG ³Ö±â
	DS_CODE_DTL.SetColumn(row,"ROW_ID","");	// ROW_ID(Á¶È¸ÈÄ ¼ÂÆÃµÊ)
	DS_CODE_DTL.SetColumn(row,"OPERATOR", GDS_USER_INFO.GetColumn(0, "USR_ID"));// µî·ÏÀÚ, ¼öÁ¤ÀÚ ³Ö±â
	DS_CODE_DTL.SetColumn(row,"MST_CD", DS_CODE_MST.GetColumn(DS_CODE_MST.currow,"MST_CD"));// ÇÊ¼öÀÔ·Â
    DS_CODE_DTL.SetColumn(row,"USE_YN", "1");//
}


//*------------------------------------------------------------------------------------------------
//* ÇÔ¼ö¼³¸í     : CODE_MST Çà»èÁ¦
//* ÇÔ¼öÀ¯Çü     : 
//* parameter    : 
//* return value : ¾øÀ½
//*-----------------------------------------------------------------------------------------------
function fn_del_mst(row)
{
	// Ãß°¡µÈ°ÍÀº DBÀúÀåÀüÀÌ¹Ç·Î ±×³É DataSet¿¡¼­ »èÁ¦
	if(DS_CODE_MST.GetColumn(row,"FLAG") == "I")
	{
		DS_CODE_MST.DeleteRow(row);
	}
	// ¾Æ´Ñ°ÍÀº ½ÇÁ¦·Î DB¿¡ »èÁ¦ÇØ¾ßµÇ¹Ç·Î flag¸¦ D·Î µÎ°í ¸¶Áö¸·¿¡ filterÇÑ´Ù.
	else
	{
		DS_CODE_MST.SetColumn(row,"FLAG", "D");
	}
		
		
	// ÇØ´ç CODE_MSTÀÇ CODE_DTLÀº ÀÏ°ý »èÁ¦ Ã³¸®
	for(var i=0;i<DS_CODE_DTL.rowcount;i++)
	{
		
		if(DS_CODE_DTL.GetColumn(i, "MST_CD") == DS_CODE_MST.GetColumn(row,"MST_CD"))
		{
			fn_del_dtl(i);
		}
	}

	
	DS_CODE_MST.Filter("flag != 'D'");	// »èÁ¦µÈ°Å´Â ÇÊÅÍ¸µ
    
}

//*------------------------------------------------------------------------------------------------
//* ÇÔ¼ö¼³¸í     : CODE_DTL Çà»èÁ¦
//* ÇÔ¼öÀ¯Çü     : 
//* parameter    : 
//* return value : ¾øÀ½
//*-----------------------------------------------------------------------------------------------
function fn_del_dtl(row)
{
	// Ãß°¡µÈ°ÍÀº DBÀúÀåÀüÀÌ¹Ç·Î ±×³É DataSet¿¡¼­ »èÁ¦
	if(DS_CODE_DTL.GetColumn(row,"FLAG") == "I")
	{
		DS_CODE_DTL.DeleteRow(row);
	}
	// ¾Æ´Ñ°ÍÀº ½ÇÁ¦·Î DB¿¡ »èÁ¦ÇØ¾ßµÇ¹Ç·Î flag¸¦ D·Î µÎ°í ¸¶Áö¸·¿¡ filterÇÑ´Ù.
	else
	{
		DS_CODE_DTL.SetColumn(row,"FLAG", "D");
	}	
	
	DS_CODE_DTL.Filter("flag != 'D'");	// »èÁ¦µÈ°Å´Â ÇÊÅÍ¸µ
    
}	



/**************************************************************************************************
  * °øÅë Event Ã³¸® ºÎºÐ
***************************************************************************************************/
//  2-1.Load ºÎºÐ
//  2-2.UnLoad ºÎºÐ
//  2-3 onSize ºÎºÐ
//  2-4.ÃÊ±âÈ­ ºÎºÐ
//  2-5.Á¶È¸ ¹öÆ° Å¬¸¯     
//  2-6.ÀúÀå ¹öÆ° Å¬¸¯    
//  2-7.»èÁ¦ ¹öÆ° Å¬¸¯    
//  2-8.¿¢¼¿ ¹öÆ° Å¬¸¯    

//*------------------------------------------------------------------------------------------------
//* ÇÔ¼ö¼³¸í     : 2-1.È­¸é Load ¿Ï·á½Ã ½ÇÇà ½ºÅ©¸³Æ® 
//* ÇÔ¼öÀ¯Çü     : 
//* parameter    : 
//* return value : ¾øÀ½
//* ºñ°í         :
//*-----------------------------------------------------------------------------------------------
function CCAB01T01_OnLoadCompleted(obj)
{
	// °øÅë init
	gfn_OnInit();
	
	// ÆûÃÊ±âÈ­ 
	fn_initForm();

}

//*------------------------------------------------------------------------------------------------
//* ÇÔ¼ö¼³¸í     : 2-2.È­¸é Unload ½Ã ½ÇÇà ½ºÅ©¸³Æ®
//* ÇÔ¼öÀ¯Çü     : 
//* parameter    : 
//* return value : ¾øÀ½
//* ºñ°í         :
//*-----------------------------------------------------------------------------------------------
function CCAB01T01_OnUnloadCompleted(obj)
{
	gfn_OnBeforeExit();
}




//*------------------------------------------------------------------------------------------------
//* ÇÔ¼ö¼³¸í     : 2-7.¿¢¼¿¹öÆ° Å¬¸¯½Ã  ½ÇÇà ½ºÅ©¸³Æ®
//* ÇÔ¼öÀ¯Çü     : 
//* parameter    : 
//* return value : ¾øÀ½
//* ºñ°í         :
//*-----------------------------------------------------------------------------------------------
function btn_excel_OnClick(obj)
{
	gfn_exportExcel(Grid1,"sheet1");
}




/**************************************************************************************************
  * »ç¿ëÀÚ Á¤ÀÇ  Event Ã³¸® ºÎºÐ
***************************************************************************************************/


//*------------------------------------------------------------------------------------------------
//* ÇÔ¼ö¼³¸í     : Grid ÇØ´õ Å¬¸¯½Ã 
//* ÇÔ¼öÀ¯Çü     : 
//* parameter    : 
//* return value : ¾øÀ½
//*-----------------------------------------------------------------------------------------------
function GRD_CODE_MST_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	// Sorting
	gfn_GridSort(GRD_CODE_MST, DS_CODE_MST, nCell);	
}


//*------------------------------------------------------------------------------------------------
//* ÇÔ¼ö¼³¸í     : Grid ÇØ´õ Å¬¸¯½Ã 
//* ÇÔ¼öÀ¯Çü     : 
//* parameter    : 
//* return value : ¾øÀ½
//*-----------------------------------------------------------------------------------------------
function GRD_CODE_DTL_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	// Sorting
	gfn_GridSort(GRD_CODE_DTL, DS_CODE_DTL, nCell);	
	
}



//*------------------------------------------------------------------------------------------------
//* ÇÔ¼ö¼³¸í     : CODE_MST ÇàÃß°¡ Å¬¸¯½Ã  ½ÇÇà ½ºÅ©¸³Æ®
//* ÇÔ¼öÀ¯Çü     : 
//* parameter    : 
//* return value : ¾øÀ½
//* ºñ°í         :
//*-----------------------------------------------------------------------------------------------
function btn_add_mst_OnClick(obj)
{
		
	var row = DS_CODE_MST.AddRow();
	
	fn_add_mst(row);

}


//*------------------------------------------------------------------------------------------------
//* ÇÔ¼ö¼³¸í     : CODE_MST Çà»èÁ¦ Å¬¸¯½Ã  ½ÇÇà ½ºÅ©¸³Æ®
//* ÇÔ¼öÀ¯Çü     : 
//* parameter    : 
//* return value : ¾øÀ½
//* ºñ°í         :
//*-----------------------------------------------------------------------------------------------
function btn_del_mst_OnClick(obj)
{
	var row = DS_CODE_MST.currow;

	fn_del_mst(row);
	
}


//*------------------------------------------------------------------------------------------------
//* ÇÔ¼ö¼³¸í     : CODE_DTL ÇàÃß°¡ Å¬¸¯½Ã  ½ÇÇà ½ºÅ©¸³Æ®
//* ÇÔ¼öÀ¯Çü     : 
//* parameter    : 
//* return value : ¾øÀ½
//* ºñ°í         :
//*-----------------------------------------------------------------------------------------------
function btn_add_dtl_OnClick(obj)
{
	var row = DS_CODE_DTL.AddRow();
	
	fn_add_dtl(row);	
}

//*------------------------------------------------------------------------------------------------
//* ÇÔ¼ö¼³¸í     : CODE_DTL Çà»èÁ¦ Å¬¸¯½Ã  ½ÇÇà ½ºÅ©¸³Æ®
//* ÇÔ¼öÀ¯Çü     : 
//* parameter    : 
//* return value : ¾øÀ½
//* ºñ°í         :
//*-----------------------------------------------------------------------------------------------
function btn_del_dtl_OnClick(obj)
{
	var row = DS_CODE_DTL.currow;

	fn_del_dtl(row);	
}


//*------------------------------------------------------------------------------------------------
//* ÇÔ¼ö¼³¸í     : CODE_MST ¼¿ Å¬¸¯½Ã  ½ÇÇà ½ºÅ©¸³Æ®
//* ÇÔ¼öÀ¯Çü     : 
//* parameter    : 
//* return value : ¾øÀ½
//* ºñ°í         :
//*-----------------------------------------------------------------------------------------------
function GRD_CODE_MST_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{

	var MST_CD = DS_CODE_MST.GetColumn(nRow,"MST_CD");
	
	// CODE_DTL¿¡ MST °ü·Ã¸¸ ÇÊÅÍ 
	DS_CODE_DTL.FireEvent = false;		
	DS_CODE_DTL.UnFilter();
	DS_CODE_DTL.Filter("MST_CD ='"+MST_CD+"'");	

	DS_CODE_DTL.FireEvent = true;
		
	curMRow = nRow;

}


//*------------------------------------------------------------------------------------------------
//* ÇÔ¼ö¼³¸í     : CODE_DTL ¼¿ Å¬¸¯½Ã  ½ÇÇà ½ºÅ©¸³Æ®
//* ÇÔ¼öÀ¯Çü     : 
//* parameter    : 
//* return value : ¾øÀ½
//* ºñ°í         :
//*-----------------------------------------------------------------------------------------------
function GRD_CODE_DTL_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	curDRow = nRow;
}


//*------------------------------------------------------------------------------------------------
//* ÇÔ¼ö¼³¸í     : ¿¢¼¿´Ù¿î·Îµå Å¬¸¯½Ã  ½ÇÇà ½ºÅ©¸³Æ®
//* ÇÔ¼öÀ¯Çü     : 
//* parameter    : 
//* return value : ¾øÀ½
//* ºñ°í         :
//*-----------------------------------------------------------------------------------------------
function btn_excel_download_OnClick(obj)
{
	gfn_exportExcel(GRD_CMPNY_BAS,"È¸»ç¸ñ·Ï");
}


//*------------------------------------------------------------------------------------------------
//* ÇÔ¼ö¼³¸í     : CODE_MST DataSet º¯°æ½Ã flag ¼³Á¤
//* ÇÔ¼öÀ¯Çü     : 
//* parameter    : 
//* return value : ¾øÀ½
//* ºñ°í         :
//*-----------------------------------------------------------------------------------------------
function DS_CODE_MST_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	// flag°¡ 'N' ÀÌ¸é 'U' ·Î ¹Ù²Û´Ù.
	// Áï Á¶È¸µÈ°Å¸¦ ¼öÁ¤ÇÏ¸é U·Î ¹Ù²Û´Ù.
	if(obj.GetColumn(nRow, "FLAG") == "N" )
	{
		obj.SetColumn(nRow, "FLAG", "U");	// ¼öÁ¤Çß´Ù´Â Ç¥½Ã 
	}
}

//*------------------------------------------------------------------------------------------------
//* ÇÔ¼ö¼³¸í     : CODE_DTL DataSet º¯°æ½Ã flag ¼³Á¤
//* ÇÔ¼öÀ¯Çü     : 
//* parameter    : 
//* return value : ¾øÀ½
//* ºñ°í         :
//*-----------------------------------------------------------------------------------------------
function DS_CODE_DTL_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	// flag°¡ 'N' ÀÌ¸é 'U' ·Î ¹Ù²Û´Ù.
	// Áï Á¶È¸µÈ°Å¸¦ ¼öÁ¤ÇÏ¸é U·Î ¹Ù²Û´Ù.
	if(obj.GetColumn(nRow, "FLAG") == "N" )
	{
		obj.SetColumn(nRow, "FLAG", "U");	// ¼öÁ¤Çß´Ù´Â Ç¥½Ã 
	}
}



function Button0_OnClick(obj)
{
	alert(gfn_dsToString(DS_CODE_MST));
}







//*------------------------------------------------------------------------------------------------
//* ÇÔ¼ö¼³¸í     : ¿£ÅÍÅ° Á¶È¸
//* ÇÔ¼öÀ¯Çü     : 
//* parameter    : 
//* return value : ¾øÀ½
//* ºñ°í         :
//*-----------------------------------------------------------------------------------------------
function S_MST_NM_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if(nChar==13){				
		fn_search();	
	}	
}



]]></Script>
</Window>