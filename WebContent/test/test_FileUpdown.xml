<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form Height="555" Id="form" Left="8" PidAttrib="7" Title="New&#32;Form" ToolTipFont="Default,0" Top="8" Ver="1.0" Width="790" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_test_data">
				<Contents>
					<colinfo id="id" size="256" summ="default" type="STRING"/>
					<colinfo id="levels" size="256" summ="default" type="STRING"/>
					<colinfo id="section" size="256" summ="default" type="STRING"/>
					<colinfo id="lvl_seq" size="256" summ="default" type="STRING"/>
					<colinfo id="menu_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="page_url" size="256" summ="default" type="STRING"/>
					<colinfo id="etc" size="256" summ="default" type="STRING"/>
					<colinfo id="index" size="256" summ="default" type="STRING"/>
					<colinfo id="checked" size="256" summ="default" type="STRING"/>
					<colinfo id="manager" size="256" summ="default" type="STRING"/>
					<colinfo id="join_date" size="256" summ="default" type="STRING"/>
					<colinfo id="dept_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="image_level" size="256" summ="default" type="STRING"/>
					<colinfo id="birth_day" size="256" summ="default" type="STRING"/>
					<colinfo id="position_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="file_name" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_detail_data">
				<Contents>
					<colinfo id="id" size="256" summ="default" type="STRING"/>
					<colinfo id="levels" size="256" summ="default" type="STRING"/>
					<colinfo id="section" size="256" summ="default" type="STRING"/>
					<colinfo id="lvl_seq" size="256" summ="default" type="STRING"/>
					<colinfo id="menu_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="page_url" size="256" summ="default" type="STRING"/>
					<colinfo id="etc" size="256" summ="default" type="STRING"/>
					<colinfo id="index" size="256" summ="default" type="STRING"/>
					<colinfo id="checked" size="256" summ="default" type="STRING"/>
					<colinfo id="manager" size="256" summ="default" type="STRING"/>
					<colinfo id="join_date" size="256" summ="default" type="STRING"/>
					<colinfo id="dept_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="image_level" size="256" summ="default" type="STRING"/>
					<colinfo id="birth_day" size="256" summ="default" type="STRING"/>
					<colinfo id="position_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="file_name" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Static Height="20" Id="Static8" Style="Stc_Title" TabOrder="1" Text="Template6" Width="208"></Static>
		<Image Align="Left" Height="14" Id="Image3" ImageID="Title_dot" LeftMargin="20" Style="Stc_Subtitle" TabOrder="2" Text="메뉴명" Top="97" Transparent="TRUE" Width="157"></Image>
		<Shape Bottom="116" Height="5" Id="Shape15" Left="-2" LineColor="seagreen" LineKind="Vertical" LineWidth="5" Right="800" TabOrder="3" Top="111" Type="Rectangle" Visible="FALSE" Width="802"></Shape>
		<Shape Bottom="41" Height="7" Id="Shape10" Left="0" LineColor="seagreen" LineKind="Vertical" LineWidth="2" Right="790" TabOrder="4" Top="34" Type="Rectangle" Visible="FALSE" Width="790"></Shape>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="21" Id="btn_insert" ImageID="Btn_com_2w" Left="738" LeftMargin="12" OnClick="btn_selectUser_OnClick" Style="Btn_Com" TabOrder="5" Text="저장" Top="13" TopMargin="1" Transparent="TRUE" Width="50"></Button>
		<TreeView BindDataset="ds_test_data" Border="None" Expand="FALSE" ExpandImageIndex="0" Height="432" Id="TreeView0" ImageColumn="image_level" ImageID="treeview_org_img" ImageIndex="0" InnerImageCount="3" LevelColumn="levels" OnDblClick="TreeView0_OnDblClick" Style="Tree_Sub" TabOrder="6" TEXTColumn="menu_nm" Top="116" Width="250"></TreeView>
		<Shape Bottom="553" Height="460" Id="Shape43" Left="259" LineColor="tomato" LineKind="Vertical" LineWidth="5" Right="264" TabOrder="5" Top="93" Type="Rectangle" Visible="FALSE" Width="5"></Shape>
		<Shape BKColor="user21" Bottom="81" Height="40" Id="Shape2" Left="0" LineColor="user22" Right="790" RoundHeight="10" RoundUnit="Pixel" RoundWidth="10" TabOrder="11" Top="41" Type="RoundRect" Width="790"></Shape>
		<Image Align="Left" Height="18" Id="Image1" Left="22" LeftMargin="0" Style="Stc_Default_bold" TabOrder="6" Text="입력값" Top="48" Transparent="TRUE" Width="59"></Image>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="21" Id="btn_search" ImageID="Btn_com_search" Left="728" LeftMargin="16" OnClick="btn_search_OnClick" Style="Btn_sub" TabOrder="8" Top="48" TopMargin="1" Transparent="TRUE" Width="50"></Button>
		<Shape Bottom="90" Height="56" Id="Shape11" Left="0" LineColor="sienna" LineKind="Vertical" LineWidth="10" Right="20" TabOrder="7" Top="34" Type="Rectangle" Visible="FALSE" Width="20"></Shape>
		<Shape Bottom="73" Height="32" Id="Shape3" Left="62" LineColor="sienna" LineKind="Vertical" LineWidth="10" Right="72" TabOrder="9" Top="41" Type="Rectangle" Visible="FALSE" Width="10"></Shape>
		<Shape Bottom="96" Height="15" Id="Shape6" Left="0" LineColor="seagreen" LineKind="Vertical" LineWidth="10" Right="794" TabOrder="10" Top="81" Type="Rectangle" Visible="FALSE" Width="794"></Shape>
		<Image Align="Left" Height="14" Id="Image4" ImageID="Title_dot" Left="264" LeftMargin="20" Style="Stc_Subtitle" TabOrder="12" Text="관리자정보" Top="97" Transparent="TRUE" Width="157"></Image>
		<Static Border="Flat" Height="24" Id="Static22" Left="264" Style="Stc_LabelBody" TabOrder="14" Top="139" VAlign="Middle" Width="526"></Static>
		<Static Border="Flat" Height="24" Id="Static23" Left="264" Style="Stc_LabelBody" TabOrder="16" Top="116" VAlign="Middle" Width="526"></Static>
		<Static Align="Center" Border="Flat" Height="24" Id="Static24" Left="264" Style="Stc_Label2" TabOrder="13" Text="부서" Top="139" VAlign="Middle" Width="60"></Static>
		<Static Align="Center" Border="Flat" Height="24" Id="Static25" Left="264" Style="Stc_Label2" TabOrder="15" Text="관리자" Top="116" VAlign="Middle" Width="60"></Static>
		<Edit AutoSkip="TRUE" Border="Flat" CheckLength="Byte" Height="18" Id="edt_manager" Left="329" MaxLength="50" Readonly="TRUE" Style="Edit" TabOrder="17" Top="119" Width="456"></Edit>
		<Edit AutoSkip="TRUE" Border="Flat" CheckLength="Byte" Height="18" Id="edt_dept_nm" Left="329" MaxLength="50" Readonly="TRUE" Style="Edit" TabOrder="18" Top="142" Width="456"></Edit>
		<Static Border="Flat" Height="24" Id="Static2" Left="264" Style="Stc_LabelBody" TabOrder="20" Top="185" VAlign="Middle" Width="526"></Static>
		<Static Border="Flat" Height="24" Id="Static3" Left="264" Style="Stc_LabelBody" TabOrder="22" Top="162" VAlign="Middle" Width="526"></Static>
		<Static Align="Center" Border="Flat" Height="24" Id="Static7" Left="264" Style="Stc_Label2" TabOrder="19" Text="입사일" Top="185" VAlign="Middle" Width="60"></Static>
		<Static Align="Center" Border="Flat" Height="24" Id="Static9" Left="264" Style="Stc_Label2" TabOrder="21" Text="직위호칭" Top="162" VAlign="Middle" Width="60"></Static>
		<Edit AutoSkip="TRUE" Border="Flat" CheckLength="Byte" Height="18" Id="edt_position_nm" Left="329" MaxLength="50" Readonly="TRUE" Style="Edit" TabOrder="23" Top="165" Width="456"></Edit>
		<Static Border="Flat" Height="24" Id="Static11" Left="264" Style="Stc_LabelBody" TabOrder="25" Top="208" VAlign="Middle" Width="526"></Static>
		<Static Align="Center" Border="Flat" Height="24" Id="Static13" Left="264" Style="Stc_Label2" TabOrder="24" Text="생일" Top="208" VAlign="Middle" Width="60"></Static>
		<Button Height="16" Id="Button7" ImageID="Btn_calendar" Left="404" OnClick="Button7_OnClick" TabOrder="26" Text="Button1" Top="189" Width="16"></Button>
		<Shape Bottom="218" Height="36" Id="Shape9" Left="399" LineColor="tomato" LineKind="Vertical" LineWidth="5" Right="404" TabOrder="28" Top="182" Type="Rectangle" Visible="FALSE" Width="5"></Shape>
		<MaskEdit Border="Flat" BorderColor="INACTIVECAPTIONTEXT" Height="18" Id="edt_join_date" Left="329" Mask="@@@@-@@-@@" Readonly="TRUE" TabOrder="27" Top="188" Type="STRING" Width="70"></MaskEdit>
		<Button Height="16" Id="Button0" ImageID="Btn_calendar" Left="404" OnClick="Button0_OnClick" TabOrder="29" Text="Button1" Top="212" Width="16"></Button>
		<Shape Bottom="241" Height="36" Id="Shape13" Left="399" LineColor="tomato" LineKind="Vertical" LineWidth="5" Right="404" TabOrder="31" Top="205" Type="Rectangle" Visible="FALSE" Width="5"></Shape>
		<MaskEdit Border="Flat" BorderColor="INACTIVECAPTIONTEXT" Height="18" Id="edt_birth_day" Left="329" Mask="@@@@-@@-@@" Readonly="TRUE" TabOrder="30" Top="211" Type="STRING" Width="70"></MaskEdit>
		<Edit Border="Flat" Height="18" Id="edt_menuName" Left="72" LeftMargin="4" Readonly="TRUE" Style="Edit_Ess" TabOrder="34" Text="테스트용&#32;(&#32;조회&#32;클릭&#32;)" Top="48" Width="130"></Edit>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="21" Id="Button5" ImageID="Btn_com_3w" Left="671" LeftMargin="12" OnClick="Button5_OnClick" Style="Btn_Com" TabOrder="35" Text="초기화" Top="13" Transparent="TRUE" Width="62"></Button>
		<Shape Bottom="40" Height="32" Id="Shape1" Left="733" LineColor="tomato" LineKind="Vertical" LineWidth="4" Right="738" TabOrder="36" Top="8" Type="Rectangle" Visible="FALSE" Width="5"></Shape>
		<Static Border="Flat" Height="24" Id="Static14" Left="264" Style="Stc_LabelBody" TabOrder="38" Top="231" VAlign="Middle" Width="526"></Static>
		<Static Align="Center" Border="Flat" Height="24" Id="Static15" Left="264" Style="Stc_Label2" TabOrder="37" Text="파일" Top="231" VAlign="Middle" Width="60"></Static>
		<Edit AutoSkip="TRUE" Border="Flat" CheckLength="Byte" Height="18" Id="edt_file_name" Left="329" MaxLength="50" Readonly="TRUE" Style="Edit" TabOrder="39" Top="234" Width="261"></Edit>
		<Shape Bottom="260" Height="148" Id="Shape12" Left="324" LineColor="tomato" LineKind="Vertical" LineWidth="5" Right="329" TabOrder="32" Top="112" Type="Rectangle" Visible="FALSE" Width="5"></Shape>
		<Shape Bottom="260" Height="148" Id="Shape14" Left="784" LineColor="tomato" LineKind="Vertical" LineWidth="5" Right="789" TabOrder="33" Top="112" Type="Rectangle" Visible="FALSE" Width="5"></Shape>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="18" Id="Button103" ImageID="Btn_detail_4w" Left="593" LeftMargin="11" OnClick="Button103_OnClick" Style="Btn_detail" TabOrder="40" Text="파일첨부" Top="234" TopMargin="1" Transparent="TRUE" Width="62"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="18" Id="Button1" ImageID="Btn_detail_4w" Left="658" LeftMargin="11" OnClick="Button1_OnClick" Style="Btn_detail" TabOrder="41" Text="파일받기" Top="234" TopMargin="1" Transparent="TRUE" Width="62"></Button>
		<FileDialog Bottom="120" Height="24" Id="FileDlg" Left="816" Right="840" TabOrder="44" Top="96" Width="24"></FileDialog>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="18" Id="Button2" ImageID="Btn_detail_4w" Left="722" LeftMargin="11" OnClick="Button2_OnClick" Style="Btn_detail" TabOrder="46" Text="파일삭제" Top="234" TopMargin="1" Transparent="TRUE" Width="62"></Button>
	</Form>
	<Script><![CDATA[//#include "script::cmn_ftp.js";
//#include "script::cmn_function.js";

#include "lib::lib_global.js";
#include "lib::lib_comm.js";
#include "lib::lib_grid.js";
#include "lib::lib_platform.js";
#include "lib::lib_popup.js";
#include "lib::lib_msg.js";
#include "lib::lib_ext.js";

var currentID = ""; //저장을 하기 위해서 현제의 아이디를 저장한다.

 
/* 조회*/
function btn_search_OnClick(obj)
{

	edt_file_name.Text   = "";
	edt_manager.Text     = "";
	edt_dept_nm.Text     = "";
	edt_position_nm.Text = "";
	edt_join_date.Text   = "";
	edt_birth_day.Text   = "";
	edt_file_name.Text   = "";
	
	currentID = "";
	
	getTreeLevelValues();
}


/* 트리 내용 조회*/
function getTreeLevelValues()
{
	var svcID			= "CMC001M.testTreeLevelSearch";
	var url   			= "service::CMC001M.testTreeLevelSearch.do";
	var inDatasets  	= "";
	var outDatasets 	= "ds_test_data=CMC001M.testTreeLevelSearch";
	var argument    	= " _sqlName=CMC001M.testTreeLevelSearch"
						;
	var callbackFunc 	= "fn_test_callback";
	
	gfn_transaction(svcID, url, inDatasets, outDatasets, argument, callbackFunc);
}


/* 트리 내용을 더블클릭하면 왼편 에디트 창에 내용을 보낸다.*/
function TreeView0_OnDblClick(obj,nRow)
{

	currentID = ds_test_data.GetColumn(nRow,"id");
	
	if(ds_test_data.GetColumn(nRow,"levels") == 2){
		getDetailValues(ds_test_data.GetColumn(nRow,"id"));
	}	
}


/* 메뉴, 관리자 상세내용 조회*/
function getDetailValues(id)
{
	var svcID			= "CMC001M.testTreeLevelSearch";
	var url   			= "service::CMC001M.testTreeLevelSearch.do";
	var inDatasets  	= "";
	var outDatasets 	= "ds_detail_data=TST001V.getTreeDetailValues";
	var argument    	= " _sqlName=TST001V.getTreeDetailValues"
						+ " P_ID=" + quote(id)
						;
	var callbackFunc 	= "fn_getDetailValues_callback";
	
	gfn_transaction(svcID, url, inDatasets, outDatasets, argument, callbackFunc);
}


/* 상세내용을 에디트 창에 보낸다.*/
function fn_getDetailValues_callback()
{

	edt_file_name.Text   = ds_detail_data.GetColumn(0,"file_name");
	edt_manager.Text     = ds_detail_data.GetColumn(0,"manager");
	edt_dept_nm.Text     = ds_detail_data.GetColumn(0,"dept_nm");
	edt_position_nm.Text = ds_detail_data.GetColumn(0,"position_nm");
	edt_join_date.Text   = ds_detail_data.GetColumn(0,"join_date");
	edt_birth_day.Text   = ds_detail_data.GetColumn(0,"birth_day");
	edt_file_name.Text   = ds_detail_data.GetColumn(0,"file_name");
}


/* 테스트 날짜 입력 */
function Button7_OnClick(obj)
{
	gfn_SetCalendarDate(obj, "D", edt_join_date);
}


/* 테스트 날짜 입력 */
function Button0_OnClick(obj)
{
	gfn_SetCalendarDate(obj, "D", edt_birth_day);
}


/* 저장*/
function btn_selectUser_OnClick(obj)
{
	var tmpEtc = "";
	
	if(edt_etc.Text == ""){
		tmpEtc = " ";
	}else{
		tmpEtc = edt_etc.Text;
	}

	var svcID			= "TST001V.testFunctionSave";
	var url   			= "service::TST001V.testFunctionSave.do";
	var inDatasets      = "";
	var outDatasets 	= "";
	var argument    	= " _sqlName=TST001V.updateTestManagerInfo2"
						+ " P_MANAGER_NM=" + quote(edt_manager.Text)
						+ " P_FILE_FULL_NAME=" +quote(edt_file_name.Text)
						;
	
	var callbackFunc 	= "fn_btn_save_OnClick_callback";
	gfn_transaction(svcID, url, inDatasets, outDatasets, argument, callbackFunc);
}


/* 초기화*/
function Button5_OnClick(obj)
{

	edt_file_name.Text   = "";
	edt_manager.Text     = "";
	edt_dept_nm.Text     = "";
	edt_position_nm.Text = "";
	edt_join_date.Text   = "";
	edt_birth_day.Text   = "";
	
	currentID = "";
		
	ds_test_data.ClearData();
}


function Button103_OnClick(obj)
{
	FileDlg.Open();
	
	var tmpFullName = FileDlg.FilePath + "\\" + FileDlg.FileName;
	var tmpFileName = FileDlg.FileName;
	
	edt_file_name.Text = tmpFileName;

	var filefullname = tmpFullName;
	var ftpSavepath  = "/";
	var savefilename = tmpFileName; 
	var ftp_ip		 = "59.12.238.168"; // 테스트용 FTP    
	var ftp_id       = "jeus"; 
	var ftp_pass     = "jeus"; 
	var ftp_port     = "21"; 
	
	//var ret = gfn_ftpFileUpload(multipart_http0, filefullname, savefilename, '', '', '');
	
	var ret = gfn_ftpFileUpload(multipart_http0, filefullname, savefilename, '', '', '');
	
	if(ret[0] == "FAIL"){
		alert(ret[1]);
		break;
	}else{
		btn_selectUser_OnClick();
	}
}


function Button1_OnClick(obj)
{
	FileDlg.Type = "Save";
	
	FileDlg.FileName = edt_file_name.Text;
	
	if (!FileDlg.Open("")){
		return;
	}
	
	//var tmpFullName = FileDlg.FilePath + "\\" + FileDlg.FileName;

	var filepath     = "/";
	var filename     = edt_file_name.Text;
	var savefilepath = FileDlg.FilePath;
	var savefilename = edt_file_name.Text;
	var ftp_ip       = "213.175.94.230"; // 테스트용 ftp
	var ftp_id       = "user1";
	var ftp_pass     = "123qwe";
	var ftp_port     = "21";
	
	gfn_GetFtpFile(filepath, filename, savefilepath, savefilename, ftp_ip, ftp_id, ftp_pass, ftp_port);
}


function Button2_OnClick(obj)
{
	
	if(confirm('정말 삭제하시겠습니까?')){
	
		var filepath     = "/";
		var filename     = edt_file_name.Text;
		var ftp_ip       = "213.175.94.230"; // 테스트용 ftp
		var ftp_id       = "user1";
		var ftp_pass     = "123qwe";
		var ftp_port     = "21";
		
		var rst = gfn_DeleteFtpFile(filepath, filename, ftp_ip, ftp_id, ftp_pass, ftp_port);
		
		//alert(rst);
		
	}
	
	//deleteFileFtp();
}

function deleteFileFtp()
{
	var filepath     = "/";
	var filename     = edt_file_name.Text;
	var ftp_ip       = "213.175.94.230"; // 테스트용 ftp
	var ftp_id       = "user1";
	var ftp_pass     = "123qwe";
	var ftp_port     = "21";


	var filefullname = tmpFullName;
	var ftpSavepath  = "/";
	var savefilename = tmpFileName; 
	var ftp_ip		 = "213.175.94.230"; // 테스트용 FTP    
	var ftp_id       = "user1"; 
	var ftp_pass     = "123qwe"; 
	var ftp_port     = "21"; 
	
	var ret = gfn_ftpFileDelete(multipart_http0, deletefilename, '', '', '');
	if(ret[0] == "FAIL"){
		alert(ret[1]);
		break;
	}else{
		btn_selectUser_OnClick();
	}
}
]]></Script>
</Window>